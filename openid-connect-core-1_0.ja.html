<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Draft: OpenID Connect Core 1.0 - draft 17</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="OpenID Connect Core 1.0 - draft 17">
<meta name="generator" content="xml2rfc v1.36 (http://xml.resource.org/)">
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: small; color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: small; font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: small; text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Draft</td><td class="header">N. Sakimura</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">NRI</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">J. Bradley</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Ping Identity</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">M. Jones</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Microsoft</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">B. de Medeiros</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Google</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">C. Mortimore</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Salesforce</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 3, 2014</td></tr>
</table></td></tr></table>
<h1><br />OpenID Connect Core 1.0 - draft 17</h1>

<h3>Abstract</h3>

<p>
        OpenID Connect 1.0 は, OAuth 2.0 プロトコルの上にシンプルなアイデンティティレイヤーを付与したものである.
        このプロトコルは Client が Authorization Server の認証結果に基づいて End-User のアイデンティティを検証可能にする.
        また同時に End-User の必要最低限のプロフィール情報を, 相互運用可能かつ RESTful な形で取得することも可能にする.

</p>
<p>
        この仕様は, OpenID Connect の主要な機能である OAuth 2.0 上で End-User の情報伝達のためにクレームを用いる認証機能 を定義する.
        この仕様はまた, OpenID Connect を利用するための Security, Privacy Considerations を説明する.

</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#Introduction">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rnc">1.1.</a>&nbsp;
Requirements Notation and Conventions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Terminology">1.2.</a>&nbsp;
Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Overview">1.3.</a>&nbsp;
Overview<br />
<a href="#IDToken">2.</a>&nbsp;
ID Token<br />
<a href="#Authentication">3.</a>&nbsp;
Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#CodeFlowAuth">3.1.</a>&nbsp;
Authentication using the Authorization Code Flow<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#CodeFlowSteps">3.1.1.</a>&nbsp;
Authorization Code Flow Steps<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AuthorizationEndpoint">3.1.2.</a>&nbsp;
Authorization Endpoint<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AuthRequest">3.1.2.1.</a>&nbsp;
Authentication Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AuthRequestValidation">3.1.2.2.</a>&nbsp;
Authentication Request Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Authenticates">3.1.2.3.</a>&nbsp;
Authorization Server Authenticates End-User<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Consent">3.1.2.4.</a>&nbsp;
Authorization Server Obtains End-User Consent/Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AuthResponse">3.1.2.5.</a>&nbsp;
Successful Authentication Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AuthError">3.1.2.6.</a>&nbsp;
Authentication Error Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AuthResponseValidation">3.1.2.7.</a>&nbsp;
Authentication Response Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TokenEndpoint">3.1.3.</a>&nbsp;
Token Endpoint<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TokenRequest">3.1.3.1.</a>&nbsp;
Token Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TokenRequestValidation">3.1.3.2.</a>&nbsp;
Token Request Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TokenResponse">3.1.3.3.</a>&nbsp;
Successful Token Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TokenErrorResponse">3.1.3.4.</a>&nbsp;
Token Error Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TokenResponseValidation">3.1.3.5.</a>&nbsp;
Token Response Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#CodeIDToken">3.1.3.6.</a>&nbsp;
ID Token<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#IDTokenValidation">3.1.3.7.</a>&nbsp;
ID Token Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#CodeFlowTokenValidation">3.1.3.8.</a>&nbsp;
Access Token Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ImplicitFlowAuth">3.2.</a>&nbsp;
Authentication using the Implicit Flow<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ImplicitFlowSteps">3.2.1.</a>&nbsp;
Implicit Flow Steps<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ImplicitAuthorizationEndpoint">3.2.2.</a>&nbsp;
Authorization Endpoint<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ImplicitAuthRequest">3.2.2.1.</a>&nbsp;
Authentication Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ImplicitValidation">3.2.2.2.</a>&nbsp;
Authentication Request Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ImplicitAuthenticates">3.2.2.3.</a>&nbsp;
Authorization Server Authenticates End-User<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ImplicitConsent">3.2.2.4.</a>&nbsp;
Authorization Server Obtains End-User Consent/Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ImplicitAuthResponse">3.2.2.5.</a>&nbsp;
Successful Authentication Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ImplicitAuthError">3.2.2.6.</a>&nbsp;
Authentication Error Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ImplicitCallback">3.2.2.7.</a>&nbsp;
Redirect URI Fragment Handling<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ImplicitAuthResponseValidation">3.2.2.8.</a>&nbsp;
Authentication Response Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ImplicitTokenValidation">3.2.2.9.</a>&nbsp;
Access Token Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ImplicitIDToken">3.2.2.10.</a>&nbsp;
ID Token<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ImplicitIDTValidation">3.2.2.11.</a>&nbsp;
ID Token Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridFlowAuth">3.3.</a>&nbsp;
Authentication using the Hybrid Flow<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridFlowSteps">3.3.1.</a>&nbsp;
Hybrid Flow Steps<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridAuthorizationEndpoint">3.3.2.</a>&nbsp;
Authorization Endpoint<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridAuthRequest">3.3.2.1.</a>&nbsp;
Authentication Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridValidation">3.3.2.2.</a>&nbsp;
Authentication Request Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridAuthenticates">3.3.2.3.</a>&nbsp;
Authorization Server Authenticates End-User<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridConsent">3.3.2.4.</a>&nbsp;
Authorization Server Obtains End-User Consent/Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridAuthResponse">3.3.2.5.</a>&nbsp;
Successful Authentication Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridAuthError">3.3.2.6.</a>&nbsp;
Authentication Error Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridCallback">3.3.2.7.</a>&nbsp;
Redirect URI Fragment Handling<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridAuthResponseValidation">3.3.2.8.</a>&nbsp;
Authentication Response Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridTokenValidation">3.3.2.9.</a>&nbsp;
Access Token Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#CodeValidation">3.3.2.10.</a>&nbsp;
Authorization Code Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridIDToken">3.3.2.11.</a>&nbsp;
ID Token<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridIDTValidation">3.3.2.12.</a>&nbsp;
ID Token Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridTokenEndpoint">3.3.3.</a>&nbsp;
Token Endpoint<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridTokenRequest">3.3.3.1.</a>&nbsp;
Token Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridTokenRequestValidation">3.3.3.2.</a>&nbsp;
Token Request Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridTokenResponse">3.3.3.3.</a>&nbsp;
Successful Token Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridTokenErrorResponse">3.3.3.4.</a>&nbsp;
Token Error Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridTokenResponseValidation">3.3.3.5.</a>&nbsp;
Token Response Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridIDToken2">3.3.3.6.</a>&nbsp;
ID Token<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridIDTValidation2">3.3.3.7.</a>&nbsp;
ID Token Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridAccessToken2">3.3.3.8.</a>&nbsp;
Access Token<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HybridTokenValidation2">3.3.3.9.</a>&nbsp;
Access Token Validation<br />
<a href="#ThirdPartyInitiatedLogin">4.</a>&nbsp;
Initiating Login from a Third Party<br />
<a href="#Claims">5.</a>&nbsp;
Claims<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#StandardClaims">5.1.</a>&nbsp;
Standard Claims<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AddressClaim">5.1.1.</a>&nbsp;
Address Claim<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AdditionalClaims">5.1.2.</a>&nbsp;
Additional Claims<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ClaimsLanguagesAndScripts">5.2.</a>&nbsp;
Claims Languages and Scripts<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#UserInfo">5.3.</a>&nbsp;
UserInfo Endpoint<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#UserInfoRequest">5.3.1.</a>&nbsp;
UserInfo Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#UserInfoResponse">5.3.2.</a>&nbsp;
Successful UserInfo Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#UserInfoError">5.3.3.</a>&nbsp;
UserInfo Error Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#UserInfoResponseValidation">5.3.4.</a>&nbsp;
UserInfo Response Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ScopeClaims">5.4.</a>&nbsp;
Requesting Claims using Scope Values<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ClaimsParameter">5.5.</a>&nbsp;
Requesting Claims using the "claims" Request Parameter<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#IndividualClaimsRequests">5.5.1.</a>&nbsp;
Individual Claims Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#acrSemantics">5.5.1.1.</a>&nbsp;
Requesting the "acr" Claim<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#IndividualClaimsLanguages">5.5.2.</a>&nbsp;
Languages and Scripts for Individual Claims<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ClaimTypes">5.6.</a>&nbsp;
Claim Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#NormalClaims">5.6.1.</a>&nbsp;
Normal Claims<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AggregatedDistributedClaims">5.6.2.</a>&nbsp;
Aggregated and Distributed Claims<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AggregatedExample">5.6.2.1.</a>&nbsp;
Example of Aggregated Claims<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DistributedExample">5.6.2.2.</a>&nbsp;
Example of Distributed Claims<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ClaimStability">5.7.</a>&nbsp;
Claim Stability and Uniqueness<br />
<a href="#JWTRequests">6.</a>&nbsp;
Passing Request Parameters as JWTs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RequestObject">6.1.</a>&nbsp;
Passing a Request Object by Value<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RequestParameter">6.1.1.</a>&nbsp;
Request using the "request" Request Parameter<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RequestUriParameter">6.2.</a>&nbsp;
Passing a Request Object by Reference<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#CreateRequestUri">6.2.1.</a>&nbsp;
URL Referencing the Request Object<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#UseRequestUri">6.2.2.</a>&nbsp;
Request using the "request_uri" Request Parameter<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#GetRequestUri">6.2.3.</a>&nbsp;
Authorization Server Fetches Request Object<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RequestUriRationale">6.2.4.</a>&nbsp;
&quot;request_uri&quot; Rationale<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#JWTRequestValidation">6.3.</a>&nbsp;
Validating JWT-Based Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#EncryptedRequestObject">6.3.1.</a>&nbsp;
Encrypted Request Object<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SignedRequestObject">6.3.2.</a>&nbsp;
Signed Request Object<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RequestParameterValidation">6.3.3.</a>&nbsp;
Request Parameter Assembly and Validation<br />
<a href="#SelfIssued">7.</a>&nbsp;
Self-Issued OpenID Provider<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SelfIssuedDiscovery">7.1.</a>&nbsp;
Self-Issued OpenID Provider Discovery<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SelfIssuedRegistration">7.2.</a>&nbsp;
Self-Issued OpenID Provider Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RegistrationParameter">7.2.1.</a>&nbsp;
Providing Information with the "registration" Request Parameter<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SelfIssuedRequest">7.3.</a>&nbsp;
Self-Issued OpenID Provider Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SelfIssuedResponse">7.4.</a>&nbsp;
Self-Issued OpenID Provider Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SelfIssuedValidation">7.5.</a>&nbsp;
Self-Issued ID Token Validation<br />
<a href="#SubjectIDTypes">8.</a>&nbsp;
Subject Identifier Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#PairwiseAlg">8.1.</a>&nbsp;
Pairwise Identifier Algorithm<br />
<a href="#ClientAuthentication">9.</a>&nbsp;
Client Authentication<br />
<a href="#SigEnc">10.</a>&nbsp;
Signatures and Encryption<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Signing">10.1.</a>&nbsp;
Signing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RotateSigKeys">10.1.1.</a>&nbsp;
Rotation of Asymmetric Signing Keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Encryption">10.2.</a>&nbsp;
Encryption<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RotateEncKeys">10.2.1.</a>&nbsp;
Rotation of Asymmetric Encryption Keys<br />
<a href="#OfflineAccess">11.</a>&nbsp;
Offline Access<br />
<a href="#RefreshTokens">12.</a>&nbsp;
Using Refresh Tokens<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RefreshingAccessToken">12.1.</a>&nbsp;
Refresh Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RefreshTokenResponse">12.2.</a>&nbsp;
Successful Refresh Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RefreshErrorResponse">12.3.</a>&nbsp;
Refresh Error Response<br />
<a href="#Serializations">13.</a>&nbsp;
Serializations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#QuerySerialization">13.1.</a>&nbsp;
Query String Serialization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#FormSerialization">13.2.</a>&nbsp;
Form Serialization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#JSONSerialization">13.3.</a>&nbsp;
JSON Serialization<br />
<a href="#StringOps">14.</a>&nbsp;
String Operations<br />
<a href="#ImplementationConsiderations">15.</a>&nbsp;
Implementation Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ServerMTI">15.1.</a>&nbsp;
全てのOpenIDプロバイダが実装必須な機能について<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DynamicMTI">15.2.</a>&nbsp;
Mandatory to Implement Features for Dynamic OpenID Providers<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DiscoReg">15.3.</a>&nbsp;
Discovery and Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RPMTI">15.4.</a>&nbsp;
Mandatory to Implement Features for Relying Parties<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ImplementationNotes">15.5.</a>&nbsp;
Implementation Notes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#CodeNotes">15.5.1.</a>&nbsp;
Authorization Code Implementation Notes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#NonceNotes">15.5.2.</a>&nbsp;
Nonce Implementation Notes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#FragmentNotes">15.5.3.</a>&nbsp;
Redirect URI Fragment Handling Implementation Notes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#CompatibilityNotes">15.6.</a>&nbsp;
Compatibility Notes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#PreFinalIETFSpecs">15.6.1.</a>&nbsp;
Pre-Final IETF Specifications<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#GoogleIss">15.6.2.</a>&nbsp;
Google "iss" Value<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RelatedSpecs">15.7.</a>&nbsp;
Related Specifications and Implementer's Guides<br />
<a href="#Security">16.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RequestDisclosure">16.1.</a>&nbsp;
Request Disclosure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ServerMasquerading">16.2.</a>&nbsp;
Server Masquerading<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TokenManufacture">16.3.</a>&nbsp;
Token Manufacture/Modification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AccessTokenDisclosure">16.4.</a>&nbsp;
Access Token Disclosure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ResponseDisclosure">16.5.</a>&nbsp;
Server Response Disclosure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ServerResponseRepudiation">16.6.</a>&nbsp;
Server Response Repudiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RequestRepudation">16.7.</a>&nbsp;
Request Repudiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AccessTokenRedirect">16.8.</a>&nbsp;
Access Token Redirect<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TokenReuse">16.9.</a>&nbsp;
Token Reuse<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AuthCodeCapture">16.10.</a>&nbsp;
 Eavesdropping or Leaking Authorization Codes (Secondary Authenticator Capture)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TokenSubstitution">16.11.</a>&nbsp;
Token Substitution<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TimingAttack">16.12.</a>&nbsp;
Timing Attack<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#OtherCryptoAttacks">16.13.</a>&nbsp;
Other Crypto Related Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SigningOrder">16.14.</a>&nbsp;
Signing and Encryption Order<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#IssuerIdentifier">16.15.</a>&nbsp;
Issuer Identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ImplicitFlowThreats">16.16.</a>&nbsp;
Implicit Flow Threats<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TLSRequirements">16.17.</a>&nbsp;
TLS Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TokenLifetime">16.18.</a>&nbsp;
Lifetimes of Access Tokens and Refresh Tokens<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SymmetricKeyEntropy">16.19.</a>&nbsp;
Symmetric Key Entropy<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#NeedForSignedRequests">16.20.</a>&nbsp;
Need for Signed Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#NeedForEncryptedRequests">16.21.</a>&nbsp;
Need for Encrypted Requests<br />
<a href="#Privacy">17.</a>&nbsp;
Privacy Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#PII">17.1.</a>&nbsp;
Personally Identifiable Information<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AccessMonitoring">17.2.</a>&nbsp;
Data Access Monitoring<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Correlation">17.3.</a>&nbsp;
Correlation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#OfflineAccessPrivacy">17.4.</a>&nbsp;
Offline Access<br />
<a href="#IANA">18.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ClaimsRegistry">18.1.</a>&nbsp;
JSON Web Token Claims Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ClaimsContents">18.1.1.</a>&nbsp;
Registry Contents<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#OAuthParametersRegistry">18.2.</a>&nbsp;
OAuth Parameters Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ParametersContents">18.2.1.</a>&nbsp;
Registry Contents<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#OAuthErrorRegistry">18.3.</a>&nbsp;
OAuth Extensions Error Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ErrorContents">18.3.1.</a>&nbsp;
Registry Contents<br />
<a href="#rfc.references1">19.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">19.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">19.2.</a>&nbsp;
Informative References<br />
<a href="#AuthorizationExamples">Appendix&nbsp;A.</a>&nbsp;
Authorization Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#codeExample">A.1.</a>&nbsp;
Example using response_type=code<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#id_tokenExample">A.2.</a>&nbsp;
Example using response_type=id_token<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#id_token-tokenExample">A.3.</a>&nbsp;
Example using response_type=id_token&nbsp;token<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#code-id_tokenExample">A.4.</a>&nbsp;
Example using response_type=code&nbsp;id_token<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#code-tokenExample">A.5.</a>&nbsp;
Example using response_type=code&nbsp;token<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#code-id_token-tokenExample">A.6.</a>&nbsp;
Example using response_type=code&nbsp;id_token&nbsp;token<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ExampleRSAKey">A.7.</a>&nbsp;
RSA Key Used in Examples<br />
<a href="#Acknowledgements">Appendix&nbsp;B.</a>&nbsp;
Acknowledgements<br />
<a href="#Notices">Appendix&nbsp;C.</a>&nbsp;
Notices<br />
<a href="#History">Appendix&nbsp;D.</a>&nbsp;
Document History<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="Introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
        OpenID Connect 1.0 は, OAuth 2.0 <a class='info' href='#RFC6749'>[RFC6749]<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> プロトコルの上にシンプルなアイデンティティレイヤーを付与したものである.
        このプロトコルは Client が Authorization Server の認証結果に基づいて End-User のアイデンティティを検証可能にする.
        また同時に End-User の必要最低限のプロフィール情報を, 相互運用可能かつ RESTful な形で取得することも可能にする.

</p>
<p>
        OpenID Connect Core 1.0 仕様は, OpenID Connect の主要な機能である OAuth 2.0 上で End-User の情報伝達のためにクレームを用いる認証機能 を定義する.
        この仕様はまた, OpenID Connect を利用するための Security, Privacy Considerations を説明する.

</p>
<p>
        OpenID Connect のベースとなる <a class='info' href='#RFC6749'>OAuth 2.0 Authorization Framework<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] と <a class='info' href='#RFC6750'>OAuth 2.0 Bearer Token Usage<span> (</span><span class='info'>Jones, M. and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework: Bearer Token Usage,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6750] は, 3rd-party アプリケーションが HTTP リソースへの制限付きアクセス権を取得および行使するための全般的フレームワークを提供している.
        これらはリソースアクセスのための Access Token を取得および行使する方法は定義するが, アイデンティティ情報を提供するための標準的手段は定義しない.
        とりわけ, OAuth 2.0 のプロファイリングを行わずに End-User の認証に必要な情報を提供することは不可能である.
        本ドキュメント読者は上記2つの仕様を理解していることが期待される.

</p>
<p>
        OpenID Connect は OAuth 2.0 認可プロセスを拡張し, 認証目的で利用できるようにする.
        本拡張を利用する場合, Client は <tt>openid</tt> scope を指定して Authorization Request を送信する.
        認証結果は ID Token (<a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a> 参照) と呼ばれる <a class='info' href='#JWT'>JSON Web Token (JWT)<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token (JWT),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWT] として返される.
        OpenID Connect をサポートする OAuth 2.0 Authentication Server は, OpenID Provider (OP) とも呼ばれる.
        OpenID Connect を利用する OAuth 2.0 Client は Relying Party (RP) とも呼ばれる.

</p>
<p>
        本ドキュメントでは, Relying Party は既に Authorization Endpoint, Token Endpoint 等を含む OpenID Provider の設定情報を既に得ているものとする.
        これらの情報は通常 <a class='info' href='#OpenID.Discovery'>OpenID Connect Discovery 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., and E. Jay, &ldquo;OpenID Connect Discovery 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OpenID.Discovery] にある Discovery を通じて得られるが, その他の手段で得られることもある.

</p>
<p>
        また同様に, Relying Party は OpenID Provider 利用に必要なクレデンシャルを取得し, OP 利用に必要な情報を登録しているものとする.
        これの処理は通常 <a class='info' href='#OpenID.Registration'>OpenID Connect Dynamic Client Registration 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client Registration 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OpenID.Registration] にある Dynamic Registration を通じて行われるが, その他の手段で行われることもある.

</p>
<a name="rnc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Requirements Notation and Conventions</h3>

<p>
          本ドキュメント中の "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", および "OPTIONAL" の意味するところは, <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> の定める通りである.

</p>
<p>
          本ドキュメントの .txt バージョンでは, 表記そのままで利用される値についてはクオートで囲んでいる.
          このような値をプロトコルメッセージ中で用いる場合, クオートを含めてはならない (MUST NOT).
          HTML バージョンではクオートで囲う代わりに <tt>this fixed-width font</tt> を用いる.

</p>
<p>
          <a class='info' href='#JWS'>JSON Web Signature (JWS)<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature (JWS),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWS] と <a class='info' href='#JWE'>JSON Web Encryption (JWE)<span> (</span><span class='info'>Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;JSON Web Encryption (JWE),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWE] を用いる場合, シリアライゼーションには JWS Compact Serialization と JWE Compact Serialization を用いる.
          JWS JSON Serialization と JWE JSON Serialization は利用しない.

</p>
<a name="Terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Terminology</h3>

<p>
          本ドキュメントでは,
          <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] で定義された "Access Token", "Authorization Code",
          "Authorization Endpoint", "Authorization Grant", "Authorization Server",
          "Client", "Client Authentication", "Client Identifier", "Client Secret",
          "Grant Type", "Protected Resource", "Redirection URI", "Refresh Token",
          "Resource Owner", "Resource Server", "Response Type", および "Token Endpoint",
          <a class='info' href='#JWT'>JSON Web Token (JWT)<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token (JWT),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWT] で定義された "Claim Name", "Claim Value", "JSON Web Token (JWT)", および "Nested JWT" ,
          <a class='info' href='#RFC2616'>RFC 2616<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> [RFC2616] で定義された "User Agent",
          <a class='info' href='#OAuth.Responses'>OAuth 2.0 Multiple Response Type Encoding Practices<span> (</span><span class='info'>de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, &ldquo;OAuth 2.0 Multiple Response Type Encoding Practices,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.Responses] で定義された "Response Mode" という用語を用いる.

</p>
<p>
          本ドキュメントはその他に以下の用語を用いる.

          </p>
<blockquote class="text"><dl>
<dt>Authentication</dt>
<dd>
            提示された Identity と実際の Entity が紐づいていることを確認するプロセス.


</dd>
<dt>Authentication Request</dt>
<dd>
              OpenID Connect が定める拡張パラメータおよびスコープを利用して, Authorization Server に End-User の認証を要求する OAuth 2.0 Authorization Request.
              このとき Authorization Server は OpenID Connect Provider, Client は OpenID Connect Relying Party となる.


</dd>
<dt>Authentication Context</dt>
<dd>
              認証応答に関する意思決定を行う前に Relying Party が要求できる情報.
              そのようなコンテキストは実際に用いられた認証方式や <a class='info' href='#ISO29115'>ISO/IEC 29115<span> (</span><span class='info'>International Organization for Standardization, &ldquo;ISO/IEC 29115:2013 --           Information technology - Security techniques - Entity authentication           assurance framework,&rdquo; March&nbsp;2013.</span><span>)</span></a> [ISO29115] entity authentication assurance level のような保障レベルを含むが, これに限定されるものではない.


</dd>
<dt>Authentication Context Class</dt>
<dd>
              特定のコンテキストで互いに等しいと考えられる認証方式もしくは手続きの集合.


</dd>
<dt>Authentication Context Class Reference</dt>
<dd>
              Authentication Context Class の識別子.


</dd>
<dt>Authorization Code Flow</dt>
<dd>
              Authorization Code が Authorization Endpoint から返され, 全てのトークンが Token Endpoint から返されるOAuth 2.0 のフロー.


</dd>
<dt>Authorization Request</dt>
<dd>
              <a class='info' href='#RFC6749'>[RFC6749]<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> にて定義された OAuth 2.0 Authorization Request.


</dd>
<dt>Claim</dt>
<dd>
              Entity に関する情報の部分集合.


</dd>
<dt>Claim Type</dt>
<dd>
              Claim の値を表現する構文.
              本仕様では Normal, Aggregated, および Distributed という Claim Type を定義する.


</dd>
<dt>Claims Provider</dt>
<dd>
              Entity の Claim を返すサーバー.


</dd>
<dt>Credential</dt>
<dd>
              Identity や他のリソースを使用する権利があることの証拠として提示されるデータ.


</dd>
<dt>End-User</dt>
<dd>
              一連のフローに参加する人間.


</dd>
<dt>Entity</dt>
<dd>
              あるコンテキストの中で識別される, 他と独立した個.
              End-User は Entity の一例.


</dd>
<dt>Essential Claim</dt>
<dd>
              Client により指定される Claim.
              End-User により要求された特定のタスクに対して円滑な認可処理を確保するために必要とされている.


</dd>
<dt>Hybrid Flow</dt>
<dd>
              Authorization Code といくつかのトークンが Authorization Endpoint から返され, その他のトークンが Token Endpoint から返される OAuth 2.0 のフロー.


</dd>
<dt>ID Token</dt>
<dd>
              Authentication イベントに関する Claim を含む <a class='info' href='#JWT'>JSON Web Token (JWT)<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token (JWT),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWT].
              その他の Claim を含むこともある (MAY).


</dd>
<dt>Identifier</dt>
<dd>
              あるコンテキスト中で Entity をユニークに特徴づける値.


</dd>
<dt>Identity</dt>
<dd>
              Entity に関する属性の集合.


</dd>
<dt>Implicit Flow</dt>
<dd>
              全てのトークンが Authorization Endpoint から返され, Token Endpoint も Authorization Code も利用されない OAuth 2.0 のフロー.


</dd>
<dt>Issuer</dt>
<dd>
              Claim の集合を発行する Entity.


</dd>
<dt>Issuer Identifier</dt>
<dd>
              検証可能な Issuer の識別子.
              Issuer Identifier は, 大文字小文字を区別する URL である.
              この URL は <tt>https</tt> スキーム, ホスト, そして任意でポート番号およびパス要素からなり, クエリーとフラグメント要素は含まない.


</dd>
<dt>Message</dt>
<dd>
              OpenID Relying Party と OpenID Provider の間でやりとりされるリクエストもしくはレスポンス.


</dd>
<dt>OpenID Provider (OP)</dt>
<dd>
              End-User を Authenticate できる OAuth 2.0 Authorization Server.
              End-User の Authentication イベントに関する Claim を Relying Party に提供する.


</dd>
<dt>Request Object</dt>
<dd>
              Claim としてリクエストパラメータを含む JWT.


</dd>
<dt>Request URI</dt>
<dd>
              Request Object を含むリソースを参照する URL.
              Request URI のコンテンツは Authorization Server から取得可能でなければならない (MUST).


</dd>
<dt>Pairwise Pseudonymous Identifier (PPID)</dt>
<dd>
              ある Relying Party に対してのみ, ある Entity の識別子として提供される値.
              他の Relying Party には, 当該 PPID を当該 Entity と関連づけることはできない.


</dd>
<dt>Personally Identifiable Information (PII)</dt>
<dd>
              特定の人物に紐づき, 実際の人物の識別に用いることができる情報.
              もしくは特定の人物に直接および間接的にリンクされる可能性のある情報.


</dd>
<dt>Relying Party (RP)</dt>
<dd>
              OpenID Provider に End-User Authentication と Claim を要求する OAuth 2.0 Client.


</dd>
<dt>Sector Identifier</dt>
<dd>
              Relying Party により利用される URL のホスト要素.
              Relying Party に対する Subject Identifier 計算の入力となる.


</dd>
<dt>Self-Issued OpenID Provider</dt>
<dd>
              自己署名の ID Token を発行する, 個人的で self-hosted な OpenID Provider.


</dd>
<dt>Subject Identifier</dt>
<dd>
              Issuer にとって局地的にユニークで再利用されることのない End-User 識別子.
              この値は Client に利用されることを想定する.


</dd>
<dt>UserInfo Endpoint</dt>
<dd>
              Protected Resource のひとつ.
              Access Token を提示する Client に対して, Authorization Grant に従って End-User に関する情報を提供する.
              URLは <tt>https</tt> scheme を利用しなければならず (MUST), ポート番号, パス, クエリパラメータの要素を含むことがある (MAY).


</dd>
<dt>Validation</dt>
<dd>
              あるものごとの健全性および正当性を確立するためのプロセス.


</dd>
<dt>Verification</dt>
<dd>
              ある事実や値の正確さを検査もしくは証明するためのプロセス.


</dd>
<dt>Voluntary Claim</dt>
<dd>
              Client が End-User が要求するあるタスクを実行する際に, 有用ではあるが Essential ではないとを Client が指定した Claim.


</dd>
</dl></blockquote><p>

</p>
<p>
          IMPORTANT NOTE TO READERS:
          上記の用語定義は本仕様が定めるところであり, 本仕様の実装においてはこれらの定義に従うこと.
          "Issuer Identifier" をはじめとして, 本仕様で大文字表記されている用語はすべて上記の定義に従う.
          仕様書読者は必ずこれらの用語定義に従うこと.

</p>
<p>
          利用される用語の一部分の詳細を知るために, <a class='info' href='#RFC4949'>Internet Security Glossary, Version 2<span> (</span><span class='info'>Shirey, R., &ldquo;Internet Security Glossary, Version 2,&rdquo; August&nbsp;2007.</span><span>)</span></a> [RFC4949], <a class='info' href='#ISO29115'>ISO/IEC 29115 Entity Authentication Assurance<span> (</span><span class='info'>International Organization for Standardization, &ldquo;ISO/IEC 29115:2013 --           Information technology - Security techniques - Entity authentication           assurance framework,&rdquo; March&nbsp;2013.</span><span>)</span></a> [ISO29115], および <a class='info' href='#X.1252'>ITU-T X.1252<span> (</span><span class='info'>International Telecommunication Union, &ldquo;ITU-T Recommendation X.1252 -- Cyberspace security -- Identity management           -- Baseline identity management terms and definitions,&rdquo; November&nbsp;2010.</span><span>)</span></a> [X.1252] を参照すること.

</p>
<a name="Overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Overview</h3>

<p>概要にある OpenID Connect プロトコルは以下の手順に従う.
</p>
<p>
          </p>
<ol class="text">
<li>RP (クライアント)は OpenID プロバイダー (OP) にリクエストを送る.
</li>
<li>OP は End-User を認証し認可を与える.
</li>
<li>OP は ID トークンと通常はアクセストークンによって応答する.
</li>
<li>RP はアクセストークンを使って UserInfo エンドポイントにリクエストを送ることができる.
</li>
<li>UserInfo エンドポイントは End-User についてクレームを返却する.
</li>
</ol><p>

</p>
<p>
            これらの手順は以下の図に示されている:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+--------+                                   +--------+
|        |                                   |        |
|        |---------(1) AuthN Request--------&gt;|        |
|        |                                   |        |
|        |  +--------+                       |        |
|        |  |        |                       |        |
|        |  |  End-  |&lt;--(2) AuthN &amp; AuthZ--&gt;|        |
|        |  |  User  |                       |        |
|   RP   |  |        |                       |   OP   |
|        |  +--------+                       |        |
|        |                                   |        |
|        |&lt;--------(3) AuthN Response--------|        |
|        |                                   |        |
|        |---------(4) UserInfo Request-----&gt;|        |
|        |                                   |        |
|        |&lt;--------(5) UserInfo Response-----|        |
|        |                                   |        |
+--------+                                   +--------+
</pre></div>
<a name="IDToken"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
ID Token</h3>

<p>
        End-Users の認証を可能にするために OpenID Connect が OAuth 2.0 に行う主要な拡張機能は ID トークンデータ構造である.ID トークンは, あるクライアントを使用している際に認可サーバーによる End-User の認証についてのクレームと, 潜在的な他の要求されるクレームを含むセキュリティトークンである.

</p>
<p>
        OpenID Connect で使用されている全ての OAuth 2.0 のフローのために, ID トークン内で以下のクレームが使用される:

</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>iss</dt>
<dd>
            必須(REQUIRED).レスポンスの発行者のための Issuer 識別子.<tt>iss</tt> の値は, クエリやフラグメントの要素を含まないスキーム, ホスト, 任意のポート番号とパスからなる <tt>https</tt> スキームを使用した大文字と小文字を区別する URL である.

</dd>
<dt>sub</dt>
<dd>
            必須(REQUIRED).Subject 識別子.例えば, <tt>24400320</tt> や <tt>AItOawmwtWwcT0k51BayewNvutrJUqsvl6qs7A4</tt> のようなクライアントに使われることを意図し, End-User のための発行者内で一意であり決して再割り当てされない識別子である.ASCII で255文字を超えてはならない(MUST NOT).<tt>sub</tt> の値は大文字と小文字を区別する文字列である.

</dd>
<dt>aud</dt>
<dd>
            必須(REQUIRED).この ID トークンを対象とする Audience(s).audience の値として Relying Party のOAuth 2.0 の <tt>client_id</tt> を含まなければならない(MUST).また他の audiences のための識別子を含んでもよい(MAY).一般的な場合には, <tt>aud</tt> の値は大文字と小文字を区別する文字列の配列である. audience が1つである際の共通の特殊な場合には, <tt>aud</tt> の値は大文字と小文字を区別した文字列でもよい(MAY).

</dd>
<dt>exp</dt>
<dd>
            必須(REQUIRED).それ以降, ID トークンを処理のために受け入れてはいけない有効期限(MUST NOT).このパラメーターの処理は, 現在の日付/時刻が値の中に記載されている有効期限の日付/時刻以前でなければならない(MUST).実装者は, クロック・キューを考慮するために, 通常は数分間以下の多少の余地を提供してもよい(MAY).その値は, その日付/時刻まで UTC で計測される 1970-01-01T0:0:0Z から秒数を表す JSON 番号である.通常, そして特殊な UTC の日付/時刻に関する詳細は <a class='info' href='#RFC3339'>RFC 3339<span> (</span><span class='info'>Klyne, G., Ed. and C. Newman, &ldquo;Date and Time on the Internet: Timestamps,&rdquo; July&nbsp;2002.</span><span>)</span></a> [RFC3339] を参照すること.

</dd>
<dt>iat</dt>
<dd>
            必須(REQUIRED).JWT が発行された時刻.その値は, その日付/時刻まで UTC で計測される 1970-01-01T0:0:0Z から秒数を表す JSON 番号である.

</dd>
<dt>auth_time</dt>
<dd>
            End-User の認証が行われた時刻.その値は, その日付/時刻まで UTC で計測される 1970-01-01T0:0:0Z から秒数を表す JSON 番号である.<tt>max_age</tt> リクエストが生成されたとき, あるいは <tt>auth_time</tt> が不可欠なクレームとして要求されたとき, そのクレームは必須である(REQUIRED).または, それを含めることは任意である(OPTIONAL).(<tt>auth_time</tt> クレームは意味的に OpenID 2.0 <a class='info' href='#OpenID.PAPE'>PAPE<span> (</span><span class='info'>Recordon, D., Jones, M., Bufu, J., Ed., Daugherty, J., Ed., and N. Sakimura, &ldquo;OpenID Provider           Authentication Policy Extension 1.0,&rdquo; December&nbsp;2008.</span><span>)</span></a> [OpenID.PAPE] <tt>auth_time</tt> レスポンスパラメーターに対応する.)

</dd>
<dt>nonce</dt>
<dd>
            文字列の値は, ID トークンとクライアントセッションを関連づけるため, リプレイアタックの軽減に使用される.その値は, 認証リクエストから ID トークンに変更されずに通過される.ID トークンの中に存在する場合, クライアントはその <tt>nonce</tt> クレームの値が認証リクエストで送信された <tt>nonce</tt> パラメーターの値と同じであるか検証しなければならない(MUST).認証リクエストに存在する場合, 認可サーバーは認証リクエストで送信された nonce の値であるクレーム値を用いて ID トークンの中に <tt>nonce</tt> クレームを含めなければならない(MUST).認可サーバーは使用される <tt>nonce</tt> 値でその他の処理を行うべきではない(SHOULD).<tt>nonce</tt> 値は大文字と小文字を区別する文字列である.

</dd>
<dt>acr</dt>
<dd>
            任意(OPTIONAL).Authentication Context Class Reference.認証が成功して実行される認証コンテキストクラスを識別する認証コンテキストクラスリファレンスの値を指定する文字列.”0” の値は, End-User の認証が <a class='info' href='#ISO29115'>ISO/IEC 29115<span> (</span><span class='info'>International Organization for Standardization, &ldquo;ISO/IEC 29115:2013 --           Information technology - Security techniques - Entity authentication           assurance framework,&rdquo; March&nbsp;2013.</span><span>)</span></a> [ISO29115] level 1 の要求に合っていないことを示す.例えば, 長期間有効なブラウザー Cookie を使用する認証が "level 0” の使用は適切である例である.level 0 を用いた認証は金銭的な値のリソースへのアクセスを認可するために使用すべきではない(SHOULD NOT).(これは OpenID 2.0 <a class='info' href='#OpenID.PAPE'>PAPE<span> (</span><span class='info'>Recordon, D., Jones, M., Bufu, J., Ed., Daugherty, J., Ed., and N. Sakimura, &ldquo;OpenID Provider           Authentication Policy Extension 1.0,&rdquo; December&nbsp;2008.</span><span>)</span></a> [OpenID.PAPE] <tt>nist_auth_level</tt> 0 に対応する.)
            絶対 URI あるいは <a class='info' href='#RFC6711'>RFC 6711<span> (</span><span class='info'>Johansson, L., &ldquo;An IANA Registry for Level of Assurance (LoA) Profiles,&rdquo; August&nbsp;2012.</span><span>)</span></a> [RFC6711] の予約語は <tt>acr</tt> 値として使用すべきであり(SHOULD), 予約語は登録されているものとは異なる意味で使用してはいけない(MUST NOT).このクレームを使用している Relying Parties はコンテキスト固有であるかもしれない使用されているその値の意味について同意する必要がある.<tt>acr</tt> 値は大文字と小文字を区別する文字列である.

</dd>
<dt>amr</dt>
<dd>
            任意(OPTIONAL).Authentication Methods References.認証の中で使用される認証のための識別子となる文字列の JSON 配列である.例えば, 値はパスワードと OTP 認証方法の両方が使用されることを示すかもしれない.<tt>amr</tt> クレームで使用される特殊な値の定義は, この仕様の範囲を超える.Relying Parties はコンテキスト固有であるかもしれない使用されているその値の意味について同意する必要がある.<tt>amr</tt> 値は大文字と小文字を区別する文字列である.

</dd>
<dt>azp</dt>
<dd>
            任意(OPTIONAL).Authorized party.ID トークンを発行された Relying Partyである.これがある場合, この party の OAuth 2.0 の Client ID を含めなければならない(MUST).ID トークンは1つの audience 値が含まれ, その audience が authorized party とは異なるときにこのクレームのみ必要である.Authorized party が単一の audience として同じときそれは含まれているかもしれない.<tt>azp</tt> 値は文字列または URI を含む大文字と小文字を区別する文字列である.

</dd>
</dl></blockquote><p>

</p>
<p>
        ID トークンは他のクレームを含むかもしれない(MAY).
        解明されない使用されるいくつかのクレームは無視しなければならない(MUST).この仕様によって定義される追加のクレームのための
        <a class='info' href='#CodeIDToken'>3.1.3.6<span> (</span><span class='info'>ID Token</span><span>)</span></a>,
        <a class='info' href='#HybridIDToken'>3.3.2.11<span> (</span><span class='info'>ID Token</span><span>)</span></a>,
        <a class='info' href='#StandardClaims'>5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> と
        <a class='info' href='#SelfIssuedResponse'>7.4<span> (</span><span class='info'>Self-Issued OpenID Provider Response</span><span>)</span></a>
        セクションを参照すること.

</p>
<p>
        ID トークンは <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature (JWS),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWS] によって署名される, <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature (JWS),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWS] と <a class='info' href='#JWE'>JWE<span> (</span><span class='info'>Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;JSON Web Encryption (JWE),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWE] のそれぞれによって署名された後に暗号化の両方をされていなければならない(MUST).これにより各 <a class='info' href='#SigningOrder'>Section&nbsp;16.14<span> (</span><span class='info'>Signing and Encryption Order</span><span>)</span></a> に, 認証, 完全性, 否認防止, および任意で機密性を提供する.
        ID トークンが暗号化されている場合, <a class='info' href='#JWT'>[JWT]<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token (JWT),&rdquo; November&nbsp;2013.</span><span>)</span></a> で定義されている入れ子 JWT である結果を用いて署名されてから暗号化されなければならなく(MUST), 認可エンドポイントから ID トークンのない戻り値を使用するレスポンスタイプ(認可コードフローを用いているときこのようになる)で, 登録時に明示的に <tt>none</tt> の使用を要求したクライアントでない限り, ID トークンは <tt>alg</tt> 値として <tt>none</tt> を使用してはいけない(MUST NOT).

</p>
<p>
        ID トークンは JWS あるいは JWE の
        <tt>x5u</tt>,
        <tt>x5c</tt>,
        <tt>jku</tt> と
        <tt>jwk</tt>
        ヘッダーパラメーターフィールド を使用すべきではない.代わりに, 使用されるキーへの参照は各 <a class='info' href='#SigEnc'>Section&nbsp;10<span> (</span><span class='info'>Signatures and Encryption</span><span>)</span></a> に Discovery と Registration parameters を用いて事前に伝えられる.

</p>
<p>
          以下は ID トークン中のクレームセット(JWT クレームセット)の一例である:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "iss": "https://server.example.com",
   "sub": "24400320",
   "aud": "s6BhdRkqt3",
   "nonce": "n-0S6_WzA2Mj",
   "exp": 1311281970,
   "iat": 1311280970,
   "auth_time": 1311280969,
   "acr": "urn:mace:incommon:iap:silver"
  }
</pre></div>
<a name="Authentication"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Authentication</h3>

<p>
          OpenID Connectではエンドユーザのログインもしくは既にログイン済みのエンドユーザを確定するために認証を行う。
          OpenID Connectでは、クライアントが信頼できるように安全な方式でサーバからクライアントへ認証結果を返却する。
          このような理由のため、この場合ではクライアントのことをRelying Party(RP)と呼ぶ。

</p>
<p>
          認証結果は<a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a>で定義されているようにID Tokenに含まれて返却される。
          ID Tokenには発行者、Subject識別子、認証の有効期限などを表すClaimが含まれる。

</p>
<p>
          認証にはAuthorization Codeフロー（<tt>response_type=code</tt>）とImplicitフロー（<tt>response_type=id_token&nbsp;token</tt>か<tt>response_type=id_token</tt>）およびHybrid Flow（<a class='info' href='#OAuth.Responses'>Oauth 2.0 Multiple Response Type Encoding Practices<span> (</span><span class='info'>de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, &ldquo;OAuth 2.0 Multiple Response Type Encoding Practices,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.Responses]で定義される他のレスポンスタイプ値を利用）の３つのフローのうち１つを選ぶことができる。
          フローによってID TokenとAccess Tokenがどのようにクライアントへ返却されるか決定される。

</p>
<p>
          ３つのフローの特徴を以下の参考表に記載する。
          この表は特定のコンテキストにおいてどのフローを選択すればよいかの指針を示すことを意図している。

</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left"><col align="left">
<tr><th align="left">Property</th><th align="left">Authorization Code Flow</th><th align="left">Implicit Flow</th><th align="left">Hybrid Flow</th></tr>
<tr>
<td align="left">全てのトークンはAuthorizationエンドポイントから返却される</td>
<td align="left">no</td>
<td align="left">yes</td>
<td align="left">no</td>
</tr>
<tr>
<td align="left">全てのトークンはTokenエンドポイントから返却される</td>
<td align="left">yes</td>
<td align="left">no</td>
<td align="left">no</td>
</tr>
<tr>
<td align="left">User Agentからトークンを取得できない</td>
<td align="left">yes</td>
<td align="left">no</td>
<td align="left">no</td>
</tr>
<tr>
<td align="left">クライアントを認証することが可能である</td>
<td align="left">yes</td>
<td align="left">no</td>
<td align="left">yes</td>
</tr>
<tr>
<td align="left">Refresh Tokenを利用できる</td>
<td align="left">yes</td>
<td align="left">no</td>
<td align="left">yes</td>
</tr>
<tr>
<td align="left">通信が１往復だけである</td>
<td align="left">no</td>
<td align="left">yes</td>
<td align="left">no</td>
</tr>
<tr>
<td align="left">ほぼサーバ間通信である</td>
<td align="left">yes</td>
<td align="left">no</td>
<td align="left">varies</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;OpenID Connect Authentication Flows&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
          利用しているフローはAuthorizationリクエストに含まれる<tt>response_type</tt>値によって決定される。
          これらの<tt>response_type</tt>値は下記のフローを選択する。

</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">"response_type"値</th><th align="left">Flow</th><th align="left">Flow</th></tr>
<tr>
<td align="left"><tt>code</tt>&nbsp;</td>
<td align="left">Authorization Code Flow</td>
<td align="left"><tt>id_token</tt>&nbsp;</td>
</tr>
<tr>
<td align="left">Implicit Flow</td>
<td align="left"><tt>id_token&nbsp;token</tt>&nbsp;</td>
<td align="left">Implicit Flow</td>
</tr>
<tr>
<td align="left"><tt>code&nbsp;id_token</tt>&nbsp;</td>
<td align="left">Hybrid Flow</td>
<td align="left"><tt>code&nbsp;token</tt>&nbsp;</td>
</tr>
<tr>
<td align="left">Hybrid Flow</td>
<td align="left"><tt>code&nbsp;id_token&nbsp;token</tt>&nbsp;</td>
<td align="left">Hybrid Flow</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;OpenID Connect "response_type" Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
          <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749]で定義されている<tt>code</tt>以外のレスポンスタイプ値は<a class='info' href='#OAuth.Responses'>OAuth 2.0 Multiple Response Type Encoding Practices<span> (</span><span class='info'>de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, &ldquo;OAuth 2.0 Multiple Response Type Encoding Practices,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.Responses]の仕様にて定義されている。
          注意：OAuth 2.0ではImplicitフローでレスポンスタイプ値<tt>token</tt>を定義してはいるが、OpenID ConnectではID Tokenが返却されることがないためこのレスポンスタイプは利用していない。

</p>
<a name="CodeFlowAuth"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Authentication using the Authorization Code Flow</h3>

<p>
            この章ではAuthorization Codeフローを使ってどのように認証を行うかを記載する。
            Authorization Codeフローを利用する祭、全てのトークンはToken Endpointから返却される。

</p>
<p>
            Authorization Codeフローではクライアントに認可コードを返却し、クライアントはそれを直接ID TokenとAccess TOkenと交換できるようになる。
            これによりUser AgentやUser Agentにアクセスできる悪意のあるアプリケーションにどのトークンも公開されることがない恩恵が得られる。
            Authorizationサーバは認可コードをAccess Tokenと交換する前にクライアントの認証を行うこともできる。
            Authorization CodeフローはClient SecretをクライアントとAuthorizationサーバ間で安全に保持できるクライアントに適している。

</p>
<a name="CodeFlowSteps"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Authorization Code Flow Steps</h3>

<p>
              Authorization Codeフローは以下のステップを経る。

</p>
<p>
            </p>
<ol class="text">
<li>
                  クライアントは必要なパラメータを含むAuthorizationリクエストの準備をする。

</li>
<li>クライアントはAuthorizationサーバへリクエストを送信する
</li>
<li>Authorizationサーバはエンドユーザを認証する。
</li>
<li>Authorizationサーバはエンドユーザの同意/認可を得る。
</li>
<li>Authorizationサーバはエンドユーザを認可コードをつけてクライアントへ送信する
</li>
<li>クライアントはToken Endpointへ認可コードを使ってリクエストを送信する。
</li>
<li>クライアントはID TokenとAccess Tokenをレスポンスボディに含むレスポンスを受け取る
</li>
<li>クライアントはID Tokenを検証し、エンドユーザのSubject識別子を取得する。
</li>
</ol><p>

</p>
<a name="AuthorizationEndpoint"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
Authorization Endpoint</h3>

<p>
            Authorization Endpoint は End-User の認証を実行する.
            この処理は, OAuth 2.0 で定義された要求パラメータ及び OpenID Connect で定義された追加されたパラメータとパラメータ値を使用して、認証及び認可のためにユーザーエージェントを Authorization Server の Authorization Endpoint に送ることで行われる.

</p>
<p>
            Authorization Endpoint との通信は TLS を用いなければならない (MUST).
            TLSの利用についての詳細な情報は <a class='info' href='#TLSRequirements'>Section&nbsp;16.17<span> (</span><span class='info'>TLS Requirements</span><span>)</span></a> を参照すること.

</p>
<a name="AuthRequest"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2.1"></a><h3>3.1.2.1.&nbsp;
Authentication Request</h3>

<p>
              Authentication Request は Authorization Server による End-User の認証を要求する OAuth 2.0 の Authorization Request である.

</p>
<p>
              Authorization Server は Authorization Endpoint において <a class='info' href='#RFC2616'>RFC 2616<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> [RFC2616] で定義された HTTP <tt>GET</tt> メソッドと HTTP <tt>POST</tt> メソッドをサポートしなければならない (MUST).
              クライアントは Authorization Server への Authorization Request の送信に HTTP <tt>GET</tt> メソッドか HTTP <tt>POST</tt> メソッドを使用できる (MAY).
              HTTP <tt>GET</tt> メソッドを使用する場合, リクエストパラメータは URI Query String Serialization ( <a class='info' href='#QuerySerialization'>Section&nbsp;13.1<span> (</span><span class='info'>Query String Serialization</span><span>)</span></a> ) に従ってシリアライズされる.
              HTTP <tt>POST</tt> メソッドを使用する場合, リクエストパラメータは Form Serialization ( <a class='info' href='#FormSerialization'>Section&nbsp;13.2<span> (</span><span class='info'>Form Serialization</span><span>)</span></a> ) に従ってシリアライズされる.

</p>
<p>
              OpenID Connect は Authorization Code Flow で以下 のOAuth 2.0 リクエストパラメータを利用する.

</p>
<p>
              </p>
<blockquote class="text"><dl>
<dt>scope</dt>
<dd>
                  REQUIRED.
                  OpenID Connect リクエストは scope に <tt>openid</tt> を含まねばならない (MUST).
                  <tt>openid</tt> scope 値が存在しない場合の挙動は定義しない.
                  他の scope 値が存在していても良い (MAY).
                  使用された scope 値で, 実装によって理解されないものは無視されるべきである (SHOULD).
                  本仕様によって定義される追加の scope 値については <a class='info' href='#ScopeClaims'>5.4<span> (</span><span class='info'>Requesting Claims using Scope Values</span><span>)</span></a> と <a class='info' href='#OfflineAccess'>11<span> (</span><span class='info'>Offline Access</span><span>)</span></a> セクションを参照すること.

</dd>
<dt>response_type</dt>
<dd>
                  REQUIRED.
                  使用されたエンドポイントからどのようなパラメータが返されるのかを含んだ, 使用される認証処理フローを決定する OAuth 2.0 のレスポンスタイプ値.
                  Authorization Code Flowを 使用する場合, この値は <tt>code</tt> となる.

</dd>
<dt>client_id</dt>
<dd>
                  REQUIRED.
                  Authorization Server における OAuth 2.0 Client Identifier の値.

</dd>
<dt>redirect_uri</dt>
<dd>
                  REQUIRED.
                  レスポンスが返される Redirection URI.
                  この URI は, Client が OpenID Provider に対して事前に登録済みの Redirection URI のいずれかと完全一致しなければならない (MUST).
                  マッチングルールは <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> (Simple String Comparison) の Section 6.2.1 に従うこと.
                  このフローを使用する場合, Redirection URI は <tt>https</tt> スキーマを利用することが望まれる (SHOULD) が, Client Type が <tt>confidential</tt> であり, かつ OP が <tt>http</tt> の利用を容認する場合に限り, <tt>http</tt> スキーマを利用してもよい (MAY).
                  Client Type 等の定義については OAuth 2.0 の Section 2.1 を参照のこと.
                  Redirection URI には, ネイティブアプリケーションにコールバックを送る目的などで, 上記以外のスキーマを利用することもできる.

</dd>
<dt>state</dt>
<dd>
                  RECOMMENDED.
                  リクエストとコールバックの間で維持されるランダムな値.
                  一般的に Cross-Site Request Forgery (CSRF, XSRF) 対策の目的で利用される, ブラウザ Cookie と紐づく暗号論的にセキュアな値を取る.

</dd>
</dl></blockquote><p>

</p>
<p>
              OpenID Connect は上記に加えて <a class='info' href='#OAuth.Responses'>OAuth 2.0 Multiple Response Type Encoding Practices<span> (</span><span class='info'>de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, &ldquo;OAuth 2.0 Multiple Response Type Encoding Practices,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.Responses] で定義された以下の OAuth 2.0 でのリクエストパラメータを利用する:

</p>
<p>

              </p>
<blockquote class="text"><dl>
<dt>response_mode</dt>
<dd>
                  OPTIONAL.
                  Authorization Endpoint からパラメータを返すために Authorization Server が使用する方法を通知する.
                  要求されるレスポンスモードがレスポンスタイプで指定されるデフォルトモードである場合, このパラメータの使用は推奨されない (NOT RECOMMENDED).

</dd>
</dl></blockquote><p>

</p>
<p>
              本仕様は上記に加えて以下のリクエストパラメータを定義する.

</p>
<p>
              </p>
<blockquote class="text"><dl>
<dt>nonce</dt>
<dd>
                  OPTIONAL.
                  Client セッションと ID Token を紐づける文字列であり, リプレイアタック対策に用いられる.
                  この値は Authentication Request で指定され, そのままの値で ID Token に含まれる.
                  <tt>nonce</tt> 値には, 推測不可能なように十分なエントロピーを持たせること (MUST).
                  実装の注意事項については <a class='info' href='#NonceNotes'>Section&nbsp;15.5.2<span> (</span><span class='info'>Nonce Implementation Notes</span><span>)</span></a> を参照すること.

</dd>
<dt>display</dt>
<dd>
                  OPTIONAL.
                  Authorization Server が認証および同意のためのユーザーインタフェースを End-User にどのように表示するかを指定するための ASCII 値.
                  以下の値が定義されている.


<blockquote class="text"><dl>
<dt>page</dt>
<dd>
                      Authorization Server は認証および同意 UI を User Agent の全画面に表示すべきである (SHOULD).
                      display パラメータが指定されていない場合, この値がデフォルトとなる.

</dd>
<dt>popup</dt>
<dd>
                      Authorization Server は認証および同意 UI を User Agent のポップアップウィンドウに表示すべきである (SHOULD).
                      User Agent のポップアップウィンドウはログインダイアログに適切なサイズで, 親ウィンドウ全体を覆うことのないようにすべきである.

</dd>
<dt>touch</dt>
<dd>
                      Authorization Server は認証および同意 UI をタッチインタフェースを持つデバイスに適した形で表示すべきである (SHOULD).

</dd>
<dt>wap</dt>
<dd>
                      Authorization Server は認証および同意 UI を "feature phone" に適した形で表示すべきである (SHOULD).

</dd>
</dl></blockquote>

                  Authorization Server は User Agent の機能を検知して適切な表示を行うようにしても良い (MAY).

</dd>
<dt>prompt</dt>
<dd>
                  OPTIONAL.
                  Authorization Server が End-User に再認証および同意を再度要求するかどうか指定するための, スペース区切りの ASCII 文字列のリスト.
                  以下の値が定義されている.


<blockquote class="text"><dl>
<dt>none</dt>
<dd>
                      Authorization Server はいかなる認証および同意 UI をも表示してはならない (MUST NOT).
                      End-User が認証済でない場合, Client が要求する Claim 取得に十分な事前同意を取得済でない場合, またはリクエストを処理するために必要な何らかの条件を満たさない場合には, エラーが返される.
                      典型的なエラーコードは <tt>login_required</tt>, <tt>interaction_required</tt> であり,
                      その他のコードは <a class='info' href='#AuthError'>Section&nbsp;3.1.2.6<span> (</span><span class='info'>Authentication Error Response</span><span>)</span></a> で定義されている.
                      これは既存の認証と同意の両方, またはいずれかを確認する方法として使用できる。

</dd>
<dt>login</dt>
<dd>
                      Authorization Server は End-User を再認証するべきである (SHOULD).
                      再認証が不可能な場合はエラーを返す (MUST).
                      典型的なエラーコードは <tt>login_required</tt> である.

</dd>
<dt>consent</dt>
<dd>
                      Authorization Server は Client にレスポンスを返す前に End-User に同意を要求するべきである (SHOULD).
                      同意要求が不可能な場合はエラーを返す (MUST).
                      典型的なエラーコードは <tt>consent_required</tt> である.

</dd>
<dt>select_account</dt>
<dd>
                      Authorization Server は End-User にアカウント選択を促すべきである (SHOULD).
                      この prompt 値は, End-User が Authorization Server 上に複数アカウントを持っているとき, 現在のセッションに紐づくアカウントの中から一つを選択することを可能にする.
                      End-User によるアカウント選択が不可能な場合はエラーを返す (MUST).
                      典型的なエラーコードは <tt>account_selection_required</tt> である.

</dd>
</dl></blockquote>

                  <tt>prompt</tt> パラメータは Client に対して, End-User のセッションがアクティブであることを確認したり, End-User にリクエストに対する注意を促すことを可能にする.
                  <tt>none</tt> がその他の値とともに用いられる場合はエラーとなる.

</dd>
<dt>max_age</dt>
<dd>
                  OPTIONAL.
                  Authentication Age の最大値.
                  End-User が OP によって明示的に認証されてからの経過時間の最大許容値 (秒).
                  もし経過時間がこの値より大きい場合, OP は End-User を明示的に再認証しなければならない (MUST).
                  (<tt>max_age</tt> リクエストパラメータは OpenID 2.0 <a class='info' href='#OpenID.PAPE'>PAPE<span> (</span><span class='info'>Recordon, D., Jones, M., Bufu, J., Ed., Daugherty, J., Ed., and N. Sakimura, &ldquo;OpenID Provider           Authentication Policy Extension 1.0,&rdquo; December&nbsp;2008.</span><span>)</span></a> [OpenID.PAPE] の <tt>max_auth_age</tt> リクエストパラメータに相当する)
                  <tt>max_age</tt> が指定された場合, 発行される ID Token は <tt>auth_time</tt> Claim を含まねばならない (MUST).

</dd>
<dt>ui_locales</dt>
<dd>
                  OPTIONAL.
                  End-User の選好する UI の表示言語および文字種.
                  スペース区切りの <a class='info' href='#RFC5646'>BCP47<span> (</span><span class='info'>Phillips, A. and M. Davis, &ldquo;Tags for Identifying Languages,&rdquo; September&nbsp;2009.</span><span>)</span></a> [RFC5646] 言語タグ値のリストとして表現され, 順序は選好順となる.
                  例えば "fr-CA fr en" という値が指定された場合, カナダで用いられるフランス語が第一選好となり, 次いで地域指定のないフランス語, そして英語と続く.
                  要求されたロケールがサポートされていない場合でも, OpenID Provider はエラーとするべきではない (SHOULD NOT).

</dd>
<dt>id_token_hint</dt>
<dd>
                  OPTIONAL.
                  Authorization Server が以前発行した ID Token.
                  Client が認証した End-User の現在もしくは過去のセッションに関するヒントとして利用される.
                  もしこの ID Token に紐づく End-User が認証済, もしくはこのリクエスト中で認証された場合, Authorization Server はポジティブレスポンスを返す.
                  さもなければ, Authorization Server は <tt>login_required</tt> のようなエラーを返す (SHOULD).
                  <tt>prompt=none</tt> を利用する場合は, 可能であれば <tt>id_token_hint</tt> を指定するべきであり (SHOULD), さもなければ <tt>invalid_request</tt> を返しても良い (MAY).
                  ただしサーバーはその場合可能な限りサクセスレスポンスを返すこと.
                  <tt>id_token_hint</tt> 利用時は, ID Token の audience に Authorization Server 自身が含まれている必要はない.

</dd>
<dt></dt>
<dd>
                  <tt>id_token_hint</tt> として使用するために RP によって受信された OP からの ID Token が暗号化されていた場合,
                  クライアントは暗号化された ID Token を含んだ署名済みの ID Token を復号しなければならない (MUST).
                  クライアントは Authentication Server に送信する署名済みの ID Token をサーバーが ID Token を復号できる鍵を用いて再暗号化し, <tt>id_token_hint</tt> の値として使用してもよい (MAY).

</dd>
<dt>login_hint</dt>
<dd>
                  OPTIONAL.
                  Authorization Server に対する End-User ログイン識別子のヒントとして利用される.
                  RP が End-User に Email アドレス (もしくはその他の識別子) を要求し, それを Authorization Server にヒントとして送信することでヒントとする.
                  Discovery に利用された値をヒントの値として利用することを推奨する (RECOMMENDED).
                  この値は <tt>phone_number</tt> Claim に指定されるフォーマットに従った電話番号でもよい (MAY).
                  このパラメータを利用するか否かは OP の判断にゆだねる.

</dd>
<dt>acr_values</dt>
<dd>
                  OPTIONAL.
                  Authentication Context Class Reference リクエスト値.
                  Authorization Server が認可リクエストを処理する際に要求される <tt>acr</tt> の値をスペース区切りで示した文字列.
                  認証処理が満たした Authentication Context Class は, <a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a> に示す <tt>acr</tt> Claim Value として返される.
                  <tt>acr</tt> Claim はこのパラメータを用いることで Voluntary Claim としてリクエストされることになる.

</dd>
</dl></blockquote><p>

</p>
<p>
              他のパラメータを送ってもよい (MAY).
              本仕様で定義される追加の Authorization Request Parameter とパラメータ値については
              <a class='info' href='#ImplicitAuthorizationEndpoint'>3.2.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a>,
              <a class='info' href='#HybridAuthorizationEndpoint'>3.3.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a>,
              <a class='info' href='#ClaimsLanguagesAndScripts'>5.2<span> (</span><span class='info'>Claims Languages and Scripts</span><span>)</span></a>,
              <a class='info' href='#ClaimsParameter'>5.5<span> (</span><span class='info'>Requesting Claims using the &quot;claims&quot; Request Parameter</span><span>)</span></a>,
              <a class='info' href='#JWTRequests'>6<span> (</span><span class='info'>Passing Request Parameters as JWTs</span><span>)</span></a> と,
              <a class='info' href='#RegistrationParameter'>7.2.1<span> (</span><span class='info'>Providing Information with the &quot;registration&quot; Request Parameter</span><span>)</span></a>
              セクションを参照すること.

</p>
<p>
                以下の例では Client が User Agent に HTTP 302 リダイレクトレスポンスを返し, User Agent に対して Authorization Endpoint に Authentication Request を送るよう指示している. (改行は掲載上の都合による)

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 302 Found
  Location: https://server.example.com/authorize?
    response_type=code
    &amp;scope=openid%20profile%20email
    &amp;client_id=s6BhdRkqt3
    &amp;state=af0ifjsldkj
    &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
</pre></div>
<p>
                User Agent は上記の Client からの HTTP 302 リダイレクトレスポンスに従い, Authorization Server に以下のようなリクエストを送る. (改行は掲載上の都合による)

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /authorize?
    response_type=code
    &amp;scope=openid%20profile%20email
    &amp;client_id=s6BhdRkqt3
    &amp;state=af0ifjsldkj
    &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb HTTP/1.1
  Host: server.example.com
</pre></div>
<a name="AuthRequestValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2.2"></a><h3>3.1.2.2.&nbsp;
Authentication Request Validation</h3>

<p>
              Authorization Server は, 以下のように受信した要求を検証しなければならない (MUST).

</p>
<p>
              </p>
<ol class="text">
<li>
                  Authorization Server は, 全ての OAuth 2.0 パラメータを OAuth 2.0 仕様に従って検証しなければならない (MUST).

</li>
<li>
                  <tt>scope</tt> パラメータが存在することと,
                  <tt>openid</tt> scope 値を含んでいることを検証.
                  (もし <tt>openid</tt> scope 値が存在しなかった場合,
                  その要求は OpenID Connect の要求ではないが,
                  有効な OAuth 2.0 の要求である可能性がある.)

</li>
<li>
                  Authorization Server は, 全ての必須 (REQUIRED) パラメータが存在するか,
                  そしてそれらの使用方法が当仕様に従っているかを検証しなければならない (MUST).

</li>
<li>
                  ID Token の <tt>sub</tt> (subject) Claim に値が指定されて要求された場合,
                  Authorization Server は, <tt>sub</tt> 値で識別される End-Userが,
                  Authorization Server 上にアクティブなセッションを持っているか,
                  またはその要求の結果として認証された場合のみ,
                  成功応答を送信しなければならない (MUST) .
                  End-User が Authorization Server 上にアクティブなセッションを持っていたとしても,
                  Authorization Server は, 異なるユーザの ID Token や Access Token を応答してはならない (MUST NOT) .
                  このような要求は,  <tt>id_token_hint</tt> パラメータを用いるか,
                  もしくは実装が <tt>claims</tt> パラメータをサポートしていれば,
                  <a class='info' href='#IndividualClaimsRequests'>Section&nbsp;5.5.1<span> (</span><span class='info'>Individual Claims Requests</span><span>)</span></a> に記述されているように特定の Claim 値を要求することによって実現することができる.

</li>
</ol><p>

</p>
<p>
              <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] の規定どおり,
              Authorization Server は認識できない要求パラメータを無視すべきである (SHOULD) .

</p>
<p>
              Authorization Server はなんからのエラーに遭遇した場合,
              <a class='info' href='#AuthError'>Section&nbsp;3.1.2.6<span> (</span><span class='info'>Authentication Error Response</span><span>)</span></a> に従い,
              失敗応答を返さなければならない (MUST) .

</p>
<a name="Authenticates"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2.3"></a><h3>3.1.2.3.&nbsp;
Authorization Server Authenticates End-User</h3>

<p>
              要求が妥当であった場合,  Authorization Server は使用された要求パラメータに応じて,
              End-User を 認証するか, End-User が認証済かの確認を試みる.
              Authorization Server によって用いられる End-User の認証方式 (例えば, ユーザ名とパスワード, セッションクッキー等) については当仕様の規定範疇外である.
              使用された要求パラメータの値や使用された認証方式に応じ,
              Authorization Server は認証ユーザーインタフェースを表示するかもしれない (MAY).

</p>
<p>
              Authorization Server は以下のケースのとき, End-User の認証を試みなければならない (MUST).
            </p>
<ul class="text">
<li>
                End-User はまだ認証されていない.

</li>
<li>
                Authentication Request は,
                <tt>login</tt> という値を持つ
                <tt>prompt</tt> パラメータを含んでいる.
                このケースでは, End-User が既に認証されていたとしても,
                Authorization Server は End-User を再認証しなければならない (MUST).

</li>
</ul><p>

</p>
<p>
              Authorization Server は以下のケースのとき, End-User と対話を行ってはならない (MUST NOT).
            </p>
<ul class="text">
<li>
                Authentication Request は,
                <tt>none</tt> という値を持つ
                <tt>prompt</tt> パラメータを含んでいる.
                このケースでは, End-User がまだ認証されていなかったり,
                対話なしに認証することができない場合,
                Authorization Server は エラーを返さなければならない (MUST).

</li>
</ul><p>

</p>
<p>
              End-User と対話を行うとき,
              <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] の Section 10.12 と 10.13 に記述されている通り,
              Authorization Server は, Cross-Site Request Forgery や Clickjacking に対する適切な対策を行わなければならない (MUST).

</p>
<a name="Consent"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2.4"></a><h3>3.1.2.4.&nbsp;
Authorization Server Obtains End-User Consent/Authorization</h3>

<p>
              End-User を認証した後, Authorization Server は, Relying Party に 情報を送る前に認可決定を取得しなければならない (MUST).
              使用された要求パラメータによって許可されている場合,
              同意事項を明確にした End-User 対話を通じてか,
              要求の処理やその他の手法 (例えば, 管理機能を用いた事前同意) による同意の確立によって,
              この認可決定は行われるかもしれない (MAY).
              Sections <a class='info' href='#IDToken'>2<span> (</span><span class='info'>ID Token</span><span>)</span></a> と
              <a class='info' href='#UserInfo'>5.3<span> (</span><span class='info'>UserInfo Endpoint</span><span>)</span></a> で,
              情報の送出機構について述べる.

</p>
<a name="AuthResponse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2.5"></a><h3>3.1.2.5.&nbsp;
Successful Authentication Response</h3>

<p>
              Authentication Response は, RP により送られた Authorization Request メッセージに応じて OP の Authorization Endpoint から返される OAuth 2.0 Authorization Response メッセージである.

</p>
<p>
              Authorization Code Flow を利用するとき, Authorization Response は <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] の Section 4.1.2 にて定義されるパラメータを Authorization Request 中で指定された <tt>redirect_uri</tt> にクエリパラメータとして加え, 異なる Response Mode が指定されない限りは <tt>application/x-www-form-urlencoded</tt> フォーマットを用いて返さなければならない (MUST).

</p>
<p>
                以下にこのフローを用いた成功レスポンスの例を示す. (改行は掲載上の都合による)

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 302 Found
  Location: https://client.example.org/cb?
    code=SplxlOBeZQQYbYS6WxSbIA
    &amp;state=af0ifjsldkj
</pre></div>
<p>
              Authorization Code の内容についての実装メモは <a class='info' href='#CodeNotes'>Section&nbsp;15.5.1<span> (</span><span class='info'>Authorization Code Implementation Notes</span><span>)</span></a> を参照のこと.

</p>
<a name="AuthError"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2.6"></a><h3>3.1.2.6.&nbsp;
Authentication Error Response</h3>

<p>
              Authentication Error Response は, RP により送られた Authorization Request メッセージに応じて OP の Authorization Endpoint から返される OAuth 2.0 Authorization Error Response メッセージである.

</p>
<p>
              End-User が認可を拒否したり, End-User の認証に失敗した場合, OP ( Authorization Server ) は <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] Section 4.1.2.1 に定義されている Error Response パラメータを用いて伝える.
              (RFC 6749 に関係のないエラーは, 適切な HTTP ステータスコードを用いて User Agent に返すこと)

</p>
<p>
              Redirection URI が無効でない限り, Authorization Server は適切なエラーと state パラメータで Authorization Request にて指定された Redirection URI に Client を返す.

</p>
<p>
              OAuth 2.0 の Section 4.1.2.1 に定義されているエラーコードに加え, この仕様では次のようなエラーコードを定義する:

</p>
<p>
              </p>
<blockquote class="text"><dl>
<dt>interaction_required</dt>
<dd>
                  Authorization Server は処理を進めるためにいくつかの End-User interaction を必要とする.
                  Authentication Request 中の <tt>prompt</tt> パラメータが <tt>none</tt> であるが, End-User interaction のためのユーザーインターフェースの表示なしには Authentication Request が完了できない時にこのエラーが返される.


</dd>
<dt>login_required</dt>
<dd>
                  Authorization Server は End-User の認証を必要とする.
                  Authentication Request 中の <tt>prompt</tt> パラメータが <tt>none</tt> であるが, End-User の認証のためのユーザーインターフェースの表示なしには Authentication Request が完了できない時にこのエラーが返される.


</dd>
<dt>account_selection_required</dt>
<dd>
                  End-User は Authorization Server にてセッションの選択を必要とされる (REQUIRED).
                  End-User は Authorization Server にて異なるアカウントで認証されているが, セッションを選択していないかもしれない (MAY).
                  Authentication Request 中の <tt>prompt</tt> パラメータが <tt>none</tt> であるが, 利用するセッションを選択するためのユーザーインターフェースの表示なしには Authentication Request が完了できない時にこのエラーが返される.


</dd>
<dt>consent_required</dt>
<dd>
                  Authorization Server は End-User の同意を必要とする.
                  Authentication Request 中の <tt>prompt</tt> パラメータが <tt>none</tt> であるが, End-User の同意のためのユーザーインターフェースの表示なしには Authentication Request が完了できない時にこのエラーが返される.


</dd>
<dt>invalid_request_uri</dt>
<dd>
                  Authorization Request 中の <tt>request_uri</tt> はエラーを返すか, 無効なデータを含む.


</dd>
<dt>invalid_request_object</dt>
<dd>
                  <tt>request</tt> パラメータが無効な Request Object を含む.


</dd>
<dt>request_not_supported</dt>
<dd>
                  OP は <a class='info' href='#JWTRequests'>Section&nbsp;6<span> (</span><span class='info'>Passing Request Parameters as JWTs</span><span>)</span></a> にて定義されている <tt>request</tt> パラメータをサポートしていない.


</dd>
<dt>request_uri_not_supported</dt>
<dd>
                  OP は <a class='info' href='#JWTRequests'>Section&nbsp;6<span> (</span><span class='info'>Passing Request Parameters as JWTs</span><span>)</span></a> にて定義されている <tt>request_uri</tt> パラメータをサポートしていない.


</dd>
<dt>registration_not_supported</dt>
<dd>
                  OP は <a class='info' href='#RegistrationParameter'>Section&nbsp;7.2.1<span> (</span><span class='info'>Providing Information with the &quot;registration&quot; Request Parameter</span><span>)</span></a> で定義されている <tt>registration</tt> パラメータをサポートしていない.


</dd>
</dl></blockquote><p>

</p>
<p>
              エラーレスポンスパラメータは以下のようになる:


              </p>
<blockquote class="text"><dl>
<dt>error</dt>
<dd>
                  REQUIRED. エラーコード.


</dd>
<dt>error_description</dt>
<dd>
                  OPTIONAL. 人間が読める ASCII エンコードされたエラーの説明文.


</dd>
<dt>error_uri</dt>
<dd>
                  OPTIONAL. エラーについての追加情報を含むWebページのURI.


</dd>
<dt>state</dt>
<dd>
                  OAuth 2.0 の state の値.
                  Authorization Request が <tt>state</tt> パラメータを含む場合は REQUIRED.
                  Client から受け取った値をセットする.


</dd>
</dl></blockquote><p>

</p>
<p>
              Authorization Code Flow を利用するとき, エラーレスポンスパラメータは異なる Response Mode が指定されない限り Redirection URI のクエリ要素に付加される.


</p>
<p>

<p>
                  以下にこのフローを用いたエラーレスポンスの例を示す. (改行は掲載上の都合による)


</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 302 Found
  Location: https://client.example.org/cb?
    error=invalid_request
    &amp;error_description=
      Unsupported%20response_type%20value
    &amp;state=af0ifjsldkj
</pre></div>


<a name="AuthResponseValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2.7"></a><h3>3.1.2.7.&nbsp;
Authentication Response Validation</h3>

<p>
              Authorization Code Flow を利用するとき, Client は RFC 6749, 特に Section 4.1.2 と Section 10.12 に従ってレスポンスを検証しなければならない (MUST).

</p>
<a name="TokenEndpoint"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3"></a><h3>3.1.3.&nbsp;
Token Endpoint</h3>

<p>
            Access Token と ID Token , そしてオプションの Refresh Token の取得には,
            Authorization Code Flowを使用する場合,
            <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] の Section 3.2 に記載の通り,
            RP (Client) は Token Endpoint へ Token Request を送信し, Token Responseを取得する.

</p>
<p>
            Token Endpoint と通信する際は TLS を利用しなければならない (MUST).
            TLS の使用に関するより詳細な情報を得る場合,  <a class='info' href='#TLSRequirements'>Section&nbsp;16.17<span> (</span><span class='info'>TLS Requirements</span><span>)</span></a> を参照すること

</p>
<a name="TokenRequest"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3.1"></a><h3>3.1.3.1.&nbsp;
Token Request</h3>

<p>
              <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] の Section 4.1.3に記載の通り,
              <tt>grant_type</tt> の値に
              <tt>authorization_code</tt> を指定し,
              (Authorization Code の形で) Authorization Grant を
              Token Endpoint に提示することで,
              Client は Token Request を生成する.
              Client が Confidential Client の場合,
              <a class='info' href='#ClientAuthentication'>Section&nbsp;9<span> (</span><span class='info'>Client Authentication</span><span>)</span></a> に記載の通り,
              自身の <tt>client_id</tt> 用に登録された認証方式を用いて,
              Token Endpoint に対して認証を行わなければならない (MUST).

</p>
<p>
              <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] の Section 4.1.3 に記載の通り,
              Client は, HTTP <tt>POST</tt> メソッドと
              <a class='info' href='#FormSerialization'>Section&nbsp;13.2<span> (</span><span class='info'>Form Serialization</span><span>)</span></a> による Form Serialization を用いて,
              Token Endpoint にパラメータを送信する.

</p>
<p>
                以下に Token Request の一例を示す (表示の都合上の改行を含む):

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

  grant_type=authorization_code&amp;code=SplxlOBeZQQYbYS6WxSbIA
    &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
</pre></div>
<a name="TokenRequestValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3.2"></a><h3>3.1.3.2.&nbsp;
Token Request Validation</h3>

<p>
              Authorization Server は, Token Request を以下のように検証しなければならない (MUST):

</p>
<p>
              </p>
<ul class="text">
<li>
                  <a class='info' href='#ClientAuthentication'>Section&nbsp;9<span> (</span><span class='info'>Client Authentication</span><span>)</span></a> により,
                  Client Credential を発行していた場合や, その他の Client Authentication 方式を用いる場合,
                  Clientを認証.

</li>
<li>
                  Authorization Code が認証された Client 向けに発行されたものかを確認.

</li>
<li>
                  Authorization Codeの有効性を検証.

</li>
<li>
                  可能な場合, その Authorization Code が以前に使用されていないものであることを検証.

</li>
<li>
                  <tt>redirect_uri</tt> パラメータの値が,
                  最初の Authorization Request に含まれていた
                  <tt>redirect_uri</tt> パラメータの値と同一であることを確認.
                  登録されている <tt>redirect_uri</tt> の値が一つだけであり,
                  <tt>redirect_uri</tt> パラメータの値が存在していない場合,
                  Authorization Server は, (Clientはそのパラメータを含むべきであるため) エラーを返すかもしれないし (MAY),
                  (OAuth 2.0ではこのようなケースではパラメータの省略を許可しているため) エラーなしで処理を進めるかもしれない (MAY).

</li>
<li>
                  (ID Token を Token Endpoint から返却できるように)
                  その使用された Authorization Code がOpenID Connect Authentication Request に対する応答として発行されたものであることを検証.

</li>
</ul><p>

</p>
<a name="TokenResponse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3.3"></a><h3>3.1.3.3.&nbsp;
Successful Token Response</h3>

<p>
              クライアントから有効かつ認可されたトークンリクエストの受信, 確認後, 認可サーバーは ID トークンとアクセストークンを含む正常なレスポンスを返却する.
              正常なレスポンス内のパラメーターは <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] の Section 4.1.4 に定義されている.
              レスポンスは <tt>application/json</tt> メディアタイプを使用する.

</p>
<p>
              他のトークンタイプはクライアントと交渉がない場合, OAuth 2.0 の <tt>token_type</tt> レスポンスパラメーターの値は, <a class='info' href='#RFC6750'>OAuth 2.0 Bearer Token Usage<span> (</span><span class='info'>Jones, M. and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework: Bearer Token Usage,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6750] で指定されている <tt>Bearer</tt> でなければならない(MUST).
              サーバーは <tt>Bearer</tt> トークンタイプをサポートすべきである(SHOULD); 他のトークンタイプの使用はこの仕様の領域外である.

</p>
<p>
              OAuth 2.0 によって指定されるレスポンスパラメーターに加えて, 以下のパラメーターはレスポンスに含まれていなければならない(MUST):

</p>
<p>
              </p>
<blockquote class="text"><dl>
<dt>id_token</dt>
<dd>
                  ID トークンの値は認証されたセッションに関連づけられる.

</dd>
</dl></blockquote><p>

</p>
<p>
              トークン, シークレットあるいはその他の機密な情報を含む全てのトークンレスポンスは以下の HTTP レスポンスヘッダーフィールドと値をを含まなければならない(MUST):

</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">Header Name</th><th align="left">Header Value</th></tr>
<tr>
<td align="left">Cache-Control</td>
<td align="left">no-store</td>
</tr>
<tr>
<td align="left">Pragma</td>
<td align="left">no-cache</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;HTTP Response Headers and Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
                以下は, 正常なトークンレスポンスの一例である.
                例の ID トークンの署名は <a class='info' href='#ExampleRSAKey'>Appendix&nbsp;A.7<span> (</span><span class='info'>RSA Key Used in Examples</span><span>)</span></a> に鍵を使った検証が可能である.
                <a class='info' href='#ExampleRSAKey'>Appendix&nbsp;A.7<span> (</span><span class='info'>RSA Key Used in Examples</span><span>)</span></a>.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 200 OK
  Content-Type: application/json
  Cache-Control: no-store
  Pragma: no-cache

  {
   "access_token": "SlAV32hkKG",
   "token_type": "Bearer",
   "refresh_token": "8xLOxBtZp8",
   "expires_in": 3600,
   "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWdkazcifQ.ewogImlzc
     yI6ICJodHRwOi8vc2VydmVyLmV4YW1wbGUuY29tIiwKICJzdWIiOiAiMjQ4Mjg5
     NzYxMDAxIiwKICJhdWQiOiAiczZCaGRSa3F0MyIsCiAibm9uY2UiOiAibi0wUzZ
     fV3pBMk1qIiwKICJleHAiOiAxMzExMjgxOTcwLAogImlhdCI6IDEzMTEyODA5Nz
     AKfQ.ggW8hZ1EuVLuxNuuIJKX_V8a_OMXzR0EHR9R6jgdqrOOF4daGU96Sr_P6q
     Jp6IcmD3HP99Obi1PRs-cwh3LO-p146waJ8IhehcwL7F09JdijmBqkvPeB2T9CJ
     NqeGpe-gccMg4vfKjkM8FcGvnzZUN4_KSP0aAp1tOJ1zZwgjxqGByKHiOtX7Tpd
     QyHE5lcMiKPXfEIQILVq0pc_E2DzL7emopWoaoZTF_m0_N0YzFC6g6EJbOEoRoS
     K5hoDalrcvRYLSrQAZZKflyuVCyixEoV9GfNQC3_osjzw2PAithfubEEBLuVVk4
     XUVrWOLrLl0nx7RkKU8NXNHq-rvKMzqg"
  }
</pre></div>
<p>
              <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] で指定されているように, クライアントは認識されないレスポンスパラメーターは無視すべきである(SHOULD).

</p>
<a name="TokenErrorResponse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3.4"></a><h3>3.1.3.4.&nbsp;
Token Error Response</h3>

<p>
              トークンリクエストが無効あるいは未認可の場合には, 認可サーバーはエラーレスポンスを構成する.
              トークンエラーレスポンスのパラメーターは <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] の Section 5.2 に定義されている.
              HTTP レスポンスボディは HTTP レスポンスコード 400 を用いて <tt>application/json</tt> メディアタイプを使用する.

</p>
<p>
                以下は, トークンエラーレスポンスの一例である.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 400 Bad Request
  Content-Type: application/json
  Cache-Control: no-store
  Pragma: no-cache

  {
   "error": "invalid_request"
  }
</pre></div>
<a name="TokenResponseValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3.5"></a><h3>3.1.3.5.&nbsp;
Token Response Validation</h3>

<p>

              クライアントは以下のようにトークンレスポンスを確認しなければいけない(MUST):
              </p>
<ol class="text">
<li>
                  Sections 5.1 と 10.12 においては特に, RFC 6749 の確認規則に従う.

</li>
<li>
                  <a class='info' href='#IDTokenValidation'>Section&nbsp;3.1.3.7<span> (</span><span class='info'>ID Token Validation</span><span>)</span></a> の ID トークン確認規則に従う.

</li>
<li>
                  <a class='info' href='#CodeFlowTokenValidation'>Section&nbsp;3.1.3.8<span> (</span><span class='info'>Access Token Validation</span><span>)</span></a> のアクセストークン確認規則に従う.

</li>
</ol><p>

</p>
<a name="CodeIDToken"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3.6"></a><h3>3.1.3.6.&nbsp;
ID Token</h3>

<p>
              ID Token のコンテンツは <a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a> にある.
              Authorization Code Flow を利用する場合, 以下の ID Token Claims のための追加必要条件が適用される:

</p>
<p>
              </p>
<blockquote class="text"><dl>
<dt>at_hash</dt>
<dd>
                  OPTIONAL.
                  Access Token のハッシュ値.
                  この値は, <tt>access_token</tt> の ASCII バイト列のハッシュ値の左半分を Basd64URL エンコードしたものであり, ハッシュアルゴリズムは ID Token の <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature (JWS),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWS] ヘッダーにある <tt>alg</tt> で用いられるハッシュアルゴリズムと同じものを用いる.
                  例えば <tt>alg</tt> が <tt>RS256</tt> であれば, <tt>access_token</tt> の SHA-256 ハッシュ値を計算し, その左半分の128ビットを Base64URL エンコードする.
                  <tt>at_hash</tt> は大文字小文字を区別する文字列である.


</dd>
</dl></blockquote><p>

</p>
<a name="IDTokenValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3.7"></a><h3>3.1.3.7.&nbsp;
ID Token Validation</h3>

<p>
              Client は Token Response 内の ID Token を確認しなければならない (MUST).

</p>
<p>
              </p>
<ol class="text">
<li>
                  ID Token が 暗号化されているならば, Client が Registration にて指定し OP が ID Token の暗号化に利用した鍵とアルゴリズムを用いて復号する.
                  Registration 時に OP と暗号化が取り決められても ID Token が暗号化されていなかったときは, RP はそれを拒絶するべき (SHOULD).

</li>
<li>
                  (一般的に Discovery を通して取得される) OpenID Provider の Issuer Identifier は <tt>iss</tt> (issuer) Claim の値と正確に一致しなければならない (MUST).

</li>
<li>
                  Client は <tt>aud</tt> (audience) Claim が <tt>iss</tt> (issuer) Claim で示される Issuer にて登録された, 自身の <tt>client_id</tt> をオーディエンスとして含むことを確認しなければならない (MUST).
                  <tt>aud</tt> (audience) Claim は複数要素の配列を含んでも良い (MAY).
                  ID Token が Client を有効なオーディエンスとして記載しない, もしくは Client から信用されていない追加のオーディエンスを含むならば, そのID Token は拒絶されなければならない.

</li>
<li>
                  ID Token が複数のオーディエンスを含むならば, Client は <tt>azp</tt> Claim があることを確認すべき (SHOULD).

</li>
<li>
                  <tt>azp</tt> (authorized party) Claim があるならば, Client は Clime の値が自身の <tt>client_id</tt> であることを確認すべき (SHOULD).

</li>
<li>
                  (このフローの中で) ID Token を Client と Token Endpoint の間の直接通信により受け取ったならば, トークンの署名確認の代わりに TLS Server の確認を issuer の確認のために利用してもよい (MAY).
                  Client は <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature (JWS),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWS] に従い, JWT <tt>alg</tt> ヘッダパラメータを用いて全ての ID Token の署名を確認しなければならない (MUST).
                  Client は Issuer から提供された鍵を利用しなければならない (MUST).

</li>
<li>
                  <tt>alg</tt> の値はデフォルトの <tt>RS256</tt> もしくは Registration にて Client により <tt>id_token_signed_response_alg</tt> パラメータとして送られたアルゴリズムであるべき (SHOULD).

</li>
<li>
                  JWT <tt>alg</tt> ヘッダパラメータが <tt>HS256</tt>, <tt>HS384</tt> および <tt>HS512</tt> のような MAC ベースのアルゴリズムを利用するならば, <tt>aud</tt> (audience) Claim に含まれる <tt>client_id</tt> に対応する <tt>client_secret</tt> の UTF-8 表現バイト列が署名の確認に用いられる.
                  MAC ベースのアルゴリズムについて, <tt>aud</tt> が複数の値を持つとき, もしくは <tt>aud</tt> の値と異なる <tt>azp</tt> の値があるときの振る舞いは規定されない.

</li>
<li>
                  現在時刻は <tt>exp</tt> Claim の時刻表現より前でなければならない (MUST).

</li>
<li>
                  <tt>iat</tt> Claim は現在時刻からはるか昔に発行されたトークンを拒絶するために利用でき, 攻撃を防ぐために nonce が保存される必要がある期間を制限する.
                  許容できる範囲は Client の仕様である.

</li>
<li>
                  nonce の値が Authentication Request にて送られたならば, <tt>nonce</tt> Claim が存在し, その値が Authentication Request にて送られたものと一致することを確認するためにチェックされなければならない (MUST).
                  Client は <tt>nonce</tt> の値を リプレイアタックのためにチェックすべき (SHOULD).
                  リプレイアタックを検知する正確な方法は Client の仕様である.

</li>
<li>
                  <tt>acr</tt> Claim が 要求されたならば, Client は主張された Claim の値が適切かどうかをチェックすべきである (SHOULD).
                  <tt>acr</tt> Claim の値と意味はこの仕様の対象外である.

</li>
<li>
                  <tt>auth_time</tt> Claim が要求されたならば, この Claim のための特定のリクエストもしくは <tt>max_age</tt> パラメータを用いて Client は <tt>auth_time</tt> Claim の値をチェックし, もし最新のユーザー認証からあまりに長い時間が経過したと判定されたときは再認証を要求すべきである (SHOULD).

</li>
</ol><p>

</p>
<a name="CodeFlowTokenValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3.8"></a><h3>3.1.3.8.&nbsp;
Access Token Validation</h3>

<p>
              Authorization Code Flow を利用し, ID Token が <tt>at_hash</tt> Claim を含むときには <a class='info' href='#ImplicitTokenValidation'>Section&nbsp;3.2.2.9<span> (</span><span class='info'>Access Token Validation</span><span>)</span></a> にある Implicit Flow と同様に, Client はそれを Token Endpoint から返された ID Token と Access Token を用いて Access Token の確認に利用してもよい (MAY).

</p>
<a name="ImplicitFlowAuth"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Authentication using the Implicit Flow</h3>

<p>
          本章は Implicit フローを用いた認証を行う方法について述べる.
          Implicit フローを用いるとき, トークンエンドポイントは使用されず, 全てのトークンは認可エンドポイントから返却される.

</p>
<p>
          Implicit フローは主にスクリプト言語を用いてブラウザーで実装されたクライアントによって使用される.
          アクセストークンと ID トークンは End-User と End-User の User Agent にアクセスするアプリケーションに露出するかもしれないクライアントに直接返却される.
          認可サーバーはクライアント認証を行ってはいけない.

</p>
<a name="ImplicitFlowSteps"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
Implicit Flow Steps</h3>

<p>Implicit フローは以下の手順に従う:
</p>
<p>
            </p>
<ol class="text">
<li>
                クライアントは求めるするリクエストパラメーターを含む認証リクエストを準備する.

</li>
<li>クライアントは認可サーバーにリクエストを送信する.
</li>
<li>認可サーバーは End-User を認証する.
</li>
<li>認可サーバーは End-User の同意/認可を取得する.
</li>
<li>
                認可サーバーは, 要求があればID トークンとアクセストークンと共に End-User をクライアントに送り戻す

</li>
<li>
                クライアントは ID トークンを確認して End-User の Subject 識別子を抽出する.

</li>
</ol><p>

</p>
<a name="ImplicitAuthorizationEndpoint"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2"></a><h3>3.2.2.&nbsp;
Authorization Endpoint</h3>

<p>
            Implicit フローを用いるとき, 本章で指定された相違点を除いて, 認可エンドポイントは <a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a> に定義されている認可コードフローと同様の方法が使用される.

</p>
<a name="ImplicitAuthRequest"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2.1"></a><h3>3.2.2.1.&nbsp;
Authentication Request</h3>

<p>
              次のように使用される認証リクエストパラメーターを除き, 認証リクエストは <a class='info' href='#AuthRequest'>Section&nbsp;3.1.2.1<span> (</span><span class='info'>Authentication Request</span><span>)</span></a> に定義されているように形成される.

</p>
<p>
              </p>
<blockquote class="text"><dl>
<dt>response_type</dt>
<dd>
                  必須(REQUIRED).
                  パラメーターが用いられるエンドポイントから返却されるものを含めて, 認可処理のフローを使用するかを決定するための OAuth 2.0 のレスポンスタイプ値である.
                  Implicit フローを用いるとき, この値は <tt>id_token&nbsp;token</tt> または <tt>id_token</tt> である.
                  これらの値の両方の意味は <a class='info' href='#OAuth.Responses'>OAuth 2.0 Multiple Response Type Encoding Practices<span> (</span><span class='info'>de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, &ldquo;OAuth 2.0 Multiple Response Type Encoding Practices,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.Responses] に定義されている.
                  値が <tt>id_token</tt> であるときは, アクセストークンは返却されない.

</dd>
<dt></dt>
<dd>
                  注記:  OAuth 2.0 も Implicit フローの <tt>token</tt> レスポンスタイプの値を定義しているが, ID トークンを返却しないため OpenID Connect はこのレスポンスタイプを使用しない.

</dd>
<dt>redirect_uri</dt>
<dd>
                  必須(REQUIRED).
                  レスポンスが送られる先のリダイレクト URI である.
                  この URI は <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> (Simple String Comparison) の Section 6.2.1 (Simple String Comparison) に
                  定義されているように行われる突き合わせを用いて, OpenID プロバイダーで
                  事前に登録されているクライアントのリダイレクト URI 値のひとつに
                  正確に一致しなければならない(MUST).
                  このフローを用いるとき, クライアントがネイティブアプリケーションでない限り
                  リダイレクト URI は <tt>http</tt> スキームを使用してはいけない(MUST).
                  この場合のネイティブアプリケーションは,
                  ホストネームとして <tt>localhost</tt> で <tt>http:</tt>　スキームを使用してもよい(MAY).

</dd>
<dt>nonce</dt>
<dd>
                  必須(REQUIRED).
                  ID トークンでクライアントセッションを関連づけ、リプレイアタックを
                  軽減するために用いられる文字列の値である.
                  この値は認証リクエストから ID トークンに修正されずに受け渡される.
                  値を推測する攻撃者を防ぐために <tt>nonce</tt> の
                  値は十分なエントロピーが存在していなければならない(MUST).
                  実装の注釈は <a class='info' href='#NonceNotes'>Section&nbsp;15.5.2<span> (</span><span class='info'>Nonce Implementation Notes</span><span>)</span></a> を参考すること.

</dd>
</dl></blockquote><p>

</p>
<p>
                以下は, クライアントによる対応する HTTP 302 リダイレクトレスポンスに応じて,
                User Agent によって認可サーバーへ送信される Implicit フローを用いたリクエストの一例である.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /authorize?
    response_type=id_token%20token
    &amp;client_id=s6BhdRkqt3
    &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &amp;scope=openid%20profile
    &amp;state=af0ifjsldkj
    &amp;nonce=n-0S6_WzA2Mj HTTP/1.1
  Host: server.example.com
</pre></div>
<a name="ImplicitValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2.2"></a><h3>3.2.2.2.&nbsp;
Authentication Request Validation</h3>

<p>
              Implicit フローを用いるとき, <a class='info' href='#AuthRequestValidation'>Section&nbsp;3.1.2.2<span> (</span><span class='info'>Authentication Request Validation</span><span>)</span></a> で定義されている認可コードフローの場合と同様に認証リクエストは確認される.

</p>
<a name="ImplicitAuthenticates"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2.3"></a><h3>3.2.2.3.&nbsp;
Authorization Server Authenticates End-User</h3>

<p>
              Implicit フローを用いるとき, <a class='info' href='#Authenticates'>Section&nbsp;3.1.2.3<span> (</span><span class='info'>Authorization Server Authenticates End-User</span><span>)</span></a> で定義されている認可コードフローの場合と同様に End-User の認証が行われる.

</p>
<a name="ImplicitConsent"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2.4"></a><h3>3.2.2.4.&nbsp;
Authorization Server Obtains End-User Consent/Authorization</h3>

<p>
              Implicit フローを用いるとき, <a class='info' href='#Consent'>Section&nbsp;3.1.2.4<span> (</span><span class='info'>Authorization Server Obtains End-User Consent/Authorization</span><span>)</span></a> で定義されている認可コードフローの場合と同様に End-User の同意は得られる.

</p>
<a name="ImplicitAuthResponse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2.5"></a><h3>3.2.2.5.&nbsp;
Successful Authentication Response</h3>

<p>
              Implicit Flow を用いるとき, Authentication Responses はこのセクションで指定される違いを除いて <a class='info' href='#AuthResponse'>Section&nbsp;3.1.2.5<span> (</span><span class='info'>Successful Authentication Response</span><span>)</span></a> で定義されている Authorization Code Flow と同様に作成される.

</p>
<p>
              Implicit Flow を用いるとき, 異なる Response Mode が指定されない限り, 全てのレスポンスパラメータは <a class='info' href='#OAuth.Responses'>OAuth 2.0 Multiple Response Type Encoding Practices<span> (</span><span class='info'>de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, &ldquo;OAuth 2.0 Multiple Response Type Encoding Practices,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.Responses] の規定により Redirection URI のフラグメント要素に加えられる.

</p>
<p>
              これらのパラメータは Authorization Endpoint から返される:

</p>
<p>
              </p>
<blockquote class="text"><dl>
<dt>access_token</dt>
<dd>
                  OAuth2.0 の Access Token.
                  <tt>response_type</tt> の値が <tt>id_token</tt> でない限り, これは返される.


</dd>
<dt>token_type</dt>
<dd>
                  OAuth 2.0 の Token Type の値.
                  この値は <tt>Bearer</tt> もしくは Client が Authorization Server と交渉した他の <tt>token_type</tt> の値でなければならない (MUST).
                  このプロファイルを実装している Client は <a class='info' href='#RFC6750'>OAuth 2.0 Bearer Token Usage<span> (</span><span class='info'>Jones, M. and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework: Bearer Token Usage,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6750] の仕様をサポートしなければならない (MUST).
                  このプロファイルは bearer token の利用のみを述べる.
                  これは <tt>access_token</tt> と同時に返される.


</dd>
<dt>id_token</dt>
<dd>
                必須(REQUIRED). ID Token.


</dd>
<dt>state</dt>
<dd>
                  OAuth 2.0 の state の値.
                  <tt>state</tt> パラメータが Authorization Request にある場合は必須 (REQUIRED).
                  Client は <tt>state</tt> の値が Authorization Request 中の <tt>state</tt> パラメータと等しいことを確認しなければならない (MUST).


</dd>
<dt>expires_in</dt>
<dd>
                任意 (OPTIONAL).
                Access Token の有効期限である, レスポンスが生成されてからの秒数.


</dd>
</dl></blockquote><p>

</p>
<p>
              <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] の Section 4.2.2 により, Implicit Flow を用いるときに <tt>code</tt> は返されない.

</p>
<p>
                以下に Implicit Flow を用いた成功レスポンスの例を示す. (改行は掲載上の都合による)


</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 302 Found
  Location: https://client.example.org/cb#
    access_token=SlAV32hkKG
    &amp;token_type=bearer
    &amp;id_token=eyJ0 ... NiJ9.eyJ1c ... I6IjIifX0.DeWt4Qu ... ZXso
    &amp;expires_in=3600
    &amp;state=af0ifjsldkj
</pre></div>
<a name="ImplicitAuthError"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2.6"></a><h3>3.2.2.6.&nbsp;
Authentication Error Response</h3>

<p>
              Implicit Flow を用いるとき, Authorization Error Responses はこのセクションで指定される違いを除いて <a class='info' href='#AuthError'>Section&nbsp;3.1.2.6<span> (</span><span class='info'>Authentication Error Response</span><span>)</span></a> で定義されている Authorization Code Flow と同様に作成される.

</p>
<p>
              End-User がリクエストを拒絶または End-User の認証に失敗したとき, 異なる Response Mode が指定されないかぎり Authorization Server は Error Authorization Response を <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] の 4.2.2.1 と <a class='info' href='#OAuth.Responses'>OAuth 2.0 Multiple Response Type Encoding Practices<span> (</span><span class='info'>de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, &ldquo;OAuth 2.0 Multiple Response Type Encoding Practices,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.Responses] で定義されている Redirection URI のフラグメント要素にて返さなければならない (MUST).

</p>
<a name="ImplicitCallback"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2.7"></a><h3>3.2.2.7.&nbsp;
Redirect URI Fragment Handling</h3>

<p>
              レスポンスパラメータが Redirection URI のフラグメントの値で返されるため, Client は フラグメントエンコードされた値をパースしてそれを消費する Client の処理ロジックに渡す User Agent を持つことを必要とする.
              URIフラグメントのハンドリングは <a class='info' href='#FragmentNotes'>Section&nbsp;15.5.3<span> (</span><span class='info'>Redirect URI Fragment Handling Implementation Notes</span><span>)</span></a> を参照すること.

</p>
<a name="ImplicitAuthResponseValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2.8"></a><h3>3.2.2.8.&nbsp;
Authentication Response Validation</h3>

<p>
              Implicit Flow を用いるとき, Client は 以下のようにレスポンスを確認しなければならない (MUST).

              </p>
<ol class="text">
<li>
                  レスポンスが <a class='info' href='#OAuth.Responses'>[OAuth.Responses]<span> (</span><span class='info'>de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, &ldquo;OAuth 2.0 Multiple Response Type Encoding Practices,&rdquo; December&nbsp;2013.</span><span>)</span></a> の Section 5 に従うことを検証する.

</li>
<li>
                  RFC 6749, 特に Sections 4.2.2 と 10.12の確認規則に従う.

</li>
<li>
                  <a class='info' href='#ImplicitIDTValidation'>Section&nbsp;3.2.2.11<span> (</span><span class='info'>ID Token Validation</span><span>)</span></a> の ID Token 確認規則に従う.

</li>
<li>
                  <tt>response_type</tt> の値が <tt>id_token</tt> を利用しない限り, <a class='info' href='#ImplicitTokenValidation'>Section&nbsp;3.2.2.9<span> (</span><span class='info'>Access Token Validation</span><span>)</span></a> の Access Token 確認規則に従う.

</li>
</ol><p>

</p>
<a name="ImplicitTokenValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2.9"></a><h3>3.2.2.9.&nbsp;
Access Token Validation</h3>

<p>
              Authorization Endpoint から ID Token とともに発行された Access Token を確認するため, Client は次のことを行うべき (SHOULD).

</p>
<p>
              </p>
<ol class="text">
<li>
                  ID Token の <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature (JWS),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWS] ヘッダ中の <tt>alg</tt> ヘッダパラメータのために <a class='info' href='#JWA'>JWA<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWA] にて指定されているハッシュアルゴリズムにて <tt>access_token</tt> の ASCII バイト列をハッシュする.

</li>
<li>
                  ハッシュの左半分を取り出し, それを Base64 URL エンコードする.

</li>
<li>
                  ID Token の <tt>at_hash</tt> の値が直前のステップで生成された値と等しくなければならない (MUST).

</li>
</ol><p>

</p>
<a name="ImplicitIDToken"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2.10"></a><h3>3.2.2.10.&nbsp;
ID Token</h3>

<p>
              ID Token の内容は <a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a> で述べられている.
              Implicit Flow を使用する場合,
              以下の ID Token Claims に対する追加要件が適用される:

</p>
<p>
              </p>
<blockquote class="text"><dl>
<dt>nonce</dt>
<dd>
                  このフローでは <tt>nonce</tt> Claim の使用は必須である (REQUIRED).

</dd>
<dt>at_hash</dt>
<dd>
                  Access Token のハッシュ値.
                  この値は, <tt>access_token</tt> の ASCII バイト列のハッシュ値の左半分を Basd64URL エンコードしたものであり, ハッシュアルゴリズムは ID Token の <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature (JWS),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWS] ヘッダーにある <tt>alg</tt> で用いられるハッシュアルゴリズムと同じものを用いる.
                  例えば <tt>alg</tt> が <tt>RS256</tt> であれば, <tt>access_token</tt> の SHA-256 ハッシュ値を計算し, その左半分の128ビットを Base64URL エンコードする.
                  <tt>at_hash</tt> は大文字小文字を区別する文字列である.

</dd>
<dt></dt>
<dd>
                  ID Token が <tt>access_token</tt> とともに Authorization Endpoint から発行された場合(<tt>response_type</tt> 値が <tt>id_token&nbsp;token</tt> である場合に該当する), このクレームは必須である (REQUIRED).
                  Access Token が発行されない場合(<tt>response_type</tt> 値が <tt>id_token</tt> である場合に該当する), このクレームは使用されなくてもよい (MAY NOT)

</dd>
</dl></blockquote><p>

</p>
<a name="ImplicitIDTValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2.11"></a><h3>3.2.2.11.&nbsp;
ID Token Validation</h3>

<p>
              Implicit Flow を使用する場合, ID Token の内容はこのセクションで指定された違いを除いて, <a class='info' href='#IDTokenValidation'>Section&nbsp;3.1.3.7<span> (</span><span class='info'>ID Token Validation</span><span>)</span></a> で述べられているように, Authorization Code Flow と同様に検証されなければならない (MUST).

</p>
<p>
              </p>
<ol class="text">
<li>
                  クライアントは ID Token の署名を, JWT ヘッダ中の <tt>alg</tt> パラメータで指定されたアルゴリズムを使い, <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature (JWS),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWS] に従って検証しなければならない (MUST).

</li>
<li>
                  <tt>nonce</tt>
                  Claim の値が Authentication Request にて送られたものと一致することを確認しなければならない (MUST).
                  クライアントは <tt>nonce</tt> の値をリプレイアタック対策のためにチェックすべきである (SHOULD).
                  リプレイアタック検知方法の詳細はクライアントによって異なる.

</li>
</ol><p>

</p>
<a name="HybridFlowAuth"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Authentication using the Hybrid Flow</h3>

<p>
          このセクションは Hybrid Flow を用いて認証を行う方法について述べる.
          Hybrid Flow を使用する場合, いくつかのトークンは Authorization Endpoint から返され, その他のトークンは Token Endpoint から返される.
          Hybrid Flow でのトークン返却の仕組みは <a class='info' href='#OAuth.Responses'>OAuth 2.0 Multiple Response Type Encoding Practices<span> (</span><span class='info'>de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, &ldquo;OAuth 2.0 Multiple Response Type Encoding Practices,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.Responses] で指定されている.

</p>
<a name="HybridFlowSteps"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1"></a><h3>3.3.1.&nbsp;
Hybrid Flow Steps</h3>

<p>
            Hybrid Flow は以下の手順に従う:

</p>
<p>
            </p>
<ol class="text">
<li>
                クライアントは必要なリクエストパラメータを含んだ Authentication Request を構築する.

</li>
<li>
                クライアントは Authorization Server にリクエストを送信する.

</li>
<li>
                Authorization Server は End-User を認証する.

</li>
<li>
                Authorization Server は End-User の同意/認可を取得する.

</li>
<li>
                Authorization Server は End-User を Authorization Code と, レスポンスタイプに応じた1つ以上の追加パラメータとともにクライアントに戻す.

</li>
<li>
                クライアントは Token Endpoint で Authorization Code を使用してレスポンスを要求する.

</li>
<li>
                クライアントは ID Token と Access Token をレスポンスボディに含んだレスポンスを受け取る.

</li>
<li>
                クライアントは ID Token をトークンを検証し, End-User の Subject Identifier を取得する.

</li>
</ol><p>

</p>
<a name="HybridAuthorizationEndpoint"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2"></a><h3>3.3.2.&nbsp;
Authorization Endpoint</h3>

<p>
            ハイブリッドフローを使用する場合, 認可エンドポイントは, このセクションで指定された違いを除いて, <a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a>で定義されるように, 認可コードフローと同様の方式で利用される.

</p>
<a name="HybridAuthRequest"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2.1"></a><h3>3.3.2.1.&nbsp;
Authentication Request</h3>

<p>
              認証リクエストは, 以下で示される認証リクエストパラメータを除いて, <a class='info' href='#AuthRequest'>Section&nbsp;3.1.2.1<span> (</span><span class='info'>Authentication Request</span><span>)</span></a>で定義されたように作成される.

</p>
<p>
              </p>
<blockquote class="text"><dl>
<dt>response_type</dt>
<dd>
                  必須.
                  使用されたエンドポイントから返却されたパラメータの扱いを含む, 使用される認証処理の流れを決定するOAuth2.0のレスポンスタイプパラメータ.
                  ハイブリッドフローを使用する場合, この値は<tt>code&nbsp;id_token</tt>か,
                  <tt>code&nbsp;token</tt>, または, <tt>code&nbsp;id_token&nbsp;token</tt>である.
                  これらの値の意味は, <a class='info' href='#OAuth.Responses'>OAuth 2.0 Multiple Response Type Encoding Practices<span> (</span><span class='info'>de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, &ldquo;OAuth 2.0 Multiple Response Type Encoding Practices,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.Responses]で定義されている.

</dd>
</dl></blockquote><p>

</p>
<p>
                クライアントが対応するHTTP302リダイレクト応答に応じて, ユーザエージェントによって,
                認可サーバへ送信されるであろう, ハイブリッドフローを用いた非標準のリクエスト例を以下に示す.
                (表示目的のための値の範囲内での行折り返しを含む):

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /authorize?
    response_type=code%20id_token
    &amp;client_id=s6BhdRkqt3
    &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &amp;scope=openid%20profile%20email
    &amp;nonce=n-0S6_WzA2Mj
    &amp;state=af0ifjsldkj HTTP/1.1
  Host: server.example.com
</pre></div>
<a name="HybridValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2.2"></a><h3>3.3.2.2.&nbsp;
Authentication Request Validation</h3>

<p>
              ハイブリッドフローを使用する場合, 認証リクエストは<a class='info' href='#AuthRequestValidation'>Section&nbsp;3.1.2.2<span> (</span><span class='info'>Authentication Request Validation</span><span>)</span></a>で定義されるように, 認可コードフローと同じ方式で検証される.

</p>
<a name="HybridAuthenticates"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2.3"></a><h3>3.3.2.3.&nbsp;
Authorization Server Authenticates End-User</h3>

<p>
              ハイブリッドフローを使用する場合, エンドユーザの認証は<a class='info' href='#Authenticates'>Section&nbsp;3.1.2.3<span> (</span><span class='info'>Authorization Server Authenticates End-User</span><span>)</span></a>で定義されるように, 認可コードフローと同じ方式で実施される.

</p>
<a name="HybridConsent"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2.4"></a><h3>3.3.2.4.&nbsp;
Authorization Server Obtains End-User Consent/Authorization</h3>

<p>
              ハイブリッドフローを使用する場合, エンドユーザの同意は<a class='info' href='#Consent'>Section&nbsp;3.1.2.4<span> (</span><span class='info'>Authorization Server Obtains End-User Consent/Authorization</span><span>)</span></a>で定義されるように, 認可コードフローと同じ方式で得られる.

</p>
<a name="HybridAuthResponse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2.5"></a><h3>3.3.2.5.&nbsp;
Successful Authentication Response</h3>

<p>
              ハイブリッドフローを使用する場合, 認証レスポンスは, このセクションで指定された違いを除いて, <a class='info' href='#ImplicitAuthResponse'>Section&nbsp;3.2.2.5<span> (</span><span class='info'>Successful Authentication Response</span><span>)</span></a>で定義されるように, インプリシットフローと同じ方式で作成される.

</p>
<p>
              これらの認可エンドポイントの結果は, 以下のように使用される.

</p>
<p>
              </p>
<blockquote class="text"><dl>
<dt>access_token</dt>
<dd>
                  OAuth2.0のAccess Token.
                  <tt>response_type</tt>の値が,
                  <tt>code&nbsp;token</tt> か,
                  <tt>code&nbsp;id_token&nbsp;token</tt>の場合返却される.
                  (同じケースでは<tt>token_type</tt>の値も返却される.)

</dd>
<dt>id_token</dt>
<dd>
                  ID Token.
                  <tt>response_type</tt>の値が,
                  <tt>code&nbsp;id_token</tt> か
                  <tt>code&nbsp;id_token&nbsp;token</tt>の場合返却される.

</dd>
<dt>code</dt>
<dd>
                  Authorization Code.
                  ハイブリッドフローでは常に返却される.

</dd>
</dl></blockquote><p>

</p>
<p>
                ハイブリッドフローを使用する際の非標準の成功レスポンスの例を以下に示す.
                (表示目的のための折り返しを含む)

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 302 Found
  Location: https://client.example.org/cb#
    code=SplxlOBeZQQYbYS6WxSbIA
    &amp;id_token=eyJ0 ... NiJ9.eyJ1c ... I6IjIifX0.DeWt4Qu ... ZXso
    &amp;state=af0ifjsldkj
</pre></div>
<a name="HybridAuthError"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2.6"></a><h3>3.3.2.6.&nbsp;
Authentication Error Response</h3>

<p>
              ハイブリッドフローを使用する場合, 認証エラーレスポンスは, この章で指定された違いを除いて, <a class='info' href='#AuthError'>Section&nbsp;3.1.2.6<span> (</span><span class='info'>Authentication Error Response</span><span>)</span></a>で定義されるように, 認可コードフローと同じ方式で作成される

</p>
<p>
              もしエンドユーザがリクエストを拒否または認証に失敗した場合,
              認可サーバは, 異なるResponse Modeが定義されていない限り,
              <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749]の4.2.2.1章と<a class='info' href='#OAuth.Responses'>OAuth 2.0 Multiple Response Type Encoding Practices<span> (</span><span class='info'>de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, &ldquo;OAuth 2.0 Multiple Response Type Encoding Practices,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.Responses]に定義されるように,
              リダイレクトURIのフラグメントコンポーネントに含めて, error Authorization Responseを返却しなければならない(MUST)

</p>
<a name="HybridCallback"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2.7"></a><h3>3.3.2.7.&nbsp;
Redirect URI Fragment Handling</h3>

<p>
			  ハイブリッドフローを使用する場合, URI フラグメントパラメータのリダイレクト処理のための同じ要件が, <a class='info' href='#ImplicitCallback'>Section&nbsp;3.2.2.7<span> (</span><span class='info'>Redirect URI Fragment Handling</span><span>)</span></a>で定義されたように, Implicit Flowのため行われるように適用される.
			  また, URIフラグメント処理に関する実装上の注意のため, <a class='info' href='#FragmentNotes'>Section&nbsp;15.5.3<span> (</span><span class='info'>Redirect URI Fragment Handling Implementation Notes</span><span>)</span></a>を参照すること.

</p>
<a name="HybridAuthResponseValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2.8"></a><h3>3.3.2.8.&nbsp;
Authentication Response Validation</h3>

<p>
			  ハイブリッドフローを使用する場合, Clientは次の通りレスポンスを検証しなければならない(MUST):

              </p>
<ol class="text">
<li>
				  レスポンスが<a class='info' href='#OAuth.Responses'>[OAuth.Responses]<span> (</span><span class='info'>de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, &ldquo;OAuth 2.0 Multiple Response Type Encoding Practices,&rdquo; December&nbsp;2013.</span><span>)</span></a>のSection 5 に準拠していることを検証する.

</li>
<li>
				  検証ルールは, RFC 6949の特にSection 4.2.2と10.12. に従うこと.

</li>
<li>
				  使用される<tt>response_type</tt>の値が, <tt>code&nbsp;id_token</tt>か<tt>code&nbsp;id_token&nbsp;token</tt>の場合, ID Tokenの検証ルールは, <a class='info' href='#HybridIDTValidation'>Section&nbsp;3.3.2.12<span> (</span><span class='info'>ID Token Validation</span><span>)</span></a>に従うこと.

</li>
<li>
				  使用される<tt>response_type</tt>の値が, <tt>code&nbsp;token</tt>か<tt>code&nbsp;id_token&nbsp;token</tt>の場合, Access Tokenの検証ルールは, <a class='info' href='#HybridTokenValidation'>Section&nbsp;3.3.2.9<span> (</span><span class='info'>Access Token Validation</span><span>)</span></a>に従うこと.

</li>
<li>
				  使用される<tt>response_type</tt>の値が, <tt>code&nbsp;id_token</tt>, <tt>code&nbsp;token</tt>, または<tt>code&nbsp;id_token&nbsp;token</tt>の場合, Authorization Codeの検証ルールは, <a class='info' href='#CodeValidation'>Section&nbsp;3.3.2.10<span> (</span><span class='info'>Authorization Code Validation</span><span>)</span></a>に従うこと.

</li>
</ol><p>

</p>
<a name="HybridTokenValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2.9"></a><h3>3.3.2.9.&nbsp;
Access Token Validation</h3>

<p>
			  ハイブリッドフローを使用する場合, 認可エンドポイントから返却されるAccess Tokenは, <a class='info' href='#ImplicitTokenValidation'>Section&nbsp;3.2.2.9<span> (</span><span class='info'>Access Token Validation</span><span>)</span></a>で定義されたようにImplicit Flowと同じルールで検証される.

</p>
<a name="CodeValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2.10"></a><h3>3.3.2.10.&nbsp;
Authorization Code Validation</h3>

<p>
			 認可エンドポイントでID Tokenと一緒に発行されたAuthorization codeを検証するために, Clientは以下を行うべきである(SHOULD):

</p>
<p>
              </p>
<ol class="text">
<li>
			    ID Tokenの<a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature (JWS),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWS]ヘッダの中の<tt>alg</tt>ヘッダパラメータのために, <a class='info' href='#JWA'>JWA<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWA]で定義されるハッシュアルゴリズムで, <tt>code</tt>のASCII表現のオクテットをハッシュ化する.
			    たとえば, <tt>alg</tt>が<tt>RS256</tt>であれば, 使用されるハッシュアルゴリズムはSHA-256である.

</li>
<li>ハッシュの左半分を取得し, base64urlエンコードする.
</li>
<li>
				<tt>c_hash</tt>がID Tokenの中に存在する場合, 前のステップで生成された値とID Token中の<tt>c_hash</tt>の値が一致しなければならない.(MUST)

</li>
</ol><p>

</p>
<a name="HybridIDToken"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2.11"></a><h3>3.3.2.11.&nbsp;
ID Token</h3>

<p>
              ID トークンの内容は, <a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a> に記載されている.
              Hybrid フローを用いるとき, 以下の ID トークンクレームの追加要求は認可エンドポイントから返却される ID トークンに適用される:

</p>
<p>
              </p>
<blockquote class="text"><dl>
<dt>nonce</dt>
<dd>
                  このフローでは <tt>nonce</tt> クレームの使用は必須である(REQUIRED).

</dd>
<dt>at_hash</dt>
<dd>
                  アクセストークンのハッシュ値.
                  その値は <tt>access_token</tt> 値の ASCII 表記のオクテットを
                  ハッシュした値の左端を base64url エンコーディングしたものである.
                  そのハッシュアルゴリズムは ID トークンの <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature (JWS),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWS] ヘッダーの
                  <tt>alg</tt> ヘッダーパラメーターで用いられているハッシュアルゴリズムである.
                  例えば, <tt>alg</tt> が <tt>RS256</tt> である場合,
                  SHA-256 を用いて <tt>access_token</tt> の値をハッシュし,
                  左端 128 ビットを取り, それらを base64url エンコードする.
                  <tt>at_hash</tt> の値は大文字と小文字を区別する文字列である.

</dd>
<dt></dt>
<dd>
                  <tt>response_type</tt> の値が <tt>code&nbsp;id_token&nbsp;token</tt> で
                  認可エンドポイントから <tt>access_token</tt> 値と共に
                  ID トークンが発行された場合, これは必須である(REQUIRED).
                  それ以外の場合, 含めることは任意である(OPTIONAL).

</dd>
<dt>c_hash</dt>
<dd>
                  コードのハッシュ値.
                  <tt>code</tt> 値の ASCII 表記のオクテットを
                  ハッシュした値の左端を base64url エンコーディングしたものである.
                  そのハッシュアルゴリズムは ID トークンの <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature (JWS),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWS] ヘッダーの
                  <tt>alg</tt> ヘッダーパラメーターで用いられているハッシュアルゴリズムである.
                  例えば, <tt>alg</tt> が <tt>HS512</tt> である場合,
                  SHA-512 を用いて <tt>code</tt> の値をハッシュし,
                  左端 256 ビットを取り, それらを base64url エンコードする.
                  <tt>c_hash</tt> の値は大文字と小文字を区別する文字列である.

</dd>
<dt></dt>
<dd>
                  <tt>response_type</tt> の値が <tt>code&nbsp;id_token</tt> と <tt>code&nbsp;id_token&nbsp;token</tt> で,
                  認可エンドポイントから <tt>code</tt> と共に ID トークンが
                  発行された場合, これは必須である(REQUIRED).
                  それ以外の場合, 含めることは任意である(OPTIONAL).

</dd>
</dl></blockquote><p>

</p>
<a name="HybridIDTValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2.12"></a><h3>3.3.2.12.&nbsp;
ID Token Validation</h3>

<p>
              Hybrid フローを用いるとき, <a class='info' href='#ImplicitIDTValidation'>Section&nbsp;3.2.2.11<span> (</span><span class='info'>ID Token Validation</span><span>)</span></a> に
              定義されているように, 認可エンドポイントから返却される ID トークンの内容は
              Implicit フローと同様に確認されなければならない(MUST).

</p>
<a name="HybridTokenEndpoint"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3"></a><h3>3.3.3.&nbsp;
Token Endpoint</h3>

<p>
            Hybrid フローを用いるとき, このセクションで指定された相違点を除いて,
            <a class='info' href='#TokenEndpoint'>Section&nbsp;3.1.3<span> (</span><span class='info'>Token Endpoint</span><span>)</span></a> で定義されている認可コードフローと
            同様にトークンエンドポイントが使用される.

</p>
<a name="HybridTokenRequest"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3.1"></a><h3>3.3.3.1.&nbsp;
Token Request</h3>

<p>
              Hybrid フローが用いられるとき, <a class='info' href='#TokenRequest'>Section&nbsp;3.1.3.1<span> (</span><span class='info'>Token Request</span><span>)</span></a> に定義されている
              認可コードフローと同様にトークンリクエストが作られる.

</p>
<a name="HybridTokenRequestValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3.2"></a><h3>3.3.3.2.&nbsp;
Token Request Validation</h3>

<p>
              Hybrid フローが用いられるとき, <a class='info' href='#TokenRequestValidation'>Section&nbsp;3.1.3.2<span> (</span><span class='info'>Token Request Validation</span><span>)</span></a> に定義されている
              認可コードフローと同様にトークンリクエストが確認される.

</p>
<a name="HybridTokenResponse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3.3"></a><h3>3.3.3.3.&nbsp;
Successful Token Response</h3>

<p>
              Hybrid フローが用いられるとき, <a class='info' href='#TokenResponse'>Section&nbsp;3.1.3.3<span> (</span><span class='info'>Successful Token Response</span><span>)</span></a> に定義されている
              認可コードフローと同様にトークンレスポンスが作られる.

</p>
<a name="HybridTokenErrorResponse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3.4"></a><h3>3.3.3.4.&nbsp;
Token Error Response</h3>

<p>
              Hybrid フローが用いられるとき, <a class='info' href='#TokenErrorResponse'>Section&nbsp;3.1.3.4<span> (</span><span class='info'>Token Error Response</span><span>)</span></a> に定義されている
              認可コードフローと同様にトークンエラーレスポンスが作られる.

</p>
<a name="HybridTokenResponseValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3.5"></a><h3>3.3.3.5.&nbsp;
Token Response Validation</h3>

<p>
              Hybrid フローが用いられるとき, <a class='info' href='#TokenResponseValidation'>Section&nbsp;3.1.3.5<span> (</span><span class='info'>Token Response Validation</span><span>)</span></a> に定義されている
              認可コードフローと同様にトークンレスポンスは確認される.

</p>
<a name="HybridIDToken2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3.6"></a><h3>3.3.3.6.&nbsp;
ID Token</h3>

<p>
              Hybrid Flow を使用する場合, Token Endpoint から返された ID Token の内容はこのセクションで指定された違いを除いて, <a class='info' href='#HybridIDToken'>Section&nbsp;3.3.2.11<span> (</span><span class='info'>ID Token</span><span>)</span></a> で述べられているように, Authorization Endpoint から返された ID Token と同一である.

</p>
<p>
              ID Token が Authorization Endpoint と Token Endpoint の両方から返される場合(<tt>response_type</tt> 値が <tt>code&nbsp;id_token</tt> である場合と <tt>code&nbsp;id_token&nbsp;token</tt> である場合に該当する), <tt>iss</tt> クレームと <tt>sub</tt> クレームは両方の ID Token で同一でなければならない (MUST).
              いずれにも存在する Authentication イベントに関するすべてのクレームは両方に存在するべきである (SHOULD).
              ID Token のいずれかが End-User のクレームを含む場合, 両方に存在する任意のクレームはどちらでも同じ値を持つべきである (SHOULD).
              例えば, プライバシー上の理由により, OP は Authorization Endpoint から少数の End-User のクレームを返すことを選択してもよい (MAY) ことに注意.
              Token Endpoint から返される ID Token と Access Token はToken Endoint によって実行される TLS 暗号化 によって既に暗号的に紐付けられているため, <tt>at_hash</tt> クレームと <tt>c_hash</tt> クレームは Authorization Endpoint から返される ID Token から省略してもよい (MAY).

</p>
<a name="HybridIDTValidation2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3.7"></a><h3>3.3.3.7.&nbsp;
ID Token Validation</h3>

<p>
              Hybrid Flow を使用する場合, Token Endpoint で返される ID Token の内容は <a class='info' href='#IDTokenValidation'>Section&nbsp;3.1.3.7<span> (</span><span class='info'>ID Token Validation</span><span>)</span></a> で述べられているように, Authorization Code Flow と同様に検証されなければならない (MUST).

</p>
<a name="HybridAccessToken2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3.8"></a><h3>3.3.3.8.&nbsp;
Access Token</h3>

<p>
              Access Token が Authorization Endpoint と Token Endpoint の両方から返される場合(<tt>response_type</tt> 値が <tt>code&nbsp;token</tt> である場合と <tt>code&nbsp;id_token&nbsp;token</tt> である場合に該当する), それぞれの値は同一としてもよく (MAY), 異なる値としてもよい (MAY).
              2つのエンドポイントでの異なるセキュリティ特性によって異なる Access Token が返されるかもしれず, 有効期限と承認されたリソースへのアクセス権も異なる可能性があることに注意.

</p>
<a name="HybridTokenValidation2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3.9"></a><h3>3.3.3.9.&nbsp;
Access Token Validation</h3>

<p>
              Hybrid Flow を使用する場合, Token Endpoint で返される Access Token は <a class='info' href='#CodeFlowTokenValidation'>Section&nbsp;3.1.3.8<span> (</span><span class='info'>Access Token Validation</span><span>)</span></a> で述べられているように, Authorization Code Flow と同様に検証される.

</p>
<a name="ThirdPartyInitiatedLogin"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Initiating Login from a Third Party</h3>

<p>
        いくつかの場合, Relying Party よりもむしろ OpenID プロバイダーあるいは他の Party によってログインフローは開始される.
        この場合, RP が 指定された OP に認証リクエストを要求する開始プログラムは, 自身のログイン初期化エンドポイントで RP にリダイレクトする.
        このログイン初期化エンドポイントは, デフォルトのランディングページよりも, RP で深いリンクにすることができる.
        <a class='info' href='#OpenID.Registration'>OpenID Connect Dynamic Client Registration 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client Registration 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OpenID.Registration] をサポートする RPs は<tt>initiate_login_uri</tt> レジストレーションパラメーターを用いてこのエンドポイントの値を登録する.

</p>
<p>
        ログインリクエストを初期化する Party は, 以下のパラメーターを渡して RP でログイン初期化エンドポイントにリダイレクトすることによってそれを行う:

</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>iss</dt>
<dd>
            必須(REQUIRED).
            RP が認証リクエストを送信する OP のための Issuer Identifier.
            その値は <tt>https</tt> スキームを用いた URL でなければならない(MUST).

</dd>
<dt>login_hint</dt>
<dd>
            任意(OPTIONAL).
            End-User が　ログインするために使用されるかもしれないログイン識別子について
            の認可サーバーへのヒント.
            クライアントがこの文字列値パラメーターのために値を受け付ける場合,
            <tt>login_hint</tt> パラメーター値として認証リクエストの中に
            含めなければならない(MUST).

</dd>
<dt>target_link_uri</dt>
<dd>
            任意(OPTIONAL).
            認証後, RP がリダイレクトするために要求される URL.
            RPs は外部サイトへのオープンリダイレクターとして使用されることを防ぐために
            <tt>target_link_uri</tt> の値を検証しなければならない(MUST).

</dd>
</dl></blockquote><p>

</p>
<p>
        パラメーターは HTTP <tt>GET</tt> メソッドを用いた
        クエリストリングとして渡すか, User Agent で自動送信される HTML フォーム値として
        渡すことができ, HTTP <tt>POST</tt> メソッド経由で転送される.

</p>
<p>
        拡張によって他のパラメーターが定義される場合, 送られてもよい(MAY).
        解釈されず使用されたいくつかのパラメーターはクライアントによって無視されなければならない(MUST).

</p>
<p>
        クライアントはフレームバスティングや End-User をクリックジャッキングのような攻撃を
        通じてこれらの知識なしに third party サイトによってロギングされることから
        防ぐための他の技術を採用すべきである(SHOULD).
        詳細は <a class='info' href='#RFC6819'>[RFC6819]<span> (</span><span class='info'>Lodderstedt, T., McGloin, M., and P. Hunt, &ldquo;OAuth 2.0 Threat Model and Security Considerations,&rdquo; January&nbsp;2013.</span><span>)</span></a> の Section 4.4.1.9 を参照.

</p>
<a name="Claims"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Claims</h3>

<p>
        この章はクライアントが End-User と認証イベントについてのクレームをどのように
        付与することができるかということについて示す.
        ベーシックプロフィールクレームの標準セットも定義する.
        クレームの事前に定義されたセットは指定された scope 値を用いて要求することができ,
        個別のクレームは <tt>claims</tt> リクエストパラメーターを用いて
        要求することができる.
        そのクレームは OpenID Provider あるいは同様に分散ソースから直接送られてくる.

</p>
<a name="StandardClaims"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Standard Claims</h3>

<p>
          この仕様は標準クレームのセットを定義する.
          それらは <a class='info' href='#UserInfoResponse'>Section&nbsp;5.3.2<span> (</span><span class='info'>Successful UserInfo Response</span><span>)</span></a> の UserInfo レスポンス内
          あるいは <a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a> の ID トークン内で返却されるように要求できる.

</p><br /><hr class="insert" />
<a name="ClaimTable"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Member</th><th align="left">Type</th><th align="left">Description</th></tr>
<tr>
<td align="left">sub</td>
<td align="left">string</td>
<td align="left">Subject - Issuer における End-User の識別子</td>
</tr>
<tr>
<td align="left">name</td>
<td align="left">string</td>
<td align="left">
            End-User の表示用フルネーム.
            肩書きや称号 (suffix) 等が含まれることもある.
            氏名等の表示順は End-User の locale や選好に従う.
          </td>
</tr>
<tr>
<td align="left">given_name</td>
<td align="left">string</td>
<td align="left">
            End-User の名 (given name / first name).
            複数の given name を持つ文化圏もあることに注意.
            全ての given name が含まれる可能性があり, その場合はスペース区切りで表記される.
          </td>
</tr>
<tr>
<td align="left">family_name</td>
<td align="left">string</td>
<td align="left">
            End-User の姓 (surname / last name).
            複数の family name を持つ文化圏や family name を持たない文化圏もあることに注意.
            全ての family name が含まれる可能性があり, その場合はスペース区切りで表記される.
          </td>
</tr>
<tr>
<td align="left">middle_name</td>
<td align="left">string</td>
<td align="left">
            End-User の middle name. 複数の middle name を持つ文化圏もあることに注意.
            全ての middle name が含まれる可能性があり, その場合はスペース区切りで表記される.
            また middle name を使用しない文化圏もある.
          </td>
</tr>
<tr>
<td align="left">nickname</td>
<td align="left">string</td>
<td align="left">
            End-User のニックネーム. これは <tt>given_name</tt> と同じこともあれば
            異なることもある.
            例えば, <tt>nickname</tt> が <tt>Mike</tt>,
            <tt>given_name</tt> が <tt>Michael</tt> として
            返されることがある.
          </td>
</tr>
<tr>
<td align="left">preferred_username</td>
<td align="left">string</td>
<td align="left">
            <tt>janedoe</tt> や <tt>j.doe</tt> といった,
            End-User の選好する簡略名.
            これは <tt>@</tt> や <tt>/</tt> や
            空白文字といった特殊文字を含むあらゆる valid な JSON 文字列でありうる (MAY).
            <a class='info' href='#ClaimStability'>Section&nbsp;5.7<span> (</span><span class='info'>Claim Stability and Uniqueness</span><span>)</span></a> にあるように, RP はこの値がユニークであるという
            前提で扱ってはならない (MUST NOT).
          </td>
</tr>
<tr>
<td align="left">profile</td>
<td align="left">string</td>
<td align="left">
            End-User のプロフィールページの URL.
            この Web ページに掲載されるコンテンツはこの End-User に関するものであろう (SHOULD).
          </td>
</tr>
<tr>
<td align="left">picture</td>
<td align="left">string</td>
<td align="left">
            End-User のプロフィール画像の URL.
            この URL は画像ファイル (PNG, JPEG, GIF 画像ファイル等) を参照すること (MUST).
            またこの画像は End-User が撮影した任意の写真ではなく, End-User に言及する際に
            適切な画像とするべきである (SHOULD).
          </td>
</tr>
<tr>
<td align="left">website</td>
<td align="left">string</td>
<td align="left">
            End-User の Web ページやブログの URL.
            この Web ページは End-User 自身や End-User が所属する組織が発信する情報を含むべきである (SHOULD).
          </td>
</tr>
<tr>
<td align="left">email</td>
<td align="left">string</td>
<td align="left">
            End-User の選好する Email アドレス.
            <a class='info' href='#RFC5322'>RFC 5322<span> (</span><span class='info'>Resnick, P., Ed., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a> [RFC5322] の addr-spec シンタックスに従うこと.
            <a class='info' href='#ClaimStability'>Section&nbsp;5.7<span> (</span><span class='info'>Claim Stability and Uniqueness</span><span>)</span></a> にあるように, RP はこの値が
            ユニークであるという前提で扱ってはならない (MUST NOT).
          </td>
</tr>
<tr>
<td align="left">email_verified</td>
<td align="left">boolean</td>
<td align="left">
            End-User の Email アドレスが検証済であれば true, さもなければ false.
            Claim Value が <tt>true</tt> の場合, これは OP が検証を行った
            時点において該当 Email アドレスが End-User のコントロール下にあるという確認処理を行ったことを示す.
            Email アドレスの検証の詳細についてはコンテキストに依存し, 関係者間での
            トラストフレームワークや契約上の同意事項等などによって異なる.
          </td>
</tr>
<tr>
<td align="left">gender</td>
<td align="left">string</td>
<td align="left">
            End-User の性別.
            本仕様では <tt>female</tt>, <tt>male</tt> を定義する.
            定義済の値に適切なものがない場合, その他の値を利用してもよい (MAY).
          </td>
</tr>
<tr>
<td align="left">birthdate</td>
<td align="left">string</td>
<td align="left">
            End-User の誕生日.
            <a class='info' href='#ISO8601-2004'>ISO 8601:2004<span> (</span><span class='info'>International Organization for             Standardization, &ldquo;ISO 8601:2004. Data elements and interchange formats - Information interchange -           Representation of dates and times,&rdquo; 2004.</span><span>)</span></a> [ISO8601&#8209;2004] <tt>YYYY-MM-DD</tt> 形式で表現される.
            生年を <tt>0000</tt> とすることで生年を省略することもできる (MAY).
            生年のみを提示する場合は <tt>YYYY</tt> 形式としても良い.
            プラットフォームの日付関連の関数の実装によって, 生年のみを提供した場合の月日の扱いは
            様々であるため, 実装者はこの点を考慮にいれて日付を処理すべきである.
          </td>
</tr>
<tr>
<td align="left">zoneinfo</td>
<td align="left">string</td>
<td align="left">
            End-User のタイムゾーンを示す zoneinfo <a class='info' href='#zoneinfo'>[zoneinfo]<span> (</span><span class='info'>Public Domain, &ldquo;The tz database,&rdquo; June&nbsp;2011.</span><span>)</span></a> に登録された文字列.
            例えば, <tt>Europe/Paris</tt> や <tt>America/Los_Angeles</tt>.
          </td>
</tr>
<tr>
<td align="left">locale</td>
<td align="left">string</td>
<td align="left">
            End-User の locale.
            <a class='info' href='#RFC5646'>BCP47<span> (</span><span class='info'>Phillips, A. and M. Davis, &ldquo;Tags for Identifying Languages,&rdquo; September&nbsp;2009.</span><span>)</span></a> [RFC5646] 言語タグ表現.
            これは通常 <a class='info' href='#ISO639-1'>ISO 639-1 Alpha-2<span> (</span><span class='info'>International Organization for             Standardization, &ldquo;ISO 639-1:2002. Codes for the representation of names of           languages -- Part 1: Alpha-2 code,&rdquo; 2002.</span><span>)</span></a> [ISO639&#8209;1] 言語コードを小文字表記,
            <a class='info' href='#ISO3166-1'>ISO 3166-1 Alpha-2<span> (</span><span class='info'>International Organization for             Standardization, &ldquo;ISO 3166-1:1997. Codes for the representation of names of           countries and their subdivisions -- Part 1: Country codes,&rdquo; 1997.</span><span>)</span></a> [ISO3166&#8209;1] 国コードを大文字表記し,
            ダッシュでつなげたものである.
            (<tt>en-US</tt>, <tt>fr-CA</tt> 等)
            実装によってはダッシュの代わりにアンダースコアを区切り文字に用いる場合もあるため,
            互換性の観点からは注意すること. (<tt>en_US</tt> 等)
            Relying Party はダッシュ区切りに加えてアンダースコア区切りのシンタックスを受け入れてもよい (MAY).
          </td>
</tr>
<tr>
<td align="left">phone_number</td>
<td align="left">string</td>
<td align="left">
            End-User の選好する電話番号.
            この Claim のフォーマットとしては <a class='info' href='#E.164'>E.164<span> (</span><span class='info'>International Telecommunication Union, &ldquo;E.164: The international public telecommunication numbering plan,&rdquo; 2010.</span><span>)</span></a> [E.164] を推奨する (RECOMMENDED).
            (<tt>+1 (425) 555-1212</tt>, <tt>+56 (2) 687 2400</tt> 等)
            電話番号が拡張を含む場合, その拡張は <a class='info' href='#RFC3966'>RFC 3966<span> (</span><span class='info'>Schulzrinne, H., &ldquo;The tel URI for Telephone Numbers,&rdquo; December&nbsp;2004.</span><span>)</span></a> [RFC3966] 拡張シンタックスで
            表記することを推奨する (RECOMMENDED). (<tt>+1 (604) 555-1234;ext=5678</tt> 等)
          </td>
</tr>
<tr>
<td align="left">phone_number_verified</td>
<td align="left">boolean</td>
<td align="left">
            End-User の電話番号が検証済であれば ture, さもなければ false.
            Claim Value が <tt>true</tt> の場合,
            これは OP が検証を行った時点において該当電話番号が End-User のコントロール下に
            あるという確認処理を行ったことを示す.
            電話番号の検証の詳細についてはコンテキストに依存し,
            関係者間でのトラストフレームワークや契約上の同意事項等などによって異なる.
            また true の場合, <tt>phone_number</tt> Claim は E.164 形式で
            なければならず (MUST), すべての拡張は RFC 3966 形式でなければならない (MUST).
          </td>
</tr>
<tr>
<td align="left">address</td>
<td align="left">JSON object</td>
<td align="left">
            End-User の選好する郵送先住所.
            <tt>address</tt> メンバーは <a class='info' href='#AddressClaim'>Section&nbsp;5.1.1<span> (</span><span class='info'>Address Claim</span><span>)</span></a> に定義された
            メンバーを含む JSON <a class='info' href='#RFC4627'>[RFC4627]<span> (</span><span class='info'>Crockford, D., &ldquo;The application/json Media Type for JavaScript Object Notation (JSON),&rdquo; July&nbsp;2006.</span><span>)</span></a> 構造である.
          </td>
</tr>
<tr>
<td align="left">updated_at</td>
<td align="left">number</td>
<td align="left">
            End-User に関する情報の最終更新日時.
            この値は UTC 1970-01-01T0:0:0Z から該当時刻までの秒数を示す JSON 数値である.
          </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: Registered Member Definitions&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="AddressClaim"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
Address Claim</h3>

<p>
            Address Claim は物理的な郵送先住所である.
            End-User の登録済情報とプライバシー設定に基づいて, <tt>address</tt> の一部のみを返却することもある (MAY).
            例えば <tt>country</tt> と <tt>region</tt> を返し, それ以外の詳細なアドレス情報を省略するなどが考えられる.

</p>
<p>
            住所全体を <tt>formatted</tt> サブフィールドに1文字列として入れてもよいし (MAY), 他のサブフィールドに個別の要素として各住所要素を指定するだけでもよいし (MAY), 両方を含めてもよい (MAY).
            もし両方を含める場合, <tt>formatted</tt> 住所は住所の各要素の連結方法を示すものとし, 両方が同じ住所を示すこと (SHOULD).

</p>
<p>
            </p>
<blockquote class="text"><dl>
<dt>formatted</dt>
<dd>
                表示や宛名ラベルで使用するために整形された完全な郵送先住所.
                このフィールドは改行で区切られた複数の行を含んでもよい (MAY).
                改行は, 復帰/行送りのペア ("\r\n") か,
                または単一の行送り文字 ("\n") によって表現される.

</dd>
<dt>street_address</dt>
<dd>
                家番号, ストリート名, 私書箱, 複数行からなる拡張された住所情報を含むことができる (MAY) 完全な住所を示す要素.
                このフィールドは改行で区切られた複数の行を含んでもよい (MAY).
                改行は, 復帰/行送りのペア ("\r\n") か,
                または単一の行送り文字 ("\n") によって表現される.

</dd>
<dt>locality</dt>
<dd>
                市町村などを表す city, locality を示す要素.

</dd>
<dt>region</dt>
<dd>
                都道府県などを表す state, province, prefecture, region を示す要素.

</dd>
<dt>postal_code</dt>
<dd>
                郵便番号を表す ZIP code, postal code を示す要素.

</dd>
<dt>country</dt>
<dd>
                国名を示す要素.

</dd>
</dl></blockquote><p>

</p>
<a name="AdditionalClaims"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
Additional Claims</h3>

<p>
            当仕様では標準 Claim として小さなセットの Claim のみを定義しているが,
            その他の Claim を標準 Claim と同時に使用してもよい (MAY).
            このような Claim を用いる際は,
            <a class='info' href='#JWT'>JSON Web Token (JWT)<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token (JWT),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWT] 仕様に記載の通り,
            衝突耐性のある名称を Claim Name に用いることを推奨する (RECOMMENDED).
            あるいは, JWT 仕様に記載の通り, 名前衝突が発生する可能性が低い場合は,
            Private Claim Name を安全に利用できるだろう.
            もしくは, JWT 仕様に記載の通り, 追加の Claim が広く一般的に適用可能であれば,
            Registered Claim Name として登録も可能だろう.

</p>
<a name="ClaimsLanguagesAndScripts"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Claims Languages and Scripts</h3>

<p>
            Human-readable な Claim Value およびそれらへの参照は, 複数言語および複数文字種で表現することができる (MAY).
            言語および文字種の指定には <a class='info' href='#RFC5646'>BCP47<span> (</span><span class='info'>Phillips, A. and M. Davis, &ldquo;Tags for Identifying Languages,&rdquo; September&nbsp;2009.</span><span>)</span></a> [RFC5646] 言語タグを <tt>#</tt> を区切り文字としてメンバー名に付与する.
            例えば <tt>family_name#ja-Kana-JP</tt> は日本語のカタカナ表記の Family Name を示す.
            カタカナ表記の氏名は, 漢字表記 (<tt>family_name#ja-Hani-JP</tt>) の氏名の発音を示したりインデックス目的等で用いられることが多い.
            他にも <tt>website</tt> が言語指定のない Web サイト, <tt>website#de</tt> がドイツ語の Web サイトを参照していることを示すといった例も挙げられる.

</p>
<p>
          Claim Name は大文字小文字を区別するため, Claim Name 内の言語タグは <a class='info' href='#IANA.Language'>IANA Language Subtag Registry<span> (</span><span class='info'>Internet Assigned Numbers Authority (IANA), &ldquo;Language Subtag Registry,&rdquo; 2005.</span><span>)</span></a> [IANA.Language] に登録されたままの表記とすることを強く推奨する (RECOMMENDED).
          一般的に言語名は小文字, 地域名は大文字, 文字種は大文字小文字混合で表記されることが多い.
          しかしながら BCP47 言語タグ値は大文字小文字を区別しないため, 実装は言語タグを大文字小文字区別なく処理できるべきである (SHOULD).

</p>
<p>
          BCP47 で推奨されるように, Claim の言語タグ値は必要な時にのみ指定すべきである (SHOULD).
          例えばほとんどの場合 <tt>fr-CA</tt> や <tt>fr-FR</tt> でなく <tt>fr</tt> で十分である.
          可能であれば OP は要求された Claim locale と自身が持つ Claim のマッチングを試みるべきである (SHOULD).
          例えば Client が <tt>de</tt> (ドイツ語) の Claim を要求してきており, OP が <tt>de-CH</tt> (スイスのドイツ語) 表記の Claim は持つが地域指定無しの一般的ドイツ語表記の Claim を持たない場合, OP はスイスのドイツ語の値を返すのが適切である.
          (Client をできるかぎりシンプルに保つため, ここでは言語タグのマッチングが内包する複雑性をわざと OP に寄せている)

</p>
<p>
          返却される Claim の好ましい言語および文字種の指定を可能とするため,
          OpenID Connect では, 以下の Authorization Request パラメータを定義している:

          </p>
<blockquote class="text"><dl>
<dt>claims_locales</dt>
<dd>
              OPTIONAL.
              返却される Claim に関して, End-User が好む言語および文字種.
              スペース区切りの <a class='info' href='#RFC5646'>BCP47<span> (</span><span class='info'>Phillips, A. and M. Davis, &ldquo;Tags for Identifying Languages,&rdquo; September&nbsp;2009.</span><span>)</span></a> [RFC5646] 言語タグ値のリストとして表現され, 順序は選好順となる.
              要求されたロケールがサポートされていない場合でも, OpenID Provider はエラーとするべきではない (SHOULD NOT).

</dd>
</dl></blockquote><p>

</p>
<p>
          OP が <tt>claims_locales</tt> やその他の手段により End-User と Client が単一言語および文字種表記の Claim を要求していると特定した場合, 該当言語および文字種表記の Claim を返却する際には言語タグを付けずに返すことを推奨する (RECOMMENDED).
          また Client は言語タグ付きの Claim を処理可能なよう実装することを推奨する (RECOMMENDED).

</p>
<a name="UserInfo"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
UserInfo Endpoint</h3>

<p>
          UserInfo Endpoint は, 認証された End-User に関する Claim を返す OAuth 2.0 Protected Resource である.
          要求された End-User のクレームを取得するため, クライアントは OpenID Connect Authentication を通して得られた Access Token を用いて UserInfo Endpoint に要求する.
          これらのクレームは通常, クレームの名前と値のペアのコレクションを含んだ JSON オブジェクトで表現される.

</p>
<p>
          UserInfo Endpoint にアクセスする際には TLS は必須である (MUST).
          TLS 利用についての詳細は <a class='info' href='#TLSRequirements'>Section&nbsp;16.17<span> (</span><span class='info'>TLS Requirements</span><span>)</span></a> 参照.

</p>
<p>
          UserInfo Endpoint は <a class='info' href='#RFC2616'>RFC 2616<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> [RFC2616] で定義された HTTP <tt>GET</tt> メソッドと HTTP <tt>POST</tt> メソッドをサポートしなければならない (MUST).

</p>
<p>
          UserInfo Endpoint は <a class='info' href='#RFC6750'>OAuth 2.0 Bearer Token Usage<span> (</span><span class='info'>Jones, M. and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework: Bearer Token Usage,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6750] の Access Token を受け入れなければいけない (MUST).

</p>
<p>
          UserInfo Endpoint は Java Scipt クライアントが Endpoint にアクセスできるように <a class='info' href='#CORS'>Cross Origin Resource Sharing (CORS)<span> (</span><span class='info'>Opera Software ASA, &ldquo;Cross-Origin Resource Sharing,&rdquo; July&nbsp;2010.</span><span>)</span></a> [CORS] や 必要に応じて他の方法をサポートすべきである (SHOULD).

</p>
<a name="UserInfoRequest"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
UserInfo Request</h3>

<p>
            クライアントは HTTP <tt>GET</tt> か HTTP <tt>POST</tt> のいずれかを用いて UserInfo Request を送信する.
            OpenID Connect Authentication Request で得られた Access Token は <a class='info' href='#RFC6750'>OAuth 2.0 Bearer Token Usage<span> (</span><span class='info'>Jones, M. and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework: Bearer Token Usage,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6750] のセクション 2 に従って, Bearer Token として送信されなければいけない (MUST).

</p>
<p>
            要求は HTTP <tt>GET</tt> メソッドを用いて, Access Token が <tt>Authorization</tt> ヘッダフィールドで送信されることを推奨する (SHOULD).

</p>
<p>
              以下に UserInfo Request の一例を示す:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /userinfo HTTP/1.1
  Host: server.example.com
  Authorization: Bearer SlAV32hkKG
</pre></div>
<a name="UserInfoResponse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2"></a><h3>5.3.2.&nbsp;
Successful UserInfo Response</h3>

<p>
            クライアントの登録時に署名または暗号化されたレスポンスが要求されていない限り, UserInfo Claim は JSON オブジェクトのメンバーとして返される (MUST).
            <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> に定義されている Claim に加え, そこに明記されていない Claim も返却可能である.

</p>
<p>
            プライバシー上の理由により, OpenID Provider はいくつかの要求されたクレームの値を返さなくてもよい (MAY).

</p>
<p>
            クレームが返されない場合, クレーム名は JSON オブジェクトから除かれるべきであり (SHOULD), 値を null や空文字列にした状態で該当のクレームを含めるべきではない (SHOULD NOT).

</p>
<p>
            UserInfo Response には, 必ず <tt>sub</tt> クレームを含むこと (MUST).

</p>
<p>
            注) トークン置換攻撃(<a class='info' href='#TokenSubstitution'>Section&nbsp;16.11<span> (</span><span class='info'>Token Substitution</span><span>)</span></a> 参照)を考慮すると, UserInfo Response が必ずしも ID Token の <tt>sub</tt> Claim が示す End-User のものであるとは保証できない.
            そのため UserInfo Response に含まれる <tt>sub</tt> Claim が ID Token のそれと一致することを検証しなければならない (MUST).
            もし2つが一致しない場合, UserInfo Response を利用してはならない (MUST NOT).

</p>
<p>
            登録 <a class='info' href='#OpenID.Registration'>[OpenID.Registration]<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client Registration 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> 時に別の形式が指定された場合を除き, UserInfo Request を受信すると UserInfo Endpoint は <a class='info' href='#JSONSerialization'>Section&nbsp;13.3<span> (</span><span class='info'>JSON Serialization</span><span>)</span></a> のように, UserInfor Response の JSON Serialization を HTTP レスポンスボディで返さなければならない (MUST).
            UserInfo Endpoint は Content-Type ヘッダーを用いてフォーマットを示すこと (MUST).
            レスポンスボディがテキスト JSON オブジェクトである場合, HTTP レスポンスの Content-Type は <tt>application/json</tt> でなければならず (MUST), レスポンスボディは UTF-8 エンコードとすること (SHOULD).

</p>
<p>
            UserInfo Response が署名や暗号化をされている場合,
            クレームは JWT で返され, Content-Type は <tt>application/jwt</tt> でなければならない (MUST).
            レスポンスは署名無しに暗号化をしてもよい (MAY).
            署名と暗号化の両方が要求された場合, レスポンスは <a class='info' href='#JWT'>[JWT]<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token (JWT),&rdquo; November&nbsp;2013.</span><span>)</span></a> で定義されているように, 結果はネストされた JWT となり, 署名した後に暗号化しなければならない (MUST).

</p>
<p>
            署名する場合, UserInfo Response は
            メンバーとして <tt>iss</tt> (issuer) クレームと <tt>aud</tt> (audience) クレームを含むべきである (SHOULD).
            <tt>iss</tt> は OP の Issuer Identifier URL であるべきである (SHOULD).
            <tt>aud</tt> は RP の Client ID の値とするか, 値を含むべきである (SHOULD).

</p>
<p>
              以下に UserInfo Response の一例を示す:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 200 OK
  Content-Type: application/json

  {
   "sub": "248289761001",
   "name": "Jane Doe",
   "given_name": "Jane",
   "family_name": "Doe",
   "preferred_username": "j.doe",
   "email": "janedoe@example.com",
   "picture": "http://example.com/janedoe/me.jpg"
  }
</pre></div>
<a name="UserInfoError"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.3"></a><h3>5.3.3.&nbsp;
UserInfo Error Response</h3>

<p>
            もし何らかのエラーが起こった場合, UserInfo Endpoint は  <a class='info' href='#RFC6750'>OAuth 2.0 Bearer Token Usage<span> (</span><span class='info'>Jones, M. and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework: Bearer Token Usage,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6750] SEction 3 に示す Error Response を返す.
            (RFC 6750 に関係のないエラーは, 適切な HTTP ステータスコードを用いて User Agent に返すこと)

</p>
<p>
              以下に UserInfo Error Response の一例を示す:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 401 Unauthorized
  WWW-Authenticate: error="invalid_token",
    error_description="The Access Token expired"
</pre></div>
<a name="UserInfoResponseValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.4"></a><h3>5.3.4.&nbsp;
UserInfo Response Validation</h3>

<p>
            The Client MUST validate the UserInfo Response as follows:

</p>
<p>
            </p>
<ol class="text">
<li>
                レスポンスを返した OP が意図した通りの OP であることを, <a class='info' href='#RFC6125'>RFC 6125<span> (</span><span class='info'>Saint-Andre, P. and J. Hodges, &ldquo;Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS),&rdquo; March&nbsp;2011.</span><span>)</span></a> [RFC6125] に従い TLS サーバー証明書チェックを通じて検証する.

</li>
<li>
                クライアントが登録時に <tt>userinfo_encrypted_response_alg</tt> パラメータを提供した場合, 登録時に指定した鍵を使用して UserInfo Response を復号する.

</li>
<li>
                レスポンスが署名されている場合, クライアントは <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature (JWS),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWS] に従って署名を検証すべきである (SHOULD).

</li>
</ol><p>

</p>
<a name="ScopeClaims"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Requesting Claims using Scope Values</h3>

<p>
          OpenID Connect Client は <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] Section 3.3 に従い, Access Token に要求されるアクセス権限を <tt>scope</tt> 値を通じて指定する.
          Access Tokens に紐づく scope は, そのトークンを使って OAuth 2.0 で保護されたエンドポイントにアクセスした際にどのようなリソースが得られるかを規定する.
          Protected Resource エンドポイントは,
          提示された Access Token を要求した際に使用した scope 値やその他のパラメータに基づき,
          異なる動作をしたり, 異なる情報を返却したりしてもよい (MAY).

</p>
<p>
          OpenID Connect では, scope は Claim Value として取得可能な情報セットを指定する為に利用できる.
          本仕様では OpenID Connect で用いられる scope についてのみ述べる.

</p>
<p>
          Authorization Server は, 以下の scope によって要求される Claim を Voluntary Claim として扱う.

</p>
<p>
          OpenID Connect は, Claim を要求する際に用いられる以下の <tt>scope</tt> 値を定義する:

</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>profile</dt>
<dd>
              OPTIONAL.
              この scope 値は, 以下に示す End-User のデフォルトプロフィール Claim へのアクセス要求に用いる.


            <tt>name</tt>,
            <tt>family_name</tt>,
            <tt>given_name</tt>,
            <tt>middle_name</tt>,
            <tt>nickname</tt>,
            <tt>preferred_username</tt>,
            <tt>profile</tt>,
            <tt>picture</tt>,
            <tt>website</tt>,
            <tt>gender</tt>,
            <tt>birthdate</tt>,
            <tt>zoneinfo</tt>,
            <tt>locale</tt>, and
            <tt>updated_at</tt>.
</dd>
<dt>email</dt>
<dd>
              OPTIONAL.
              <tt>email</tt> および <tt>email_verified</tt> Claim へのアクセス要求に用いる.

</dd>
<dt>address</dt>
<dd>
              OPTIONAL.
              <tt>address</tt> Claim へのアクセス要求に用いる.

</dd>
<dt>phone</dt>
<dd>
              OPTIONAL.
              <tt>phone_number</tt> および <tt>phone_number_verified</tt> Claim へのアクセス要求に用いる.

</dd>
</dl></blockquote><p>

</p>
<p>
          複数の scope 値は, スペース区切りの大文字小文字を区別した ASCII scope 値のリストによって指定することができる (MAY).

</p>
<p>
          処理の結果として Access Token が発行される <tt>response_type</tt> を使用したとき,
          <tt>profile</tt>,
          <tt>email</tt>,
          <tt>address</tt>, および
          <tt>phone</tt> scope 値により要求される Claim は, <a class='info' href='#UserInfoResponse'>Section&nbsp;5.3.2<span> (</span><span class='info'>Successful UserInfo Response</span><span>)</span></a> にある通り UserInfo Endpoint から返される.
          しかし,
          (<tt>response_type</tt> 値が <tt>id_token</tt> であるケースのように) Access Token が発行されない場合, 結果 Claim はID Token 内で返却される.

</p>
<p>
          End-User が OpenID Provider に対して RP に要求された情報の一部もしくは全ての提供を拒否することもある.
          End-User に要求する情報を最小化するために, RP は UserInfo Endpoint で提供される情報の一部のみをリクエストすることもできる.

</p>
<p>

<p>
              以下に符号化されていない <tt>scope</tt> リクエスト例を示す.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  scope=openid profile email phone
</pre></div>


<a name="ClaimsParameter"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Requesting Claims using the "claims" Request Parameter</h3>

<p>
          OpenID Connect は, 個々の Claim の要求や,
          要求された Claim に適用されるパラメータの指定を可能とするために,
          以下の Authorization Request パラメータを定義する:

          </p>
<blockquote class="text"><dl>
<dt>claims</dt>
<dd>
              OPTIONAL.
              当パラメータは, 特定の Claim の返却を要求するのに用いられる.
              値は要求する Claim をリスト化した JSON オブジェクトである.

</dd>
</dl></blockquote><p>

</p>
<p>
          <tt>claims</tt> Authentication Request パラメータは,
          特定の Claim を UserInfo Endpoint から, かつ/または ID Token 内で, 返却することを要求する.
          これは要求する Claim のリストを含む JSON オブジェクトとして表される.
          要求する Claim のプロパティが指定されていてもよい (MAY).

</p>
<p>
          <tt>claims</tt> パラメータのサポートは任意である (OPTIONAL).
          当パラメータをサポートしない OP に対して RP が当パラメータを使用したとき,
          OP は 適切と思われるヒューリスティックな方法を用いて, RP と End-User にとって有益と思われる Claim のセットを返すべきである (SHOULD).
          <tt>claims_parameter_supported</tt> Discovery 結果は, OP が当パラメータをサポートしているかどうかを示す.

</p>
<p>
          <tt>claims</tt> パラメータ値は, OAuth 2.0 要求の中で, UTF-8 でエンコードされた JSON として表される
          (最終的には OAuth パラメータとして受け渡されるときに form-urlencoded される).
          Request Object 値として使用される際は,
          <a class='info' href='#RequestObject'>Section&nbsp;6.1<span> (</span><span class='info'>Passing a Request Object by Value</span><span>)</span></a> により,
          JSON が <tt>claims</tt> メンバーの値として使用される.

</p>
<p>
          Claim 要求 JSON オブジェクトのトップレベルメンバーは以下の通り:

          </p>
<blockquote class="text"><dl>
<dt>userinfo</dt>
<dd>
              OPTIONAL.
              UserInfo Endpoint へ返却を要求する個々の Claim のリストを示す.
              当メンバーが存在した場合,
              <tt>scope</tt> 値で要求された Claim に加え,
              当メンバーでリストされた Claim も返却される.
              当メンバーが存在しなかった場合,
              <tt>scope</tt> 値で要求された Claim のみが返却される.

</dd>
<dt></dt>
<dd>
              <tt>userinfo</tt> メンバーを指定する際は,
              UserInfo Endpoint を使用するために,
              <tt>response_type</tt> に対し,
              Access Token を Client に発行するタイプの値を指定しなければならない (MUST).

</dd>
<dt>id_token</dt>
<dd>
              OPTIONAL.
              ID Token 内に格納して返却を要求する個々の Claim のリストを示す.
              当メンバーが存在した場合,
              デフォルトの Claim に加え,
              当メンバーでリストされた Claim も返却される.
              当メンバーが存在しなかった場合,
              デフォルトの Claim のみが返却される.
              デフォルトの Claim 等の ID Token の定義については <a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a>を,
              フロー毎の ID Token 要件については Section
              <a class='info' href='#CodeIDToken'>3.1.3.6<span> (</span><span class='info'>ID Token</span><span>)</span></a>,
              <a class='info' href='#ImplicitIDToken'>3.2.2.10<span> (</span><span class='info'>ID Token</span><span>)</span></a>,
              <a class='info' href='#HybridIDToken'>3.3.2.11<span> (</span><span class='info'>ID Token</span><span>)</span></a>,
              <a class='info' href='#HybridIDToken2'>3.3.3.6<span> (</span><span class='info'>ID Token</span><span>)</span></a>
              を参照すること.

</dd>
</dl></blockquote><p>

          上記以外のメンバーが存在してもよい (MAY).
          認識できないメンバーが使用された場合は無視しなければならない (MUST).

</p>
<p>

<p>Claim 要求の例を以下に示す:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "userinfo":
    {
     "given_name": {"essential": true},
     "nickname": null,
     "email": {"essential": true},
     "email_verified": {"essential": true},
     "picture": null,
     "http://example.info/claims/groups": null
    },
   "id_token":
    {
     "auth_time": {"essential": true},
     "acr": {"values": ["urn:mace:incommon:iap:silver"] }
    }
  }
</pre></div>
          <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> で定義されている標準セットには含まれていない Claim である
          (example) <tt>http://example.info/claims/groups</tt> Claim が
          要求されていることに注意すること.
          <tt>claims</tt> パラメータの使用は,
          標準セットに含まれていない Claim を要求する唯一の方法である.
          また, <tt>scope</tt> 値では指定することが出来ない
          標準の Claim 同士の特定の組み合わせを要求する唯一の方法でもある.


<a name="IndividualClaimsRequests"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.1"></a><h3>5.5.1.&nbsp;
Individual Claims Requests</h3>

<p>
            <tt>claims</tt> request の <tt>userinfo</tt> メンバーと <tt>id_token</tt> メンバーは, 要求される個別のクレームの名前をメンバー名とする JSON オブジェクトである.
            メンバーの値は以下のいずれかの値でなければならない (MUST).


            </p>
<blockquote class="text"><dl>
<dt>null</dt>
<dd>
                このクレームはデフォルトの形式で要求されていることを示す.
                具体的に言うと, Voluntary Claim である.
                例えば, Claim request:

                <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  "given_name": null
</pre></div>

                は <tt>given_name</tt> クレームをデフォルトの形式で要求する.

</dd>
<dt>JSON Object</dt>
<dd>
                要求されているクレームの追加情報を提供するために使用する.
                本仕様は下記のメンバーを定義する:



<blockquote class="text"><dl>
<dt>essential</dt>
<dd>
                    OPTIONAL.
                    要求されているクレームが Essential Claim であるかどうかを示す.
                    値が <tt>true</tt> である場合, クレームが Essential Claim であることを示す.
                    例えば, Claim request:

                    <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  "auth_time": {"essential": true}
</pre></div>

                    は <tt>auth_time</tt> クレームの値を返すために Essential であることを指定するために使われる.

</dd>
<dt></dt>
<dd>
                    <tt>false</tt> である場合, Voluntary Claim であることを示す.
                    デフォルトは <tt>false</tt> である.

</dd>
<dt></dt>
<dd>
                    Essential Claim としてクレームを要求することで, RP はこれらのクレームの開示は End-User が要求するあるタスクに対して円滑な認可処理を確保するためであることを End-User に示す.
                    End-User がこれらの開示を認可しなかったり, これらが存在しないためにクレームが利用できない場合であっても, 特定のクレームの記述で特別に指定されない限り, クレームが Essential か Voluntary であるかどうか返されない時は Authorization Server はエラーを生成してはならない (MUST NOT) ことに注意.

</dd>
<dt>value</dt>
<dd>
                    OPTIONAL.
                    特定の値とともに返されるクレームを要求する.
                    例えば Claim request:

                    <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  "sub": {"value": "248289761001"}
</pre></div>

                    は要求が Subject Identifier <tt>248289761001</tt> を持つ End-User に適用されることを指定するために使われる.

</dd>
<dt></dt>
<dd>
                    <tt>value</tt> メンバーの値は要求されているクレームに対して有効な値でなければならない (MUST).
                    individual claims の定義は <tt>value</tt> 修飾子がクレームを要求する際に使うかどうか, どのように使うかという要件を含めることが出来る.

</dd>
<dt>values</dt>
<dd>
                    OPTIONAL.
                    優先順になっている値の集合の内のいずれかで返されるクレームを要求する.
                    例えば, Claim request:

                    <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  "acr": {"essential": true,
          "values": ["urn:mace:incommon:iap:silver",
                     "urn:mace:incommon:iap:bronze"]}
</pre></div>

                    は <tt>urn:mace:incommon:iap:silver</tt> か <tt>urn:mace:incommon:iap:bronze</tt> のいずれかで返される <tt>acr</tt> クレームが Essential であることを指定する.

</dd>
<dt></dt>
<dd>
                    <tt>values</tt> メンバー配列の値は要求されているクレームに対して有効な値でなければならない (MUST).
                    individual claims の定義は <tt>values</tt> 修飾子がクレームを要求する際に使うかどうか, どのように使うかという要件を含めることが出来る.

</dd>
</dl></blockquote>

                要求されるクレームの追加情報を提供するために他のメンバーを定義してもよい (MAY).
                解釈不可能なメンバーは全て無視すること (MUST).


</dd>
</dl></blockquote><p>

</p>
<p>
            <tt>claims</tt> request パラメータがサポートされている場合, クレームを要求するscopeの値は <a class='info' href='#ScopeClaims'>Section&nbsp;5.4<span> (</span><span class='info'>Requesting Claims using Scope Values</span><span>)</span></a> で述べられているように, 効果的に簡略化された, individual Claims の集合を要求するための方法であることに注意.
            例えば, <tt>openid email</tt> scope 値と Access Token を返す <tt>response_type</tt> を使用することは <tt>openid</tt> scope 値と individual Claims に対する下記のリクエストを使用することと同じである.

<p>
                下記のリクエストは <tt>email</tt> scope 値を使用した場合と同じ結果となる:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "userinfo":
    {
     "email": null,
     "email_verified": null
    }
  }
</pre></div>


<a name="acrSemantics"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.1.1"></a><h3>5.5.1.1.&nbsp;
Requesting the "acr" Claim</h3>

<p>
              <tt>acr</tt> クレームが特定の Authentication Context Class Reference 値と <tt>claims</tt> パラメータをサポートする実装を要求する <tt>values</tt> パラメータとともに ID Token の Essential Claim として要求される場合, Authorization Server は要求された値のいずれかに一致する <tt>acr</tt> クレームを返さなければいけない (MUST).
              Authorization Server は要求を満たす追加の要素を再認証するために End-User にたずねてもよい (MAY).
              このクレームが Essential Claim であり要求を満たすことが出来ない場合, Authorization Server は認証の試行に失敗したものとして扱わなければいけない (MUST).

</p>
<p>
              RP は <tt>acr_values</tt> request パラメータを使用して, もしくは個別の <tt>acr</tt> Claim request で "essential": true を含まないことにより Voluntary Claim として <tt>acr</tt> クレームを要求してもよい (MAY).
              クレームが Essential でなく要求された値が提供できない場合, Authorization Server は <tt>acr</tt> クレームの値としてセッションの現在の <tt>acr</tt> を返すべきである (SHOULD).
              クレームが Essential でない場合, Authorization Server はレスポンスにおいてこのクレームを提供する必要はない.

</p>
<p>
              クライアントが <tt>acr_values</tt> request パラメータと ID Token のために要求する特定の値をリストにした個別の <tt>acr</tt> Claim request の両方を用いて <tt>acr</tt> クレームを要求する場合, その結果の振る舞いは規定されていない.

</p>
<a name="IndividualClaimsLanguages"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.2"></a><h3>5.5.2.&nbsp;
Languages and Scripts for Individual Claims</h3>

<p>
            <a class='info' href='#ClaimsLanguagesAndScripts'>Section&nbsp;5.2<span> (</span><span class='info'>Claims Languages and Scripts</span><span>)</span></a> で述べられているように, Human-readable な Claim Value およびそれらへの参照は, 複数言語および複数文字種で表現することができる (MAY).
            個別のクレームの要求の内, 特定のクレームに対して要求された言語および文字種は <a class='info' href='#ClaimsLanguagesAndScripts'>Section&nbsp;5.2<span> (</span><span class='info'>Claims Languages and Scripts</span><span>)</span></a> で指定されたクレーム名の構文を用いて, クレーム要求に <tt>#</tt> で区切られた <a class='info' href='#RFC5646'>BCP47<span> (</span><span class='info'>Phillips, A. and M. Davis, &ldquo;Tags for Identifying Languages,&rdquo; September&nbsp;2009.</span><span>)</span></a> [RFC5646] 言語タグで構成されたクレーム名を含んだ要求をしてもよい (MAY).
            例えば, 日本語のカタカナでの姓名はクレーム名 <tt>family_name#ja-Kana-JP</tt> を用いて要求することができ, 日本語の漢字表記の姓名はクレーム名 <tt>family_name#ja-Hani-JP</tt> を用いて要求することができる.
            ドイツ語のWebサイトはクレーム名 <tt>website#de</tt> で要求することができる.

</p>
<p>
            OP が保持していない言語および文字種での Human-readable なクレームの要求を受け取った場合, 返されるクレームのいずれかのバージョンはクレーム名に要求された言語および文字種を使わず言語タグを使用するべきである (SHOULD).

</p>
<a name="ClaimTypes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6"></a><h3>5.6.&nbsp;
Claim Types</h3>

<p>
          クレーム値の3つの表記法はこの仕様によって定義される:

</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>Normal Claims</dt>
<dd>
              OpenID プロバイダーによって直接アサートされたクレーム.

</dd>
<dt>Aggregated Claims</dt>
<dd>
              OpenID プロバイダー以外のクレームプロバイダーによってアサートされたクレームだが,
              OpenID プロバイダーから返却される.

</dd>
<dt>Distributed Claims</dt>
<dd>
              OpenID プロバイダー以外のクレームプロバイダーによってアサートされたクレームだが,
              OpenID プロバイダーによる参照として返却される.

</dd>
</dl></blockquote><p>

</p>
<p>
          Normal Claims はサポートしなければならない(MUST).
          Aggregated Claims と Distributed Claims のサポートは任意である(OPTIONAL).

</p>
<a name="NormalClaims"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6.1"></a><h3>5.6.1.&nbsp;
Normal Claims</h3>

<p>
            Normal Claims は JSON オブジェクトで要素として表記される.
            クレーム名はその要素名で, クレーム値はその要素の値である.

</p>
<p>
            以下は Normal Claims を含んでいるレスポンスの一例である:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "name": "Jane Doe",
   "given_name": "Jane",
   "family_name": "Doe",
   "email": "janedoe@example.com",
   "picture": "http://example.com/janedoe/me.jpg"
  }
</pre></div>
<a name="AggregatedDistributedClaims"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6.2"></a><h3>5.6.2.&nbsp;
Aggregated and Distributed Claims</h3>

<p>
            Aggregated と distributed Claims は
            特殊な <tt>_claim_names</tt> と
            クレームに含まれている JSON オブジェクト
            の <tt>_claim_sources</tt> の要素を用いて表記される.

</p>
<p>
            </p>
<blockquote class="text"><dl>
<dt>_claim_names</dt>
<dd>
                要素名が Aggregated と Distributed Claims のためのクレーム名である
                Json オブジェクトである.
                その要素の値は, 実際のクレーム値が取り出せる
                <tt>_claim_sources</tt> の要素の中にある要素名への参照である.

</dd>
<dt>_claim_sources</dt>
<dd>
                要素名が <tt>_claim_names</tt> の要素の値の要素値によって
                参照される JSON オブジェクトである.
                要素の値は Aggregated Claims のセットもしくは Distributed Claims の参照場所を含む.
                要素値はそれが Aggregated あるいは Distributed Claims を提供しているが
                どうかに応じて以下のフォーマットの1つを持つことができる:


<blockquote class="text"><dl>
<dt>Aggregated Claims</dt>
<dd>
                    値が 対応した <tt>_claim_sources</tt> 要素を参照する
                    <tt>_claim_names</tt> オブジェクトの中に
                    全てのクレームを含まなければならない(MUST) <a class='info' href='#JWT'>JWT<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token (JWT),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWT] である
                    <tt>JWT</tt> 要素を含まなければならない(MUST) JSON オブジェクトである.
                    他の要素は提供してもよい(MAY).
                    解釈されずに使用されるいくつかの要素は無視しなければならない(MUST).


<blockquote class="text"><dl>
<dt>JWT</dt>
<dd>
                        必須(REQUIRED).
                        クレーム値を含んでいる JWT.

</dd>
</dl></blockquote>

</dd>
<dt></dt>
<dd>
                    JWT は( OpenID プロバイダーあるいは他の party のためでなく)
                    値がクレームプロバイダーで End-User のための識別子でない限り
                    <tt>sub</tt> (subject) クレームを含むべきではない(SHOULD NOT);
                    一般的にこれは <tt>sub</tt> クレームが提供されるべきではない
                    ということを意味している.

</dd>
<dt>Distributed Claims</dt>
<dd>
                    以下の要素と値を含む JSON オブジェクトである:


<blockquote class="text"><dl>
<dt>endpoint</dt>
<dd>
                        必須(REQUIRED).
                        関連したクレームが取り出すことができる OAuth 2.0 リソースエンドポイント.
                        エンドポイント URL は JWT としてのクレームを返却しなければならない(MUST).

</dd>
<dt>access_token</dt>
<dd>
                      任意(OPTIONAL).
                      <a class='info' href='#RFC6750'>OAuth 2.0 Bearer Token Usage<span> (</span><span class='info'>Jones, M. and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework: Bearer Token Usage,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6750] プロトコルの使用による
                      エンドポイント URL からクレームの取得が可能なアクセストークン.
                      クレームは認可コードリクエストヘッダーフィールドを用いてリクエストされ
                      なければならず(MUST), クレームプロバイダーはこの方法をサポートしなければならない(MUST).
                      アクセストークンが使用可能でない場合, RPs は帯域外からアクセストークンを取り出す
                      必要があってもよく, あるいはクレームプロバイダーと RP 間で事前に交渉された
                      アクセストークンを使用してもよい(MAY).
                      あるいはクレームプロバイダーは End-User を再認証, かつ/もしくは RP を再認可もてもよい(MAY).

</dd>
</dl></blockquote>

</dd>
<dt></dt>
<dd>
                    ( OpenID プロバイダーあるいは他の party のためでなく)
                    値がクレームプロバイダーで End-User のための識別子でない限り
                    <tt>sub</tt> (subject) クレームはクレームプロバイダーから返却される
                    べきではない(SHOULD NOT):
                    一般的にこれは <tt>sub</tt> クレームが提要されるできではない(SHOULD NOT)
                    ということを意味している.

</dd>
</dl></blockquote>

</dd>
</dl></blockquote><p>

</p>
<p>
            一般に, Aggregated Claims と Distributed Claims を使用することが適切であるとき,
            OP はやるべきである.
            いくつかの場合では, どのようなクレームタイプの使用をするときについての情報は
            RPs と OPs の間で帯域外で交渉されるかもしれない.

</p>
<a name="AggregatedExample"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6.2.1"></a><h3>5.6.2.1.&nbsp;
Example of Aggregated Claims</h3>

<p>
              この一例は, Aggregated Claims として返却されるクレームプロバイダー A からの
              クレームを用いてクレームプロバイダー A からのクレームは OpenID プロバイダーによって
              保有された他のクレームと, 組み合わせられている.

</p>
<p>

<p>
                  この例では, Jane Doe についてのこれらのクレームはクレームプロバイダー A によって発行された:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "address": {
     "street_address": "1234 Hollywood Blvd.",
     "locality": "Los Angeles",
     "region": "CA",
     "postal_code": "90210",
     "country": "US"},
   "phone_number": "+1 (310) 123-4567"
  }
</pre></div>


<p>
              クレームプロバイダー A は JSON クレームに署名し, signed JWT でそれらを表現する:
              jwt_header.jwt_part2.jwt_part3.
              この JWT は OpenID プロバイダーによって使用される.

</p>
<p>

<p>
                  この例では, クレームプロバイダー A からの Jane Doe の Aggregated Claims を
                  含んでいるこの JWT は他の Normal Claims 組み合わせられており,
                  以下のクレームセットとして返却される:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "name": "Jane Doe",
   "given_name": "Jane",
   "family_name": "Doe",
   "birthdate": "0000-03-22",
   "eye_color": "blue",
   "email": "janedoe@example.com",
   "_claim_names": {
     "address": "src1",
     "phone_number": "src1"
   },
   "_claim_sources": {
     "src1": {"JWT": "jwt_header.jwt_part2.jwt_part3"}
   }
  }
</pre></div>


<a name="DistributedExample"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6.2.2"></a><h3>5.6.2.2.&nbsp;
Example of Distributed Claims</h3>

<p>
              この一例は, OpenID プロバイダーが Distributed Claims として B と C によって保持された
              クレームのいくつかの参照を組み込んでいる B と C の2つの異なるクレームプロバイダーによって
              保持されたクレームへの参照を保持している Normal Claims を組み合わせる.

</p>
<p>

<p>
                  この例では, Jane Doe についてのクレームは
                  クレームプロバイダー B (Jane Doe's bank) によって保持されている:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "shipping_address": {
     "street_address": "1234 Hollywood Blvd.",
     "locality": "Los Angeles",
     "region": "CA",
     "postal_code": "90210",
     "country": "US"},
   "payment_info": "Some_Card 1234 5678 9012 3456",
   "phone_number": "+1 (310) 123-4567"
  }
</pre></div>


<p>

<p>
                  またこの例では, Jane Doe についてのこのクレームは
                  クレームプロバイダー C (a credit agency) によって保持されている:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "credit_score": 650
  }
</pre></div>


<p>

<p>
                  OpenID プロバイダーは, アクセストークンと Distributed Claims を取り出すことができる
                  URLs を送信することによってクレームプロバイダー B と クレームプロバイダー C からの
                  Distributed Claims の参照先とともに Jane Doe のクレームを返却する.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "name": "Jane Doe",
   "given_name": "Jane",
   "family_name": "Doe",
   "email": "janedoe@example.com",
   "birthdate": "0000-03-22",
   "eye_color": "blue",
   "_claim_names": {
     "payment_info": "src1",
     "shipping_address": "src1",
     "credit_score": "src2"
    },
   "_claim_sources": {
     "src1": {"endpoint":
                "https://bank.example.com/claim_source"},
     "src2": {"endpoint":
                "https://creditagency.example.com/claims_here",
              "access_token": "ksj3n283dke"}
   }
  }
</pre></div>


<a name="ClaimStability"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.7"></a><h3>5.7.&nbsp;
Claim Stability and Uniqueness</h3>

<p>
          <a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a> で説明されているように
          <tt>sub</tt> クレームはローカルで一意でなければならず(MUST),
          特定の End-User のために Issuer 内で決して再割り当てされないため,
          共に使用される <tt>sub</tt> (subject) と
          <tt>iss</tt> (issuer) クレームは End-User のための安定した識別子として信頼できる.
          ゆえに, End-User に与えられた唯一保証された一意の識別子は
          <tt>iss</tt> クレームと
           <tt>sub</tt> クレームの組み合わせである.

</p>
<p>
          他の全てのクレームは, 時間経過あるいはユーザ間の一意性の安定の観点から異なる issuers 間で
          このような保証を伝えず, Issuers はローカルの制限やポリシーを適用することを許可する.
          例えば, Issuer は異なる時点で異なる End-Users 間で <tt>email</tt>
          クレーム値を再利用してもよく(MAY), 指定された End-User のための
          claimed <tt>email</tt> address は時間の経過とともに変更してもよい(MAY).
          ゆえに, <tt>email</tt>, <tt>phone_number</tt>,
          <tt>preferred_username</tt> のような他のクレームは
          End-User の一意な識別子として使用してはいけない(MUST NOT).

</p>
<a name="JWTRequests"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Passing Request Parameters as JWTs</h3>

<p>
        OpenID Connect では, Authorization Request に署名および暗号化を可能にするため, 以下の Authorization Request パラメータを定義する.


        </p>
<blockquote class="text"><dl>
<dt>request</dt>
<dd>
            任意 (OPTIONAL).
            このパラメータにより, OpenID Connect リクエストを単一の self-contained なパラメータとすることができ, 任意で署名および暗号化を施せるようになる.
            パラメータ値は Request Object 値である (<a class='info' href='#RequestObject'>Section&nbsp;6.1<span> (</span><span class='info'>Passing a Request Object by Value</span><span>)</span></a> 参照).
            Request Object は, 各 Claim がリクエストパラメータとなる JWT である.


</dd>
<dt>request_uri</dt>
<dd>
            任意 (OPTIONAL).
            このパラメータにより, 値そのものではなく参照を送ることが可能になる.
            <tt>request_uri</tt> 値は <tt>https</tt> スキーマで始まる URL であり, Request Object 値を含むリソースへの参照となる.
            参照先の Request Object は, リクエストパラメータを含む JWT である.


</dd>
</dl></blockquote><p>

</p>
<p>
        これらのパラメータを利用したリクエストは JWT として表現され, その値もしくは参照が送信される.
        リクエストを参照渡しすることで, 長大なリクエストを扱いやすくなる.
        上記のパラメータのいずれかを利用する場合は, 同一リクエスト中で他方を利用してはならない (MUST NOT).


</p>
<a name="RequestObject"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Passing a Request Object by Value</h3>

<p>
          <tt>request</tt> Authorization Request パラメータにより, OpenID Connect リクエストを単一の self-contained なパラメータとすることができ, 任意で署名および暗号化を施せるようになる.
          このパラメータは, 各 Claim がリクエストパラメータとなる JWT である (<a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a> 参照).
          この JWT は Request Object と呼ばれる.

</p>
<p>
          <tt>request</tt> パラメータのサポートはオプションである (OPTIONAL).
          Discovery 結果の <tt>request_parameter_supported</tt> により, OP がこのパラメータをサポートしていることを知ることができる.
          OP がこのパラメータをサポートしていないにも関わらず RP がこれを利用する場合, OP は <tt>request_not_supported</tt> エラーを返すこと (MUST).

</p>
<p>
          <tt>request</tt> を利用する際には, JWT に含まれる OpenID Connect パラメータ値が OAuth 2.0 リクエストシンタックスで送信されるパラメータに取って代わる.
          しかしながら, Request Object を利用する場合にでも, パラメータを OAuth 2.0 リクエストシンタックスでも送信することができる (MAY).
          こうすることで, キャッシュ可能で署名済 (および暗号化済) の Request Object 値に静的なリクエストパラメータを含め, リクエストごとに可変パラメータ (<tt>state</tt>, <tt>nonce</tt> 等) を OAuth 2.0 パラメータとして送信することなどが可能になる.

</p>
<p>
          リクエスト自体を有効な OAuth 2.0 Authorization Request とするため, <tt>response_type</tt> および <tt>client_id</tt> パラメータは OAuth 2.0 リクエストシンタックスでリクエストに含まねばならない (MUST).
          これは OAuth 2.0 で必須とされている (REQUIRED).
          もし Request Object にもこれらと同じパラメータが含まれている場合は, 2つのパラメータは一致しなければならない (MUST).

</p>
<p>
          <tt>scope</tt> パラメータが Request Object に含まれる場合でも, <tt>scope</tt> パラメータは OAuth 2.0 リクエストシンタックスで <tt>openid</tt> scope を含んだ形で送信しなければならない (MUST).
          これにより下位レイヤーの OAuth 2.0 処理系に, 当該リクエストが OpenID Connect リクエストであることを明示することができる.

</p>
<p>
          Request Object は, 署名付きでも良いし, 署名無しの平文ても良い.
          平文の場合, JWS ヘッダーに <tt>none</tt> アルゴリズム (<a class='info' href='#JWA'>[JWA]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; November&nbsp;2013.</span><span>)</span></a> 参照) を指定すること.
          署名付きの場合, Request Object は <tt>iss</tt> (issuer) および <tt>aud</tt> (audience) を含むべきである (SHOULD).
          RP 以外の主体に署名されているのでない限り, <tt>iss</tt> 値は RP の Client ID とすべきである (SHOULD).
          <tt>aud</tt> 値には OP の Issuer Identifier URL を含めるべきである (SHOULD).

</p>
<p>
          Request Object は <a class='info' href='#JWE'>JWE<span> (</span><span class='info'>Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;JSON Web Encryption (JWE),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWE] を用いて暗号化することもできる (MAY).
          また署名無しで暗号化のみを適用することもできる (MAY).
          署名と暗号化を同時に利用する場合は, 署名後に暗号化すること (MUST).
          これは Nested JWT となる (<a class='info' href='#JWT'>[JWT]<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token (JWT),&rdquo; November&nbsp;2013.</span><span>)</span></a> 参照).

</p>
<p>
          <tt>request</tt> および <tt>request_uri</tt> パラメータは, Request Object 中に含んではならない (MUST NOT).

</p>
<p>

<p>
              以下は Base64URL エンコードと署名を施す前段階の, Request Object 中の Claim の例である.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "iss": "s6BhdRkqt3",
   "aud": "https://server.example.com",
   "response_type": "code id_token",
   "client_id": "s6BhdRkqt3",
   "redirect_uri": "https://client.example.org/cb",
   "scope": "openid",
   "state": "af0ifjsldkj",
   "nonce": "n-0S6_WzA2Mj",
   "max_age": 86400,
   "claims":
    {
     "userinfo":
      {
       "given_name": {"essential": true},
       "nickname": null,
       "email": {"essential": true},
       "email_verified": {"essential": true},
       "picture": null
      },
     "id_token":
      {
       "gender": null,
       "birthdate": {"essential": true},
       "acr": {"values": ["urn:mace:incommon:iap:silver"]}
      }
    }
  }
</pre></div>

<p>
              <tt>RS256</tt> アルゴリズムで上記 Request Object に署名した結果の Request Object 値は以下のようになる.
              (改行は掲載上の都合による)

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  eyJhbGciOiJSUzI1NiIsImtpZCI6ImsyYmRjIn0.ew0KICJpc3MiOiAiczZCaGRSa3
  F0MyIsDQogImF1ZCI6ICJodHRwczovL3NlcnZlci5leGFtcGxlLmNvbSIsDQogInJl
  c3BvbnNlX3R5cGUiOiAiY29kZSBpZF90b2tlbiIsDQogImNsaWVudF9pZCI6ICJzNk
  JoZFJrcXQzIiwNCiAicmVkaXJlY3RfdXJpIjogImh0dHBzOi8vY2xpZW50LmV4YW1w
  bGUub3JnL2NiIiwNCiAic2NvcGUiOiAib3BlbmlkIiwNCiAic3RhdGUiOiAiYWYwaW
  Zqc2xka2oiLA0KICJub25jZSI6ICJuLTBTNl9XekEyTWoiLA0KICJtYXhfYWdlIjog
  ODY0MDAsDQogImNsYWltcyI6IA0KICB7DQogICAidXNlcmluZm8iOiANCiAgICB7DQ
  ogICAgICJnaXZlbl9uYW1lIjogeyJlc3NlbnRpYWwiOiB0cnVlfSwNCiAgICAgIm5p
  Y2tuYW1lIjogbnVsbCwNCiAgICAgImVtYWlsIjogeyJlc3NlbnRpYWwiOiB0cnVlfS
  wNCiAgICAgImVtYWlsX3ZlcmlmaWVkIjogeyJlc3NlbnRpYWwiOiB0cnVlfSwNCiAg
  ICAgInBpY3R1cmUiOiBudWxsDQogICAgfSwNCiAgICJpZF90b2tlbiI6IA0KICAgIH
  sNCiAgICAgImdlbmRlciI6IG51bGwsDQogICAgICJiaXJ0aGRhdGUiOiB7ImVzc2Vu
  dGlhbCI6IHRydWV9LA0KICAgICAiYWNyIjogeyJ2YWx1ZXMiOiBbInVybjptYWNlOm
  luY29tbW9uOmlhcDpzaWx2ZXIiXX0NCiAgICB9DQogIH0NCn0.nwwnNsk1-Zkbmnvs
  F6zTHm8CHERFMGQPhos-EJcaH4Hh-sMgk8ePrGhw_trPYs8KQxsn6R9Emo_wHwajyF
  KzuMXZFSZ3p6Mb8dkxtVyjoy2GIzvuJT_u7PkY2t8QU9hjBcHs68PkgjDVTrG1uRTx
  0GxFbuPbj96tVuj11pTnmFCUR6IEOXKYr7iGOCRB3btfJhM0_AKQUfqKnRlrRscc8K
  ol-cSLWoYE9l5QqholImzjT_cMnNIznW9E7CDyWXTsO70xnB4SkG6pXfLSjLLlxmPG
  iyon_-Te111V8uE83IlzCYIb_NMXvtTIVc1jpspnTSD7xMbpL-2QgwUsAlMGzw
</pre></div>

<p>
              以下の JWK フォーマットで表現された RSA 公開鍵で, 上記 Request Object の署名検証を行える.
              以降の Request Object 署名例でも, 同じ鍵を用いる.
              (改行は掲載上の都合による)

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "kty":"RSA",
   "kid":"k2bdc",
   "n":"y9Lqv4fCp6Ei-u2-ZCKq83YvbFEk6JMs_pSj76eMkddWRuWX2aBKGHAtKlE5P
        7_vn__PCKZWePt3vGkB6ePgzAFu08NmKemwE5bQI0e6kIChtt_6KzT5OaaXDF
        I6qCLJmk51Cc4VYFaxgqevMncYrzaW_50mZ1yGSFIQzLYP8bijAHGVjdEFgZa
        ZEN9lsn_GdWLaJpHrB3ROlS50E45wxrlg9xMncVb8qDPuXZarvghLL0HzOuYR
        adBJVoWZowDNTpKpk2RklZ7QaBO7XDv3uR7s_sf2g-bAjSYxYUGsqkNA9b3xV
        W53am_UZZ3tZbFTIh557JICWKHlWj5uzeJXaw",
   "e":"AQAB"
  }
</pre></div>



<a name="RequestParameter"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.1"></a><h3>6.1.1.&nbsp;
Request using the "request" Request Parameter</h3>

<p>
            Client は Authorization Request を Authorization Endpoint に送信する.

</p>
<p>

<p>
                以下は <tt>request</tt> パラメータを使った Authorization Request の例である.
                (改行は掲載上の都合による)

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  https://server.example.com/authorize?
    response_type=code%20id_token
    &amp;client_id=s6BhdRkqt3
    &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &amp;scope=openid
    &amp;state=af0ifjsldkj
    &amp;nonce=n-0S6_WzA2Mj
    &amp;request=eyJhbGciOiJSUzI1NiIsImtpZCI6ImsyYmRjIn0.ew0KICJpc3MiOiA
    iczZCaGRSa3F0MyIsDQogImF1ZCI6ICJodHRwczovL3NlcnZlci5leGFtcGxlLmN
    vbSIsDQogInJlc3BvbnNlX3R5cGUiOiAiY29kZSBpZF90b2tlbiIsDQogImNsaWV
    udF9pZCI6ICJzNkJoZFJrcXQzIiwNCiAicmVkaXJlY3RfdXJpIjogImh0dHBzOi8
    vY2xpZW50LmV4YW1wbGUub3JnL2NiIiwNCiAic2NvcGUiOiAib3BlbmlkIiwNCiA
    ic3RhdGUiOiAiYWYwaWZqc2xka2oiLA0KICJub25jZSI6ICJuLTBTNl9XekEyTWo
    iLA0KICJtYXhfYWdlIjogODY0MDAsDQogImNsYWltcyI6IA0KICB7DQogICAidXN
    lcmluZm8iOiANCiAgICB7DQogICAgICJnaXZlbl9uYW1lIjogeyJlc3NlbnRpYWw
    iOiB0cnVlfSwNCiAgICAgIm5pY2tuYW1lIjogbnVsbCwNCiAgICAgImVtYWlsIjo
    geyJlc3NlbnRpYWwiOiB0cnVlfSwNCiAgICAgImVtYWlsX3ZlcmlmaWVkIjogeyJ
    lc3NlbnRpYWwiOiB0cnVlfSwNCiAgICAgInBpY3R1cmUiOiBudWxsDQogICAgfSw
    NCiAgICJpZF90b2tlbiI6IA0KICAgIHsNCiAgICAgImdlbmRlciI6IG51bGwsDQo
    gICAgICJiaXJ0aGRhdGUiOiB7ImVzc2VudGlhbCI6IHRydWV9LA0KICAgICAiYWN
    yIjogeyJ2YWx1ZXMiOiBbInVybjptYWNlOmluY29tbW9uOmlhcDpzaWx2ZXIiXX0
    NCiAgICB9DQogIH0NCn0.nwwnNsk1-ZkbmnvsF6zTHm8CHERFMGQPhos-EJcaH4H
    h-sMgk8ePrGhw_trPYs8KQxsn6R9Emo_wHwajyFKzuMXZFSZ3p6Mb8dkxtVyjoy2
    GIzvuJT_u7PkY2t8QU9hjBcHs68PkgjDVTrG1uRTx0GxFbuPbj96tVuj11pTnmFC
    UR6IEOXKYr7iGOCRB3btfJhM0_AKQUfqKnRlrRscc8Kol-cSLWoYE9l5QqholImz
    jT_cMnNIznW9E7CDyWXTsO70xnB4SkG6pXfLSjLLlxmPGiyon_-Te111V8uE83Il
    zCYIb_NMXvtTIVc1jpspnTSD7xMbpL-2QgwUsAlMGzw
</pre></div>


<a name="RequestUriParameter"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Passing a Request Object by Reference</h3>

<p>
          <tt>request_uri</tt> Authorization Request パラメータにより, OpenID Connect リクエストを参照渡し可能になる.
          このパラメータは, Request Object そのものが値として渡されるのではなく, Request Object が指定された URL から取得されるという点以外は, <tt>request</tt> パラメータと同等である.

</p>
<p>
          Discovery 結果の <tt>request_uri_parameter_supported</tt> により, OP がこのパラメータをサポートしていることを知ることができる.
          OP がこのパラメータをサポートしていないにも関わらず RP がこれを利用する場合, OP は <tt>request_uri_not_supported</tt> エラーを返すこと (MUST).

</p>
<p>
          <tt>request_uri</tt> パラメータを利用する際には, 参照先の JWT に含まれる OpenID Connect パラメータ値が OAuth 2.0 リクエストシンタックスで送信されるパラメータに取って代わる.
          しかしながら, <tt>request_uri</tt> を利用する場合にでも, パラメータを OAuth 2.0 リクエストシンタックスでも送信することができる (MAY).
          こうすることで, キャッシュ可能で署名済 (および暗号化済) の Request Object 値に静的なリクエストパラメータを含め, リクエストごとに可変パラメータ (<tt>state</tt> , <tt>nonce</tt> 等) を OAuth 2.0 パラメータとして送信することなどが可能になる.

</p>
<p>
          リクエスト自体を有効な OAuth 2.0 Authorization Request とするため, <tt>response_type</tt> および <tt>client_id</tt> パラメータは OAuth 2.0 リクエストシンタックスでリクエストに含まねばならない (MUST).
          これは OAuth 2.0 で必須とされている (REQUIRED).
          もし Request Object にもこれらと同じパラメータが含まれている場合は, 2つのパラメータは一致しなければならない (MUST).

</p>
<p>
          <tt>scope</tt> パラメータが Request Object に含まれる場合でも, <tt>scope</tt> パラメータは OAuth 2.0 リクエストシンタックスで <tt>openid</tt> scope を含んだ形で送信しなければならない (MUST).
          これにより下位レイヤーの OAuth 2.0 処理系に, 当該リクエストが OpenID Connect リクエストであることを明示することができる.

</p>
<p>
          サーバーは Request URI 参照先のコンテンツをキャッシュしても良い (MAY).
          もし参照先のリソースが可変の場合は, URI フラグメントとしてコンテンツの SHA-256 ハッシュの Base64URL エンコード値を含めるべきである (SHOULD).
          もし URI フラグメント値が変わった場合は, 古いフラグメント値を含む URI に紐づいたキャッシュ値はもはや有効でない.

</p>
<p>
          Client が <a class='info' href='#OpenID.Registration'>OpenID Connect Dynamic Client Registration 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client Registration 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OpenID.Registration] Section 2.1 で定義される <tt>request_uris</tt> パラメータを用いて <tt>request_uri</tt> を事前登録することも可能である (MAY).
          OP は, 事前登録済の <tt>request_uri</tt> 値以外の利用を許可しないということを, <tt>require_request_uri_registration</tt> ディスカバリパラメータで示すことができる.

</p>
<p>
          Request URI は全体で 512 ASCII 文字を超えてはならない (MUST NOT).

</p>
<p>
          URL 参照先のリソースは, Request Object でなければならない (MUST).
          Request Object が Authorization Server に検証可能な方法で署名されていない限り, <tt>request_uri</tt> のスキーマは <tt>https</tt> でなければならない (MUST).
          <tt>request_uri</tt> 値は Authorization Server が到達可能でなければならず (MUST), Client にも到達可能であるべきである (SHOULD).

</p>
<p>

<p>
              以下は <tt>request_uri</tt> 参照先の Request Object の例である.
              (改行は掲載上の都合による)

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  eyJhbGciOiJSUzI1NiIsImtpZCI6ImsyYmRjIn0.ew0KICJpc3MiOiAiczZCaGRSa3
  F0MyIsDQogImF1ZCI6ICJodHRwczovL3NlcnZlci5leGFtcGxlLmNvbSIsDQogInJl
  c3BvbnNlX3R5cGUiOiAiY29kZSBpZF90b2tlbiIsDQogImNsaWVudF9pZCI6ICJzNk
  JoZFJrcXQzIiwNCiAicmVkaXJlY3RfdXJpIjogImh0dHBzOi8vY2xpZW50LmV4YW1w
  bGUub3JnL2NiIiwNCiAic2NvcGUiOiAib3BlbmlkIiwNCiAic3RhdGUiOiAiYWYwaW
  Zqc2xka2oiLA0KICJub25jZSI6ICJuLTBTNl9XekEyTWoiLA0KICJtYXhfYWdlIjog
  ODY0MDAsDQogImNsYWltcyI6IA0KICB7DQogICAidXNlcmluZm8iOiANCiAgICB7DQ
  ogICAgICJnaXZlbl9uYW1lIjogeyJlc3NlbnRpYWwiOiB0cnVlfSwNCiAgICAgIm5p
  Y2tuYW1lIjogbnVsbCwNCiAgICAgImVtYWlsIjogeyJlc3NlbnRpYWwiOiB0cnVlfS
  wNCiAgICAgImVtYWlsX3ZlcmlmaWVkIjogeyJlc3NlbnRpYWwiOiB0cnVlfSwNCiAg
  ICAgInBpY3R1cmUiOiBudWxsDQogICAgfSwNCiAgICJpZF90b2tlbiI6IA0KICAgIH
  sNCiAgICAgImdlbmRlciI6IG51bGwsDQogICAgICJiaXJ0aGRhdGUiOiB7ImVzc2Vu
  dGlhbCI6IHRydWV9LA0KICAgICAiYWNyIjogeyJ2YWx1ZXMiOiBbInVybjptYWNlOm
  luY29tbW9uOmlhcDpzaWx2ZXIiXX0NCiAgICB9DQogIH0NCn0.nwwnNsk1-Zkbmnvs
  F6zTHm8CHERFMGQPhos-EJcaH4Hh-sMgk8ePrGhw_trPYs8KQxsn6R9Emo_wHwajyF
  KzuMXZFSZ3p6Mb8dkxtVyjoy2GIzvuJT_u7PkY2t8QU9hjBcHs68PkgjDVTrG1uRTx
  0GxFbuPbj96tVuj11pTnmFCUR6IEOXKYr7iGOCRB3btfJhM0_AKQUfqKnRlrRscc8K
  ol-cSLWoYE9l5QqholImzjT_cMnNIznW9E7CDyWXTsO70xnB4SkG6pXfLSjLLlxmPG
  iyon_-Te111V8uE83IlzCYIb_NMXvtTIVc1jpspnTSD7xMbpL-2QgwUsAlMGzw
</pre></div>


<a name="CreateRequestUri"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.1"></a><h3>6.2.1.&nbsp;
URL Referencing the Request Object</h3>

<p>
            Client は Request Object をローカルもしくはリモートの Server にアクセス可能な URL に配置する.
            この URI が Request URI (<tt>request_uri</tt>) である.

</p>
<p>
            Request Object が Claim リクエストを含む場合, その Request Object は Authorization Server 以外の何者にも知られてはならない (MUST NOT).
            例えば, <tt>request_uri</tt> はそのライフタイムに応じて適切なエントロピーを持っていなければならない (MUST).
            再び利用することの無いのが明らかな場合や適切なタイムアウト後には, そのコンテンツを削除することが推奨される (RECOMMENDED).
            ただしなんらかのアクセスコントロールが実施されている場合はその限りではない.

</p>
<p>
              以下は Request URI 値の例である.
              (改行は掲載上の都合による)

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  https://client.example.org/request.jwt#
    GkurKxf5T0Y-mnPFCHqWOMiZi4VS138cQO_V7PZHAdM
</pre></div>
<a name="UseRequestUri"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.2"></a><h3>6.2.2.&nbsp;
Request using the "request_uri" Request Parameter</h3>

<p>
            Client は Authorization Request を Authorization Endpoint に送信する.

</p>
<p>
              以下は <tt>request_uri</tt> パラメータを使った Authorization Request の例である.
              (改行は掲載上の都合による)

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  https://server.example.com/authorize?
    response_type=code%20id_token
    &amp;client_id=s6BhdRkqt3
    &amp;request_uri=https%3A%2F%2Fclient.example.org%2Frequest.jwt
    %23GkurKxf5T0Y-mnPFCHqWOMiZi4VS138cQO_V7PZHAdM
    &amp;state=af0ifjsldkj&amp;nonce=n-0S6_WzA2Mj
    &amp;scope=openid
</pre></div>
<a name="GetRequestUri"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.3"></a><h3>6.2.3.&nbsp;
Authorization Server Fetches Request Object</h3>

<p>
            Request を受けると, Authorization Server は参照先の Request Object を取得するため, <tt>request_uri</tt> に HTTP <tt>GET</tt> リクエストを送らなければならない (MUST).
            ただし Request Object がキャッシュ済の場合を除く.
            Request Object を取得すると, Authorization Server は Authorization Request を取得するため Request Object をパースする.

</p>
<p>
            RP はリクエストごとに異なるパラメータを用いる場合は, リクエストごとにユニークな URI を用いるべきである (SHOULD).
            もしくは Authorization Server が <tt>request_uri</tt> 参照先のコンテンツをキャッシュするのを防ぐこと.

</p>
<p>
              以下は Request Object フェッチ例である.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /request.jwt HTTP/1.1
  Host: client.example.org
</pre></div>
<a name="RequestUriRationale"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.4"></a><h3>6.2.4.&nbsp;
&quot;request_uri&quot; Rationale</h3>

<p>
            <tt>request_uri</tt> を利用する理由はいくつか挙げられる.

</p>
<p>
            </p>
<ol class="text">
<li>
                リクエストパラメータセットが長大になり, ブラウザの URI 長制限を超える.
                リクエストパラメータを参照渡しすることで, この問題を回避できる.

</li>
<li>
                リクエスト全体を値として渡すより, <tt>request_uri</tt> を渡す方がリクエストレイテンシを抑えることができる.

</li>
<li>
                RP が送ってくる Claim は, 基本的に不変である.
                <tt>request_uri</tt> は, 事前に不変のリクエストパラメータセットを用意しておき, 時には事前に署名や暗号化を施しておくことを可能にする.
                (<tt>request_uri</tt> 値は, 特定の不変なリクエストパラメータに対する "artifact" となる)

</li>
<li>
                Registration 時に不変なリクエストパラメータを事前登録しておくことで, OP は Registration 時にリクエストパラメータを事前に検証済にした状態でキャッシュすることができる.
                これにより, OP はリクエストを受け取った際にコンテンツを取得しにいく必要がなくなる.

</li>
<li>
                Registration 時に不変なリクエストパラメータを事前登録しておくことで, OP は顧客保護などの視点から送られてくるであろうリクエストの事前審査を行うことができる.
                事前審査を行う主体は, OP 自身なこともあれば, サードパーティであることもあろう.

</li>
</ol><p>

</p>
<a name="JWTRequestValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Validating JWT-Based Requests</h3>

<p>
          <tt>request</tt> ないしは <tt>request_uri</tt> Authorization Request パラメータを利用する場合, Authentication Request の検証には <a class='info' href='#AuthRequestValidation'>3.1.2.2<span> (</span><span class='info'>Authentication Request Validation</span><span>)</span></a>, <a class='info' href='#ImplicitValidation'>3.2.2.2<span> (</span><span class='info'>Authentication Request Validation</span><span>)</span></a> および <a class='info' href='#HybridValidation'>3.3.2.2<span> (</span><span class='info'>Authentication Request Validation</span><span>)</span></a> に加えて更なるステップが必要となる.
          このステップとは, Request Object を含む JWT の検証と, Request Object 自体の検証である.

</p>
<a name="EncryptedRequestObject"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3.1"></a><h3>6.3.1.&nbsp;
Encrypted Request Object</h3>

<p>
            もし Authorization Server が Discovery ドキュメント <a class='info' href='#OpenID.Discovery'>[OpenID.Discovery]<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., and E. Jay, &ldquo;OpenID Connect Discovery 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> 中の <tt>request_object_encryption_alg_values_supported</tt> と <tt>request_object_encryption_enc_values_supported</tt> で JWE 暗号化アルゴリズムを公表している場合, またはその他の手段により暗号かアルゴリズムを明らかにしている場合, Client はそれらのアルゴリズムを利用して JWT を暗号化する.

</p>
<p>
            Authorization Server は <a class='info' href='#JWE'>JSON Web Encryption<span> (</span><span class='info'>Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;JSON Web Encryption (JWE),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWE] の仕様に従って JWT を複合しなければならない (MUST).
            Request Object は署名されているかもしれず, 署名無しの平文かもしれない (MAY).
            前者の場合, 署名検証は <a class='info' href='#SignedRequestObject'>Section&nbsp;6.3.2<span> (</span><span class='info'>Signed Request Object</span><span>)</span></a> に従うこと (MUST).

</p>
<p>
            複合に失敗した場合, Authorization Server はエラーを返さねばならない (MUST).

</p>
<a name="SignedRequestObject"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3.2"></a><h3>6.3.2.&nbsp;
Signed Request Object</h3>

<p>
            署名検証を行うには, JWS ヘッダーの <tt>alg</tt> パラメータが Client Registration 時の <tt>request_object_signing_alg</tt>, もしくはその他の手段により事前登録された値と一致しなければならない (MUST).
            署名は <tt>client_id</tt> とアルゴリズムに対して適切な鍵を用いて行わなければならない (MUST).

</p>
<p>
            署名検証に失敗した場合, Authorization Server はエラーを返さねばならない (MUST).

</p>
<a name="RequestParameterValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3.3"></a><h3>6.3.3.&nbsp;
Request Parameter Assembly and Validation</h3>

<p>
            Authorization Server は, Request Object 値と OAuth 2.0 Authorization Request パラメータから (<tt>request</tt> と <tt>request_uri</tt> を除いて) Authorization Request パラメータを集約しなければならない (MUST).
            Request Object と OAuth Authorization Request パラメータに同じパラメータが含まれる場合, Request Object に含まれるパラメータを用いること.
            その後 Authorization Server は, 集約された Authorization Request パラメータを用いて, <a class='info' href='#AuthRequestValidation'>3.1.2.2<span> (</span><span class='info'>Authentication Request Validation</span><span>)</span></a>, <a class='info' href='#ImplicitValidation'>3.2.2.2<span> (</span><span class='info'>Authentication Request Validation</span><span>)</span></a> および <a class='info' href='#HybridValidation'>3.3.2.2<span> (</span><span class='info'>Authentication Request Validation</span><span>)</span></a> に従って, 利用されているフローに応じて通常通りリクエストを検証する.

</p>
<a name="SelfIssued"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Self-Issued OpenID Provider</h3>

<p>
        OpenID Connect は Self-Issued OpenID プロバイダー (私有の self-hosted な OpenID Provider であり, 自己署名つきの ID Token を発行するもの) をサポートしている. Self-Issued OP は <tt>https://self-issued.me</tt> という特別な Issuer 識別子を使用する.

</p>
<p>
        Self-Issued OP とのメッセージのやりとりは, 通常の OP の場合とほとんど同じである.
        ここでは Self-Issued のために追加されるパラメータ, およびパラメータ値を定義する.

</p>
<a name="SelfIssuedDiscovery"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Self-Issued OpenID Provider Discovery</h3>

<p>
          ディスカバリプロセスで入力された識別子が self-issued.me ドメインを含んでいた場合, ダイナミックディスカバリは実行されない.
          その代わりに以下の静的な設定値が使用される.

</p>
<p>
          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "authorization_endpoint":
     "openid:",
   "issuer":
     "https://self-issued.me",
   "scopes_supported":
     ["openid", "profile", "email", "address", "phone"],
   "response_types_supported":
     ["id_token"],
   "subject_types_supported":
     ["pairwise"],
   "id_token_signing_alg_values_supported":
     ["RS256"],
   "request_object_signing_alg_values_supported":
     ["none", "RS256"]
  }
</pre></div><p>


</p>
<p>
          注記: OpenID ファウンデーションは
          <tt>https://self-issued.me/</tt>
          という OpenID プロバイダーサイトを提供することを計画している.
          その場合は WebFinger サービスも提供され, ディスカバリを実行すると上記の静的なディスカバリ情報を返すため, RP は Self-Issued OP のディスカバリのために特別な処理を行う必要はない.
          このサイトは実験的に提供される予定である.
          プロダクション環境を実装する際は, OpenID ファウンデーションが当該サイトをプロダクション用途を想定して提供するまでその環境に依存すべきではない.

</p>
<a name="SelfIssuedRegistration"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Self-Issued OpenID Provider Registration</h3>

<p>
          Self-Issued OP を使う際は登録は必要ない.
          Client は登録しなくても OP に登録したかのように振る舞い, 以下の Client Registration Response を得る.

</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>client_id</dt>
<dd>
              Client の <tt>redirect_uri</tt> 値.

</dd>
<dt>client_secret_expires_at</dt>
<dd>
              0

</dd>
</dl></blockquote><p>

</p>
<p>
          注記: OpenID ファウンデーションは
          <tt>https://self-issued.me/registration/1.0/</tt>
          という (ステートレスな) エンドポイントを提供することを計画しており, そのエンドポイントは上記レスポンスを返すため, RP は Self-Issued OP の登録のために特別な処理を行う必要はない.
          このサイトは実験的に提供される予定である.
          プロダクション環境を実装する際は, OpenID ファウンデーションが当該サイトをプロダクション用途を想定して提供するまでその環境に依存すべきではない.

</p>
<a name="RegistrationParameter"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2.1"></a><h3>7.2.1.&nbsp;
Providing Information with the "registration" Request Parameter</h3>

<p>
            OpenID Connect は Client が Self-Issued OpenID プロバイダーに追加の登録情報を提供することが出来るようにするために以下の認可リクエストパラメータを定義している.


            </p>
<blockquote class="text"><dl>
<dt>registration</dt>
<dd>
                任意 (OPTIONAL).
                このパラメータは通常, Dynamic Client Registration の間に Client が自身の情報を Self-Issued OP に提供する際に利用される.
                この値は
                <a class='info' href='#OpenID.Registration'>OpenID Connect Dynamic Client Registration 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client Registration 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OpenID.Registration]
                仕様の Section 2.1 で定義されている Client メタデータの値を含む JSON オブジェクトである.
                <tt>registration</tt> パラメータは OP が Self-Issued OP ではないときは利用すべきではない (SHOULD NOT).

</dd>
</dl></blockquote><p>

</p>
<p>
            この情報の中で Self-Issued OP により必須 (REQUIRED) なものはなく, このパラメータの利用は任意 (OPTIONAL) である.

</p>
<p>
            <tt>registration</tt> パラメータの値は OAuth 2.0 リクエストの中で UTF-8 エンコードされた JSON として表わされる.
            (OAuth パラメータとして渡される際, form-urlencoded される).
            Request Object (<a class='info' href='#RequestObject'>Section&nbsp;6.1<span> (</span><span class='info'>Passing a Request Object by Value</span><span>)</span></a> 参照) 内で利用される場合, <tt>registration</tt> メンバーの値として JSON オブジェクトを指定する.

</p>
<p>
            Self-Issued OP へのリクエストの中で典型的に利用する登録パラメータは以下である.
            <tt>policy_uri</tt>,
            <tt>tos_uri</tt>, and
            <tt>logo_uri</tt>.
            Client が一つ以上の Redirection URI を使用する際, それらを登録するために
            <tt>redirect_uris</tt>
            パラメータを利用する.
            最後にもし Client が暗号化されたレスポンスをリクエストする場合は, 以下のパラメータを利用する.
            <tt>jwks_uri</tt>,
            <tt>id_token_encrypted_response_alg</tt>, and
            <tt>id_token_encrypted_response_enc</tt>.

</p>
<a name="SelfIssuedRequest"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Self-Issued OpenID Provider Request</h3>

<p>Client は Authorization Endpoint へ以下のパラメータを付けて Authentication Request を送信する.
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>scope</dt>
<dd>
              必須 (REQUIRED).
              <a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a> で定義されている <tt>scope</tt> パラメータの値.

</dd>
<dt>response_type</dt>
<dd>
              必須 (REQUIRED). 固定の文字列 <tt>id_token</tt>.

</dd>
<dt>client_id</dt>
<dd>
              必須 (REQUIRED).
              Client の Client ID, この場合は Client の
              <tt>redirect_uri</tt> の値を含む.
              Client の
              <tt>redirect_uri</tt> URI の値は Client ID として送信されるので,
              <tt>redirect_uri</tt> パラメータをリクエストの中に含む必要はない (NOT REQUIRED).

</dd>
<dt>id_token_hint</dt>
<dd>
              任意 (OPTIONAL).
              <a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a> で定義されている <tt>id_token_hint</tt> パラメータの値.
              Self-Issued OP に対して暗号化した ID Token を送信する場合, 署名付き ID Token の <tt>sub</tt> (subject) を JWE の <tt>kid</tt> (Key ID) として指定しなければならない (MUST).
              現状 Self-Issued OP に対して暗号化したコンテンツを送信できるのは, OP の JWK 鍵タイプが <tt>RSA</tt> であり, かつ暗号化アルゴリズムが <tt>RSA1_5</tt> である場合に限る.

</dd>
<dt>claims</dt>
<dd>
              任意 (OPTIONAL).
              <a class='info' href='#ClaimsParameter'>Section&nbsp;5.5<span> (</span><span class='info'>Requesting Claims using the &quot;claims&quot; Request Parameter</span><span>)</span></a> で定義されている <tt>claims</tt> パラメータの値.

</dd>
<dt>registration</dt>
<dd>
              任意 (OPTIONAL).
              このパラメータは, 通常 Dynamic Client Registration (<a class='info' href='#RegistrationParameter'>Section&nbsp;7.2.1<span> (</span><span class='info'>Providing Information with the &quot;registration&quot; Request Parameter</span><span>)</span></a> 参照) を通じて提供される Client 自身に関する情報を, Client が Self-Issued OP に提供する際に利用される.

</dd>
<dt>request</dt>
<dd>
              任意 (OPTIONAL).
              <a class='info' href='#RequestObject'>Section&nbsp;6.1<span> (</span><span class='info'>Passing a Request Object by Value</span><span>)</span></a> で定義されている Request Object 値.
              Client は, 暗号化した Request Object を Self-Issued OP に送信することもできる (MAY).
              その場合, その Client に対して既に発行済の ID Token の <tt>sub</tt> (subject) を JWE の <tt>kid</tt> (Key ID) として指定しなければならない (MUST).
              現状 Self-Issued OP に対して暗号化したコンテンツを送信できるのは, OP の JWK 鍵タイプが <tt>RSA</tt> であり, かつ暗号化アルゴリズムが <tt>RSA1_5</tt> である場合に限る.

</dd>
</dl></blockquote><p>

</p>
<p>
          他のパラメータも送ってもよい (MAY).
          すべての Claim は ID Token の中で返されることに留意すること.

</p>
<p>全体 URL 長は ASCII で 2048 文字を超えてはならない (MUST NOT).
</p>
<p>
            以下は, User Agent が Self-Issued OpenID プロバイダーに対して Authentication Request を生成するためのトリガーとなる, Client による HTTP 302 リダイレクトレスポンスの参考例である.
            (改行は掲載上の都合による)


</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 302 Found
  Location: openid://?
    response_type=id_token
    &amp;client_id=https%3A%2F%2Fclient.example.org%2Fcb
    &amp;scope=openid%20profile
    &amp;state=af0ifjsldkj
    &amp;nonce=n-0S6_WzA2Mj
    &amp;registration=%7B%22logo_uri%22%3A%22https%3A%2F%2F
      client.example.org%2Flogo.png%22%7D
</pre></div>
<a name="SelfIssuedResponse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
Self-Issued OpenID Provider Response</h3>

<p>
          OpenID Connect では Self-Issued OpenID Provider Responses で使うために以下の Claim を定義する.


          </p>
<blockquote class="text"><dl>
<dt>sub_jwk</dt>
<dd>
              必須 (REQUIRED).
              <a class='info' href='#SelfIssued'>Section&nbsp;7<span> (</span><span class='info'>Self-Issued OpenID Provider</span><span>)</span></a> で定義されるとおり, Self-Issued OpenID Provider から発行された ID Token の署名検証に使われる公開鍵.
              鍵は <a class='info' href='#JWK'>[JWK]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Key (JWK),&rdquo; November&nbsp;2013.</span><span>)</span></a> フォーマットのベア鍵である (X.509 証明書ではない).
              <tt>sub_jwk</tt> 値は JSON オブジェクトである.
              OP が Self-Issued でない場合はこの Claim の利用を推奨しない (NOT RECOMMENDED).


</dd>
</dl></blockquote><p>

</p>
<p>
          Self-Issued OpenID プロバイダーのレスポンスは, 通常の Implicit フローのレスポンスに以下の改変をしたものと同じである.
          Implicit フローのレスポンスなので, 異なる Response Mode が指定されていない限り, レスポンスパラメータは URL フラグメントコンポーネントの中で返される.

</p>
<p>
          </p>
<ol class="text">
<li>
              <tt>iss</tt> (issuer) Claim の値が
              <tt>https://self-issued.me</tt> である.

</li>
<li>
              <tt>sub_jwk</tt> Claim が存在し, その値が ID Token の署名を検証するための公開鍵となっている.

</li>
<li>
              <tt>sub</tt> (subject) Claim の値は
              <tt>sub_jwk</tt> Claim の中の Base64URL エンコードされたキー値の UTF-8 表現のオクテットを結合したものの SHA-256 ハッシュを Base64URL エンコードしたものである.
              <tt>kty</tt> の値が
              <tt>RSA</tt> である時, キーの値は
              <tt>n</tt> と,
              <tt>e</tt> が順に結合されたものである.
              <tt>kty</tt> の値が
              <tt>EC</tt> である時, キーの値は
              <tt>crv</tt> と,
              <tt>x</tt> と,
              <tt>y</tt> が順に結合されたものである.

</li>
<li>
              UserInfo エンドポイントへアクセスするための Access Token は返されないため,
              すべての Claim は ID Token の中で返されなければならない (MUST).

</li>
</ol><p>

</p>
<a name="SelfIssuedValidation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5"></a><h3>7.5.&nbsp;
Self-Issued ID Token Validation</h3>

<p>
          返された ID Token の検証を行うため, Client は以下のことを実施しなくてはならない (MUST).

</p>
<p>
          </p>
<ol class="text">
<li>
              Client は, <tt>iss</tt> (issuer) Claim の値が <tt>https://self-isued.me</tt> であることを検証しなければならない (MUST).
              もし <tt>iss</tt> が別の値を含んでいた場合,
              その ID Token は Self-Issued ではないので,
              <a class='info' href='#IDTokenValidation'>Section&nbsp;3.1.3.7<span> (</span><span class='info'>ID Token Validation</span><span>)</span></a>
              に沿って検証されなければならない (MUST).

</li>
<li>
              Client は, Client が認証リクエストで送信した <tt>redirect_uri</tt> の値が, <tt>aud</tt> Claim にオーディエンスとして含まれていることを検証しなければならない (MUST).

</li>
<li>
              Client は, JWT ヘッダ <a class='info' href='#JWT'>[JWT]<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token (JWT),&rdquo; November&nbsp;2013.</span><span>)</span></a> の <tt>alg</tt> パラメータに指定されたアルゴリズムを使い <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature (JWS),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWS] に沿って ID Token の署名を検証しなければならない (MUST).
              その際, <tt>sub_jwk</tt> Claim の中の鍵を使用する;
              鍵は JWK フォーマットの鍵である (X.509 証明書ではない).

</li>
<li>
              <tt>alg</tt> の値はデフォルトとしては <tt>RS256</tt> であるべきである (SHOULD).
              この値は <tt>ES256</tt> であってもよい (MAY).

</li>
<li>
              Client は <tt>sub</tt> (subject) Claim の値が
              Base64URL エンコードされた <tt>sub_jwk</tt> Claim の中のキーの値が Base64URL エンコードされた UTF-8 表現のオクテットを結合したものの SHA-256 ハッシュであることを検証しなくてはならない (MUST).
              <tt>kty</tt> の値が
              <tt>RSA</tt> である時, キーの値は
              <tt>n</tt> と
              <tt>e</tt> が順に結合されたものである.
              <tt>kty</tt> の値が
              <tt>EC</tt> である時, キーの値は
              <tt>crv</tt> と,
              <tt>x</tt> と,
              <tt>y</tt> が順に結合されたものである.

</li>
<li>
              現在時刻が <tt>exp</tt> Claim より前でなければならない (MUST).
              (時計のズレを考慮した多少の猶予は許容される)

</li>
<li>
              <tt>iat</tt> Claim が現在時刻からあまりにかけ離れている場合は, そのトークンを拒絶してもよい.
              これにより nonce の保存期間を制限することができる.
              適切な閾値は, Client ごとにことなる.

</li>
<li>
              nonce が Authentication Request で送られた場合,
              <tt>nonce</tt> Claim が存在し,
              その値は Authentication Request で送られたものと同じ値であることを検証されなくてはならない (MUST).
              Client はリプレイアタックを防ぐため <tt>nonce</tt> の値を検証すべきである (SHOULD).
              リプレイアタックを検知するための詳細は方法は Client ごとに固有である.

</li>
</ol><p>

</p>
<p>以下は Self-Issued ID Token を Base64URL デコードした参考例である.
          (改行は掲載上の都合による)
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "iss": "https://self-issued.me",
   "sub": "wBy8QvHbPzUnL0x63h13QqvUYcOur1X0cbQpPVRqX5k",
   "aud": "https://client.example.org/cb",
   "nonce": "n-0S6_WzA2Mj",
   "exp": 1311281970,
   "iat": 1311280970,
   "sub_jwk": {
     "kty":"RSA",
     "n": "0vx7agoebGcQSuuPiLJXZptN9nndrQmbXEps2aiAFbWhM78LhWx
     4cbbfAAtVT86zwu1RK7aPFFxuhDR1L6tSoc_BJECPebWKRXjBZCiFV4n3oknjhMs
     tn64tZ_2W-5JsGY4Hc5n9yBXArwl93lqt7_RN5w6Cf0h4QyQ5v-65YGjQR0_FDW2
     QvzqY368QQMicAtaSqzs8KJZgnYb9c7d0zgdAZHzu6qMQvRL5hajrn1n91CbOpbI
     SD08qNLyrdkt-bFTWhAI4vMQFh6WeZu0fM4lFd2NcRwr3XPksINHaQ-G_xBniIqb
     w0Ls1jF44-csFCur-kEgU8awapJzKnqDKgw",
     "e":"AQAB"
    }
  }
</pre></div>
<a name="SubjectIDTypes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Subject Identifier Types</h3>

<p>
        Subject Identifier は,
        Client によって利用されることを意図している,
        Issuer 内で一意な再割り当てされない End-User の識別子である.
        当仕様では, 2つの Subject Identifier タイプを定義している:

        </p>
<blockquote class="text"><dl>
<dt>public</dt>
<dd>
            全ての Client に対し同一の <tt>sub</tt> (subject) 値を提供する.
            これはプロバイダのディスカバリドキュメント内の
            <tt>subject_types_supported</tt> 要素が
            存在しない場合のデフォルトである.

</dd>
<dt>pairwise</dt>
<dd>
            各々の Client に対し異なる <tt>sub</tt> 値を提供する.
            そのためClient は, 許可なくして End-User の行動を集約して関連づけることが不可能となる.

</dd>
</dl></blockquote><p>

</p>
<p>
        OpenID Provider の Discovery ドキュメントには,
        サポートしている Subject Identifier のタイプのリストが
        <tt>subject_types_supported</tt>
        要素に記載されているべきである (SHOULD).
        一つ以上のタイプがリストされている場合,
        Client は Registration 時に
        <tt>subject_type</tt> パラメータを用いて,
        任意のタイプを選択してもよい (MAY).

</p>
<a name="PairwiseAlg"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Pairwise Identifier Algorithm</h3>

<p>
          pairwise Subject Identifier を使用する際,
          OpenID Provider は, 各々の Sector Identifier 毎に一意な
          <tt>sub</tt> (subject) 値を計算しなければならない (MUST).
          Subject Identifier 値は, OpenID Provider 以外の Party にとって,
          可逆であってはならない (MUST NOT).

</p>
<p>
          pairwise <tt>sub</tt> 値を使用し,
          かつ <a class='info' href='#OpenID.Registration'>Dynamic Client Registration<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client Registration 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OpenID.Registration]
          をサポートする Provider は,
          <tt>sector_identifier_uri</tt> パラメータを使用すべきである (SHOULD).
          これは, 共通の管理下にあるウェブサイト群に対し,
          個々のドメイン名とは独立して pairwise <tt>sub</tt> 値の
          一貫性を保持する手段を提供する.
          また, Client に対し,
          全ユーザを再登録させることなしに <tt>redirect_uri</tt> を変更する手段も提供する.

</p>
<p>
          Client が <a class='info' href='#OpenID.Registration'>Dynamic Client Registration<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client Registration 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OpenID.Registration] で
          <tt>sector_identifier_uri</tt> の値を提供しなかった場合,
          pairwise identifier の計算に用いる Sector Identifier は,
          登録された <tt>redirect_uri</tt> のホスト部である.
          登録された <tt>redirect_uris</tt> に複数のホスト名が存在した場合,
          Client は <tt>sector_identifier_uri</tt> を登録しなければならない (MUST).

</p>
<p>
          <tt>sector_identifier_uri</tt> が提供された場合,
          URL のホスト部が pairwise identifier の計算に用いる Sector Identifier として使用される.
          <tt>sector_identifier_uri</tt> の値は,
          <tt>redirect_uri</tt> 値の配列を含んだ
          JSONファイルを示す <tt>https</tt> スキームの URL でなければならない (MUST).
          登録された <tt>redirect_uris</tt> の値は,
          配列の要素に含まれていなければならない (MUST).

</p>
<p>
          OpenID Provider による pairwise Subject identifier の計算には,
          以下の特性を持つ任意のアルゴリズムを用いることが出来る:

          </p>
<ul class="text">
<li>
              Subject Identifier 値が, OpenID Provider 以外の Party にとって,
              可逆であってはならない (MUST NOT).

</li>
<li>
              異なる Sector Identifier 値は,
              異なる Subject Identifier 値にならなければならない (MUST).

</li>
<li>
              同じ入力に対して必ず同じ結果となる決定的アルゴリズムでなければならない (MUST).

</li>
</ul><p>

</p>
<p>
          3つの手法例を以下に示す:

          </p>
<ol class="text">
<li>
              Sector Identifierを, ローカルアカウントIDおよび Provider によって秘密にされているソルト値と連結する.
              そして連結した文字列を適切なアルゴリズムによってハッシュ化する.
              <br />
<br />

              <tt>sub</tt> = SHA-256 ( sector_identifier || local_account_id || salt ) を計算する.
              <br />
<br />


</li>
<li>
              Sector Identifierを, ローカルアカウントIDおよび Provider によって秘密にされているソルト値と連結する.
              そして連結した文字列を適切なアルゴリズムによって暗号化する.
              <br />
<br />

              <tt>sub</tt> = AES-128 ( sector_identifier || local_account_id || salt ) を計算する.
              <br />
<br />


</li>
<li>
              Issuer は, Sector Identifier とローカルアカウントIDのペアに対し, Globally Unique Identifier (GUID) を作成する.

</li>
</ol><p>

</p>
<a name="ClientAuthentication"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Client Authentication</h3>

<p>
        ここでは, Client が Token Endpoint にアクセスする際に, Authorization Server に対して自身を認証する Client Authentication 方法を定義する.
        Client Registration で RP (Client) は Client Authentication 方法を登録できる (MAY).
        もし認証方法が登録されていない場合, デフォルトで <tt>client_secret_basic</tt> を用いる.

</p>
<p>
        Client Authentication 方法は以下の通りである.

</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>client_secret_basic</dt>
<dd>
            Authorization Server から <tt>client_secret</tt> 値を受け取った Client は, <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] Section 3.2.1 に従い, HTTP Basic 認証スキーマを利用して Authorization Server に対して自身を認証する.


</dd>
<dt>client_secret_post</dt>
<dd>
            Authorization Server から <tt>client_secret</tt> 値を受け取った Client は, <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] Section 3.2.1 に従い, Client Credential をリクエストボディに含めて Authorization Server に対して自身を認証する.


</dd>
<dt>client_secret_jwt</dt>
<dd>
            Authorization Server から <tt>client_secret</tt> 値を受け取った Client は, HMAC SHA-256 等の HMAC SHA アルゴリズムを利用して JWT を生成する.
            HMAC (Hash-based Message Authentication Code) は, <tt>client_secret</tt> の UTF-8 オクテットを共通鍵として利用して計算される.


</dd>
<dt></dt>
<dd>
            Client は <a class='info' href='#OAuth.JWT'>JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants<span> (</span><span class='info'>Jones, M., Campbell, B., and C. Mortimore, &ldquo;JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.JWT] および <a class='info' href='#OAuth.Assertions'>Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants<span> (</span><span class='info'>Campbell, B., Mortimore, C., Jones, M., and Y. Goland, &ldquo;Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.Assertions] に従い認証を行う.
            JWT は以下の必須 (REQUIRED) の Claim Value を含まねばならず (MUST), 任意 (OPTIONAL) な Claim Value を含んでもよい (MAY).


</dd>
<dt></dt>
<dd>

<blockquote class="text"><dl>
<dt>iss</dt>
<dd>
                必須 (REQUIRED).
                Issuer.
                OAuth Client の <tt>client_id</tt> を含まねばならない (MUST).


</dd>
<dt>sub</dt>
<dd>
                必須 (REQUIRED).
                Subject.
                OAuth Client の <tt>client_id</tt> を含まねばならない (MUST).


</dd>
<dt>aud</dt>
<dd>
                必須 (REQUIRED).
                Audience.
                <tt>aud</tt> (audience) Claim.
                Authorization Serve をオーディエンスとして指定する.
                Authorization Server は自身がオーディエンスに含まれることを検証しなければならない (MUST).
                Audience は Authorization Server の Token Endpoint URL にすべきである (SHOULD).


</dd>
<dt>jti</dt>
<dd>
                必須 (REQUIRED).
                JWT ID.
                トークンごとにユニークな識別子.
                トークンの再利用を防ぐために利用される.
                これらのトークンは, 再利用条件について関係者での合意を得られていない限り, 2度以上利用しないようにしなければならない (MUST).
                そのような合意の詳細については本仕様の定めるところではない.


</dd>
<dt>exp</dt>
<dd>
                必須 (REQUIRED).
                ID Token の有効期限.
                この時刻を超えて当該 ID Token を受理してはならない (MUST NOT).


</dd>
<dt>iat</dt>
<dd>
                任意 (OPTIONAL).
                JWT 発行時刻.


</dd>
</dl></blockquote>

</dd>
<dt></dt>
<dd>
            この JWT には, 他の Claim を含めても良い (MAY).
            理解できない Claim は無視すること (MUST).

</dd>
<dt></dt>
<dd>
            認証トークンは <a class='info' href='#OAuth.Assertions'>[OAuth.Assertions]<span> (</span><span class='info'>Campbell, B., Mortimore, C., Jones, M., and Y. Goland, &ldquo;Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants,&rdquo; December&nbsp;2013.</span><span>)</span></a> の <tt>client_assertion</tt> パラメータとして送信すること (MUST).

</dd>
<dt></dt>
<dd>
            <a class='info' href='#OAuth.Assertions'>[OAuth.Assertions]<span> (</span><span class='info'>Campbell, B., Mortimore, C., Jones, M., and Y. Goland, &ldquo;Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants,&rdquo; December&nbsp;2013.</span><span>)</span></a> の <tt>client_assertion_type</tt> パラメータには, <a class='info' href='#OAuth.JWT'>[OAuth.JWT]<span> (</span><span class='info'>Jones, M., Campbell, B., and C. Mortimore, &ldquo;JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants,&rdquo; December&nbsp;2013.</span><span>)</span></a> の通りに "urn:ietf:params:oauth:client-assertion-type:jwt-bearer" とすること.

</dd>
<dt>private_key_jwt</dt>
<dd>
            公開鍵を登録済の Client は, そのペアとなる秘密鍵で JWT に署名を行っても良い.
            Client は <a class='info' href='#OAuth.JWT'>JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants<span> (</span><span class='info'>Jones, M., Campbell, B., and C. Mortimore, &ldquo;JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.JWT] および <a class='info' href='#OAuth.Assertions'>Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants<span> (</span><span class='info'>Campbell, B., Mortimore, C., Jones, M., and Y. Goland, &ldquo;Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.Assertions] に従い認証すること.
            JWT は以下の必須 (REQUIRED) の Claim Value を含まねばならず (MUST), 任意 (OPTIONAL) な Claim Value を含んでもよい (MAY).


</dd>
<dt></dt>
<dd>

<blockquote class="text"><dl>
<dt>iss</dt>
<dd>
                必須 (REQUIRED).
                Issuer.
                OAuth Client の <tt>client_id</tt> を含まねばならない (MUST).


</dd>
<dt>sub</dt>
<dd>
                必須 (REQUIRED).
                Subject.
                OAuth Client の <tt>client_id</tt> を含まねばならない (MUST).


</dd>
<dt>aud</dt>
<dd>
                必須 (REQUIRED).
                Audience.
                <tt>aud</tt> (audience) Claim.
                Authorization Serve をオーディエンスとして指定する.
                Authorization Server は自身がオーディエンスに含まれることを検証しなければならない (MUST).
                Audience は Authorization Server の Token Endpoint URL にすべきである (SHOULD).


</dd>
<dt>jti</dt>
<dd>
                必須 (REQUIRED).
                JWT ID.
                トークンごとにユニークな識別子.
                トークンの再利用を防ぐために利用される.
                これらのトークンは, 再利用条件について関係者での合意を得られていない限り, 2度以上利用しないようにしなければならない (MUST).
                そのような合意の詳細については本仕様の定めるところではない.


</dd>
<dt>exp</dt>
<dd>
                必須 (REQUIRED).
                ID Token の有効期限.
                この時刻を超えて当該 ID Token を受理してはならない (MUST NOT).


</dd>
<dt>iat</dt>
<dd>
                任意 (OPTIONAL).
                JWT 発行時刻.


</dd>
</dl></blockquote>

</dd>
<dt></dt>
<dd>
            この JWT には, 他の Claim を含めても良い (MAY).
            理解できない Claim は無視すること (MUST).

</dd>
<dt></dt>
<dd>
            認証トークンは <a class='info' href='#OAuth.Assertions'>[OAuth.Assertions]<span> (</span><span class='info'>Campbell, B., Mortimore, C., Jones, M., and Y. Goland, &ldquo;Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants,&rdquo; December&nbsp;2013.</span><span>)</span></a> の <tt>client_assertion</tt> パラメータとして送信すること (MUST).

</dd>
<dt></dt>
<dd>
            <a class='info' href='#OAuth.Assertions'>[OAuth.Assertions]<span> (</span><span class='info'>Campbell, B., Mortimore, C., Jones, M., and Y. Goland, &ldquo;Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants,&rdquo; December&nbsp;2013.</span><span>)</span></a> の <tt>client_assertion_type</tt> パラメータには, <a class='info' href='#OAuth.JWT'>[OAuth.JWT]<span> (</span><span class='info'>Jones, M., Campbell, B., and C. Mortimore, &ldquo;JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants,&rdquo; December&nbsp;2013.</span><span>)</span></a> の通りに "urn:ietf:params:oauth:client-assertion-type:jwt-bearer" とすること.

</dd>
<dt></dt>
<dd>

<p>
                以下に例を示す.
                (改行は掲載上の都合による)

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded

  grant_type=authorization_code&amp;
    code=i1WsRn1uB1&amp;
    client_id=s6BhdRkqt3&amp;
    client_assertion_type=
    urn%3Aietf%3Aparams%3Aoauth%3Aclient-assertion-type%3Ajwt-bearer&amp;
    client_assertion=PHNhbWxwOl ... ZT
</pre></div>

</dd>
<dt>none</dt>
<dd>
            Client は Token Endpoint での認証を行わない.
            これには, Implicit Flow を使う (よって Token Endpoint 自体を利用しない) 場合と, Token Endpoint は利用するが Client Secret を持たない Public Client である場合, およびその他の何らかの認証手段を用いる場合がある.


</dd>
</dl></blockquote><p>

</p>
<a name="SigEnc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Signatures and Encryption</h3>

<p>
        メッセージ送信経路によって, メッセージの完全性は保証されないこともあり, メッセージ送信者の認証も行われないこともある.
        これらのリスクを軽減するため, ID Token, UserInfo Response, Request Object および Client Authentication JWT は <a class='info' href='#JWS'>JSON Web Signature (JWS)<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature (JWS),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWS] によってそのコンテンツに対して署名することができる.
        メッセージ秘匿性を得るには, <a class='info' href='#JWE'>JSON Web Encryption (JWE)<span> (</span><span class='info'>Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;JSON Web Encryption (JWE),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWE] を用いてコンテンツを暗号化する.

</p>
<p>
        メッセージに署名と暗号化双方を適用する場合, <a class='info' href='#SigningOrder'>Section&nbsp;16.14<span> (</span><span class='info'>Signing and Encryption Order</span><span>)</span></a> に従い, まず先に署名を行いその後暗号化すること (MUST).
        結果はネストした JWT になる (<a class='info' href='#JWT'>[JWT]<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token (JWT),&rdquo; November&nbsp;2013.</span><span>)</span></a> 参照).
        JWE の暗号手法は全て完全性チェックを含むことに注意すること.

</p>
<p>
        OP は自身がサポートする署名および暗号化アルゴリズムを Discovery ドキュメント中で示すか, その他の方法でそれらを告知しても良い.
        RP は自身が要求する署名および暗号化アルゴリズムを Dynamic Registration リクエスト中に指定するか, その他の方法でそれらを告知しても良い.

</p>
<p>
        OP は自身の公開鍵を Discovery ドキュメント中で示すか, その他の方法でそれを告知しても良い.
        RP は自身の公開鍵を Dynamic Registration リクエスト中に指定するか, その他の方法でそれを告知しても良い.

</p>
<a name="Signing"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
Signing</h3>

<p>
          署名者は受信者がサポートするアルゴリズムを元に署名アルゴリズムを選択しなければならない (MUST).

</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>Asymmetric Signatures</dt>
<dd>
              RSA および ECDSA 署名を利用する場合, JWS ヘッダーの <tt>alg</tt> パラメータ値には, <a class='info' href='#JWA'>JSON Web Algorithms<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWA] に従い適切な値を指定しなければならない (MUST).
              署名に使われた秘密鍵は, 署名検証に用いられる公開鍵と関連づいている必要があり, その公開鍵は署名者が JWK Set ドキュメントとして公開すること (MUST).
              JWK Set ドキュメントに複数の鍵が含まれる場合, JWS ヘッダーに <tt>kid</tt> 値を含まねばならない (MUST).
              鍵は署名に使えるものでなければならない (MUST).


</dd>
<dt>Symmetric Signatures</dt>
<dd>
              MAC ベースの署名を利用する場合, JWS ヘッダーの <tt>alg</tt> パラメータ値には, <a class='info' href='#JWA'>JSON Web Algorithms<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWA] に従い MAC アルゴリズムを指定しなければならない (MUST).
              MAC 鍵は <tt>client_secret</tt> の UTF-8 オクテットとする.
              <tt>client_secret</tt> のエントロピー要件に関しては <a class='info' href='#SymmetricKeyEntropy'>Section&nbsp;16.19<span> (</span><span class='info'>Symmetric Key Entropy</span><span>)</span></a> を参照すること.
              共通鍵署名は Client Secret を持たない Public Client (Non-Confidential Client) には利用できない (MUST NOT).


</dd>
</dl></blockquote><p>

</p>
<p>
          署名付リクエストについての Security Considerations については <a class='info' href='#NeedForSignedRequests'>Section&nbsp;16.20<span> (</span><span class='info'>Need for Signed Requests</span><span>)</span></a> を参照すること.

</p>
<a name="RotateSigKeys"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1.1"></a><h3>10.1.1.&nbsp;
Rotation of Asymmetric Signing Keys</h3>

<p>
            署名鍵のローテーションを行うには, 以下のアプローチに従うこと.
            署名者は <tt>jwks_uri</tt> で指定した場所に JWK Set を公開し, 各メッセージの JWS ヘッダーに <tt>kid</tt> を含める.
            <tt>kid</tt> によって, 検証者はどの鍵を署名検証に用いれば良いか知ることができる.
            ここで <tt>jwks_uri</tt> で公開された JWK Set に定期的に新たな鍵を追加していくことで, 鍵をロールオーバーすることができる.
            署名者は任意のタイミングで新しい鍵の利用を開始し, <tt>kid</tt> 値を用いて検証者に鍵が変わったことを知らせることができる.
            検証者は未知の <tt>kid</tt> を検知した場合は <tt>jwks_uri</tt> にアクセスし, 再び鍵を取得する.
            <tt>jwks_uri</tt> にある JWK Set ドキュメントは, 利用停止から適切な期間, 利用廃止された鍵を含んだままにすべきである (SHOULD).
            それにより鍵の移行がスムーズになる.

</p>
<a name="Encryption"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2"></a><h3>10.2.&nbsp;
Encryption</h3>

<p>
          暗号化を行う主体は, 受信者がサポートするアルゴリズムを元に, 暗号化アルゴリズムを選択しなければならない (MUST).

</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>Asymmetric Encryption: RSA</dt>
<dd>
              公開鍵の暗号化に使う公開鍵は, 受信者が公開する JWK Set ドキュメント中に含まれている公開鍵でなくてはならない (MUST).
              JWK Set ドキュメント中に複数の鍵がある場合は, JWE ヘッダー中に <tt>kid</tt> を含めなければならない (MUST).
              ランダムな Content Encryption Key によって署名付 JWT を暗号化し, その鍵をサポートされている RSA 暗号化アルゴリズムを用いて暗号化すること.
              鍵は暗号化に使えるものでなければならない (MUST).


</dd>
<dt>Asymmetric Encryption: Elliptic Curve</dt>
<dd>
              JWE ヘッダーの <tt>epk</tt> に指定するには, 短命な Elliptic Curve 公開鍵を生成する.
              鍵交換に利用するその他の鍵については, 受信者が JWK Set ドキュメント中に公開すること (MUST).
              JWK Set に複数の鍵が含まれる場合は, JWE ヘッダーに <tt>kid</tt> を指定すること.
              署名済 JWT の暗号化に用いる Content Encryption Key の鍵交換には, ECDH-ES アルゴリズムを用いる.
              鍵は暗号化に使えるものでなければならない (MUST).


</dd>
<dt>Symmetric Encryption</dt>
<dd>
              共通鍵暗号に用いる共通鍵は, <tt>client_secret</tt> UTF-8 オクテット SHA-2 ハッシュから左側を切り詰めたものとする.
              256ビット以下の鍵には SHA-256, 257-384ビットの鍵には SHA-384, 385-512ビットの鍵には SHA-512 を用いること.
              ハッシュ値は, 利用する AES 鍵ラップやその他の暗号化アルゴリズムによって適切な長さになるよう, 左側を切り詰めること.
              例えば <tt>A128KW</tt> を用いる場合は, SHA-256 ハッシュを切り詰めて128ビットを取り出す.
              512ビット以上の鍵が必要になった場合は, <tt>client_secret</tt> から鍵を導出する何らかの方法を, 拡張仕様として定義することになろう.
              共通鍵暗号は Client Secret を持たない Public Client (Non-Confidential Client) には利用できない (MUST NOT).


</dd>
</dl></blockquote><p>

</p>
<p>
          暗号化リクエストについての Security Considerations については <a class='info' href='#NeedForEncryptedRequests'>Section&nbsp;16.21<span> (</span><span class='info'>Need for Encrypted Requests</span><span>)</span></a> を参照すること.

</p>
<a name="RotateEncKeys"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2.1"></a><h3>10.2.1.&nbsp;
Rotation of Asymmetric Encryption Keys</h3>

<p>
            暗号鍵のローテーションは, 署名鍵のローテーションとは異なるプロセスとなる.
            これは暗号化の場合, 暗号化を行う主体からプロセスが開始され, <tt>kid</tt> の変更を鍵交換のサインとして利用できないからである.
            暗号化を行う主体は, JWE ヘッダーに <tt>kid</tt> を指定して, どの鍵で復号すべきかを複合を行う主体に知らせることができる.
            しかしながら暗号化を行う主体は受信者の <tt>jwks_uri</tt> にある JWK Set から, 適切な鍵を選ばねばならない.

</p>
<p>
            鍵ローテーションを行うには, 復号を行う主体がまず新しい鍵を <tt>jwks_uri</tt> で公開し, 廃止された鍵を JWK Set から削除する.
            <tt>jwks_uri</tt> は, <a class='info' href='#RFC2616'>RFC 2616<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> [RFC2616] に従いレスポンス中の <tt>Cache-Control</tt> ヘッダーに <tt>max-age</tt> を含め, 暗号化を行う主体による JWK Set のキャッシュを適切にコントロールし, 暗号化を行うたびに毎回 JWK Set を取得する必要がないようにすべきである (SHOULD).
            復号を行う主体は廃止された鍵を <tt>jwks_uri</tt> が参照する JWK Set から削除しつつも, 適切な期間その鍵を内部的に保持しておくべきである (SHOULD).
            これにより暗号化を行う主体が新しい鍵を取得するまでにある程度の猶予を許し, スムースな移行が可能になる.
            キャッシュ期間は, <a class='info' href='#RotateSigKeys'>Section&nbsp;10.1.1<span> (</span><span class='info'>Rotation of Asymmetric Signing Keys</span><span>)</span></a> にある新しい署名鍵の発行とのバランスを取り, 適切に調整すること (SHOULD).

</p>
<a name="OfflineAccess"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Offline Access</h3>

<p>
        OpenID Connect では, offline access を要求するため以下の <tt>scope</tt> 値を定義している.


        </p>
<blockquote class="text"><dl>
<dt>offline_access</dt>
<dd>
            任意 (OPTIONAL).
            OAuth 2.0 Refresh Token の発行を要求する.
            Request Token は End-User の関与を必要とせずに End-User の UserInfo Endpoint にアクセスするための Access Token を取得するために利用される.


</dd>
</dl></blockquote><p>

</p>
<p>
        offline access を要求する際には, リクエストするリソースに対する offline access の許可に必要な何らかの他の条件を満たさない限り, <tt>prompt</tt> パラメータに <tt>consent</tt> を指定しなければならない (MUST).
        OP は Refresh Token を発行する際は必ず明示的な同意を得なければならない (MUST).
        ユーザーの事前同意は offline access の許可には常に十分とはならない.

</p>
<p>
        <tt>offline_access</tt> scope を受け取った Authorization Server は, 以下に従う.


        </p>
<ul class="text">
<li>
            prompt パラメータが <tt>consent</tt> を含むことを確認する.
            offline access 要求処理における何らかの他の条件を満たす場合はその限りではない.
            上記の条件のどちらをも満たさない場合, <tt>offline_access</tt> リクエストを無視しなければならない (MUST).

</li>
<li>
            Client が Authorization Code を返すような <tt>response_type</tt> を指定しない場合, その <tt>offline_access</tt> を無視しなければならない (MUST).

</li>
<li>
            Client の登録した <tt>application_type</tt> が <tt>web</tt> の場合は, 明示的に同意を得なければならない (MUST).

</li>
<li>
            Client の登録した <tt>application_type</tt> が <tt>native</tt> の場合でも, 明示的な同意を得るべきである (SHOULD).

</li>
</ul><p>

        Refresh Token の利用は, <tt>offline_access</tt> がもたらすユースケースのみに限らない.
        Authorization Server は異なるコンテキストにおいて Refresh Token を発行しても良い (MAY).
        なおそのようなコンテキストについては, 本仕様の定めるところではない.


</p>
<a name="RefreshTokens"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Using Refresh Tokens</h3>

<p>
        Refresh Token を利用するには, <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] Section 6 に従い, Token Endpoint に <tt>grant_type</tt> を <tt>refresh_token</tt> としたリクエストを送る.
        ここでは OpenID Connect Authorization Server が Refresh Token を受け取った際の挙動について定義する.

</p>
<a name="RefreshingAccessToken"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.1"></a><h3>12.1.&nbsp;
Refresh Request</h3>

<p>
          Access Token 再発行のため, Client は自身の <tt>client_id</tt> に紐づいて登録された認証方法で, Token Endpoint に対して自身を認証しなければならない (MUST).
          詳細は <a class='info' href='#ClientAuthentication'>Section&nbsp;9<span> (</span><span class='info'>Client Authentication</span><span>)</span></a> 参照.
          Client は <a class='info' href='#FormSerialization'>Section&nbsp;13.2<span> (</span><span class='info'>Form Serialization</span><span>)</span></a> で述べた Form Serialization を用いて, Token Endpoint に HTTP <tt>POST</tt> リクエストを送る.

</p>
<p>
            以下は Refresh Request の例である.
            (改行は掲載上の都合による)

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded

  client_id=s6BhdRkqt3
    &amp;client_secret=some_secret12345
    &amp;grant_type=refresh_token
    &amp;refresh_token=8xLOxBtZp8
    &amp;scope=openid%20profile
</pre></div>
<p>
          Authorization Server は Refresh Token を検証し, それが Client に対して発行されたものであることを確認し, Client 認証がその Client の Client Authentication 方法によって成功したことを確認しなければならない (MUST).

</p>
<a name="RefreshTokenResponse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.2"></a><h3>12.2.&nbsp;
Successful Refresh Response</h3>

<p>
          Refresh Token の検証が成功すると, レスポンスボディに <a class='info' href='#TokenResponse'>Section&nbsp;3.1.3.3<span> (</span><span class='info'>Successful Token Response</span><span>)</span></a> で述べた Token Response を含める.
          ただしこのレスポンスは <tt>id_token</tt> を含まない場合もある.

</p>
<p>
          トークン再発行の際に ID Token を発行する場合は, 以下に従う.

          </p>
<ul class="text">
<li>
              <tt>iss</tt> Claim Value は, 最初の認可発生時に発行された ID Token と同じ値にすること (MUST).

</li>
<li>
              <tt>sub</tt> Claim Value も同様に, 最初の認可発生時に発行された ID Token と同じ値にすること (MUST).

</li>
<li>
              <tt>iat</tt> Claim は新しい ID Token の発行時刻にすること (MUST).

</li>
<li>
              <tt>aud</tt> Claim Value は, 最初の認可発生時に発行された ID Token と同じ値にすること (MUST).

</li>
<li>
              ID Token に <tt>auth_time</tt> Claim を含める場合は, 新しい ID Token の発行時刻ではなく, 最初の認証を行った時刻とすること (MUST).

</li>
<li>
              <tt>azp</tt> Claim Value は, 最初の認可発生時に発行された ID Token と同じ値にすること (MUST).
              <tt>azp</tt> が最初に発行された ID Token に含まれない場合は, 新しい ID Token にもそれを含めてはならない (MUST NOT).

</li>
<li>
              それ以外に関しては, 最初の認証時に発行された ID Token と同じルールを適用する.

</li>
</ul><p>

</p>
<p>
            以下は Refresh Response の例である.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 200 OK
  Content-Type: application/json
  Cache-Control: no-store
  Pragma: no-cache

  {
   "access_token": "TlBN45jURg",
   "token_type": "Bearer",
   "refresh_token": "9yNOxJtZa5",
   "expires_in": 3600
  }
</pre></div>
<a name="RefreshErrorResponse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.3"></a><h3>12.3.&nbsp;
Refresh Error Response</h3>

<p>
          Refresh Request が不正もしくは認証できなかった場合, Authorization Server は <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] Section 5.2 に従い Token Error Response を返す.

</p>
<a name="Serializations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Serializations</h3>

<p>
        メッセージは以下のいずれかの方法でシリアライズされる.

        </p>
<ol class="text">
<li>Query String Serialization
</li>
<li>Form Serialization
</li>
<li>JSON Serialization
</li>
</ol><p>

        ここではこれらのシリアライゼーション方法のシンタックスについて記述する.
        それらがいつ利用可能, もしくは利用する必要があるかを記述するのは, 他セクションに委ねる.
        すべてのシリアライゼーションがすべてのメッセージに利用可能ではないことに注意すること.


</p>
<a name="QuerySerialization"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.1"></a><h3>13.1.&nbsp;
Query String Serialization</h3>

<p>
          Query String Serialization を使ってパラメータをシリアライズするためには, Client は <a class='info' href='#W3C.REC-html401-19991224'>[W3C.REC&#8209;html401&#8209;19991224]<span> (</span><span class='info'>Raggett, D., Hors, A., and I. Jacobs, &ldquo;HTML 4.01 Specification,&rdquo; December&nbsp;1999.</span><span>)</span></a> で定義された <tt>application/x-www-form-urlencoded</tt> フォーマットを使いパラメータと値を URL のクエリコンポーネントへ追加することで文字列を構成する.
          Query String Serialization は一般的に HTTP <tt>GET</tt> リクエストで使用される.

</p>
<p>
            以下はシリアライズの参考例である.
            (改行は掲載上の都合による)

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /authorize?
    response_type=code
    &amp;scope=openid
    &amp;client_id=s6BhdRkqt3
    &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb HTTP/1.1
  Host: server.example.com
</pre></div>
<a name="FormSerialization"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.2"></a><h3>13.2.&nbsp;
Form Serialization</h3>

<p>
          パラメータやその値は, HTTP リクエストのエンティティボディに <a class='info' href='#W3C.REC-html401-19991224'>[W3C.REC&#8209;html401&#8209;19991224]<span> (</span><span class='info'>Raggett, D., Hors, A., and I. Jacobs, &ldquo;HTML 4.01 Specification,&rdquo; December&nbsp;1999.</span><span>)</span></a> に定義されているように <tt>application/x-www-form-urlencoded</tt> フォーマットでパラメータ名とその値を追加することで Form Serialize される.
          Form Serialization は一般的には HTTP <tt>POST</tt> リクエストで利用される.

</p>
<p>
            以下はシリアライズの参考例である.
            (改行は掲載上の都合による)

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  POST /authorize HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded

  response_type=code
    &amp;scope=openid
    &amp;client_id=s6BhdRkqt3
    &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
</pre></div>
<a name="JSONSerialization"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.3"></a><h3>13.3.&nbsp;
JSON Serialization</h3>

<p>
          パラメータは各パラメータを JSON オブジェクトの最上位メンバーに追加する形で, JSON オブジェクトにシリアライズされる.
          パラメータ名と文字列値は JSON 文字列として表現される.
          数値は JSON 数値, Boolean 値は JSON 真偽値となる.
          他で特別に指示されない限り, 省略されているパラメータおよび値が指定されていないパラメータは省略し, JSON <tt>null</tt> としないようにすべきである (SHOULD).
          各パラメータは JSON オブジェクトおよび JSON 配列をその値とすることができる (MAY).

</p>
<p>
            以下はシリアライズの参考例である.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "access_token": "SlAV32hkKG",
   "token_type": "Bearer",
   "expires_in": 3600,
   "refresh_token": "8xLOxBtZp8"
  }
</pre></div>
<a name="StringOps"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
String Operations</h3>

<p>
        いくつかの OpenID Connect メッセージを処理する際にはメッセージの中の値を既知の値を比較することが求められる.
        例えば, UserInfo エンドポイントから返された Claim Name は <tt>sub</tt> などの特定の Claim Name と比較される.
        よって Unicode 文字列比較処理はセキュリティ上重要な意味を持つ.

</p>
<p>
        したがって, JSON 文字列を他の Unicode 文字列と比較する際は下記の通り実施しなければならない (MUST).

        </p>
<ol class="text">
<li>
            JSON に適用されたすべてのエスケープ処理を取り除き Unicode コードポイントの配列を生成する.

</li>
<li>
            Unicode Normalization <a class='info' href='#USA15'>[USA15]<span> (</span><span class='info'>Davis, M., Whistler, K., and M. D&uuml;rst, &ldquo;Unicode Normalization Forms,&rdquo; 09&nbsp;2009.</span><span>)</span></a> を JSON 文字列, もしくは比較対象文字列に対していかなる時点であっても適用してはならない (MUST NOT).

</li>
<li>
            二つの文字列の比較は, Unicode コードポイント同士の等値比較として実施されなければならない (MUST).

</li>
</ol><p>

</p>
<p>
        いくつかの箇所において, 本仕様はスペースで区切られた文字列のリストを使用している.
        そのようないかなる場合においても, この目的では単一の ASCII のスペース文字 (0x20) を区切り文字として使用しなければならない (MUST).

</p>
<a name="ImplementationConsiderations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15"></a><h3>15.&nbsp;
Implementation Considerations</h3>

<p>
          この仕様はRelying PartyとOpenIDプロバイダの両者により利用される機能について定義している。
          多くのOpenIDプロバイダはRPとの事前登録不要で動的に利用されることを保証している一方で、OpenIDプロバイダによっては固有で定義外の設定をRPに利用することを必須化することも想定される。
          このため、OP向けの実装必須の機能を以下の２グループに分類しておく。１つ目は全てのOP向け、２つ目は動的なOpenIDプロバイダ向けである。

</p>
<a name="ServerMTI"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.1"></a><h3>15.1.&nbsp;
全てのOpenIDプロバイダが実装必須な機能について</h3>

<p>
            全てのOpenIDプロバイダは本仕様にて定義される下記機能を実装しなければならない(MUST)。
            このリストは別の場所でREQUIREDもしくはMUSTで既に記載されている機能セットを拡張するものであり、もしそうでなければ、必然的にOP向けの広範的な実装要求のセットである。

</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>ID Tokens をRSA SHA-256で署名できるようにする</dt>
<dd>
                OPがToken EndpointからのID Token返却(Authorization Codeフローの場合のように)をサポートし、クライアントに<tt>none</tt>をID Tokenの署名アルゴリズムとして指定することしか許可しないということでなければ、OPはID TokenをRSA SHA-256 アルゴリズム(<tt>alg</tt>値に<tt>RS256</tt>)での署名をサポートしなければならない(MUST)。

</dd>
<dt>Prompt Parameter</dt>
<dd>
                OPは<a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a>で定義されている、<tt>none</tt>と<tt>login</tt>などの規定のユーザインターフェースの挙動を採り入れる<tt>prompt</tt>パラメータをサポートしなければならない(MUST)。

</dd>
<dt>Display Parameter</dt>
<dd>
                OPは<a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a>で定義されている<tt>display</tt>パラメータをサポートしなければならない(MUST)。
                (このパラメータで要求される最低限度のサポートは、単にこれを使うことでエラーにならないことであることに注意してほしい)

</dd>
<dt>Preferred Locales</dt>
<dd>
                OPは<a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a>で定義されているように<tt>ui_locales</tt>と<tt>claims_locales</tt>パラメータによってユーザインターフェースとクレーム用の推奨の言語や書き言葉のリクエストをサポートしなければならない(MUST)。
                (これらのパラメータで要求される最低限度のサポートは、単にこれをつかうことでエラーにならないことであることに注意してほしい)

</dd>
<dt>Authentication Time</dt>
<dd>
                OPは<a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a>で定義されているように、<tt>auth_time</tt> クレームによってエンドユーザがどの時間で認証したかをリクエストがあった時に返却しなければならない(MUST)。

</dd>
<dt>Maximum Authentication Age</dt>
<dd>
                OPは<a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a>で定義されているように、<tt>max_age</tt>パラメータで最大認証期間を強制することをサポートしなければならない(MUST)。

</dd>
<dt>Authentication Context Class Reference</dt>
<dd>
                OPは<a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a>で定義されているように、<tt>acr_values</tt>パラメータを用いて特定の認証コンテキストクラスリファレンスの値のリクエストをサポートしなければならない(MUST)。
                (このパラメータで要求される最低限度のサポートは、単にこれを使うことでエラーにならないことであることに注意してほしい)

</dd>
</dl></blockquote><p>

</p>
<a name="DynamicMTI"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.2"></a><h3>15.2.&nbsp;
Mandatory to Implement Features for Dynamic OpenID Providers</h3>

<p>
            上記の機能に加えて、事前設定をしていないRPと動的に連携を行うことをサポートしているOpenIDプロバイダは本仕様や関連仕様にて定義されている下記の機能も実装しなくてはならない(MUST)。

</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>Response Types</dt>
<dd>
                OpenIDプロバイダはレスポンスタイプ<tt>id_token</tt>、またSelf-Issued OPではないOPは<tt>code</tt>と<tt>id_token&nbsp;token</tt>もサポートしなければならない(MUST)。

</dd>
<dt>Discovery</dt>
<dd>
                OPは<a class='info' href='#OpenID.Discovery'>OpenID Connect Discovery 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., and E. Jay, &ldquo;OpenID Connect Discovery 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OpenID.Discovery]で定義されているようにDiscovery機能をサポートしなければならない(MUST)。

</dd>
<dt>Dynamic Registration</dt>
<dd>
              OPは<a class='info' href='#OpenID.Registration'>OpenID Connect Dynamic Client Registration 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client Registration 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OpenID.Registration]で定義されているように、Dynamic Client Registrationをサポートしなければならない(MUST)。

</dd>
<dt>UserInfo Endpoint</dt>
<dd>
                アクセストークンを発行する全て動的なOPは<a class='info' href='#UserInfo'>Section&nbsp;5.3<span> (</span><span class='info'>UserInfo Endpoint</span><span>)</span></a>で定義されているように、UserInfoエンドポイントをサポートしなければならない(MUST)。

</dd>
<dt>Public Keys Published as Bare Keys</dt>
<dd>
                OPは自身の公開鍵を素のJWKキーとして公開しなければならない(MUST)。
                (JWKキーはその鍵のX.509形式の表現にあわせてもよい(MAY))

</dd>
<dt>Request URI</dt>
<dd>
                OPは<a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a>で定義されているように、<tt>request_uri</tt>パラメータで提供されたリクエストURIから取得するリクエストオブジェクト値を使ってリクエストを送信できるようにしなければならない(MUST)。

</dd>
</dl></blockquote><p>

</p>
<a name="DiscoReg"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.3"></a><h3>15.3.&nbsp;
Discovery and Registration</h3>

<p>
            OpenID Connect導入にあたって事前に設定されたOpenIDプロバイダとRelying Partyのセットが使われることがある。
            その場合において、identityやサービス、クライアントの動的登録の情報について動的にディスカバリをサポートする必要はないかもしれない。

</p>
<p>
            しかし、事前登録のないRelying PartyとOpenID Provider間の予期しないやりとりをサポートすることを選択したならば、<a class='info' href='#OpenID.Discovery'>OpenID Discovery 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., and E. Jay, &ldquo;OpenID Connect Discovery 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OpenID.Discovery]と<a class='info' href='#OpenID.Registration'>OpenID Connect Dynamic Client Registration 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client Registration 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OpenID.Registration]の仕様で定義されているファシリティを実装することでこれを遂行するべきである(SHOULD)。

</p>
<a name="RPMTI"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.4"></a><h3>15.4.&nbsp;
Mandatory to Implement Features for Relying Parties</h3>

<p>
            一般的に、OpenIDプロバイダと通信する祭にどの機能を利用するかはRelying Partyに依存する。
            しかし、必然的に利用するOAuthクライアントによって決定されてしまうこともある。
            コンフィデンシャルなクライアントかどうかは、シークレットを安全に保持できるかで決まる。この場合Authorization Codeフローが適しているかもしれない。
            また、パブリックなクライアントかどうかは、例えばUser Agentベースのアプリケーションや静的に登録済みのネイティブアプリケーションがある。この場合Implicitフローが適しているかもしれない。

</p>
<p>
            OpenID Connectの機能を利用する際に、それらが"REQUIRED"や"MUST"として記載されていればRPに利用されるときに実装必須の機能となる。
            同様に"OPTIONAL"と記載されている機能は、特定のアプリケーション状況下にてやる価値がないならば、利用されたりサポートされたりする必要性はない。
            つまりは、DiscoveryをサポートするOpenIDプロバイダとやりとりをするときは、OPのDiscovery文書がどの機能をRPが利用できるのかを動的に決定することが可能である。

</p>
<p>

</p>
<a name="ImplementationNotes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.5"></a><h3>15.5.&nbsp;
Implementation Notes</h3>

<a name="CodeNotes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.5.1"></a><h3>15.5.1.&nbsp;
Authorization Code Implementation Notes</h3>

<p>
            Authorization Code フローあるいは Hybrid フロー を用いる場合,
            Authorization Code を用いた Token Request への応答として,
            ID Token が Token Endpoint から返却される.
            ある実装では, Authorization Code 値の中に,
            返却する ID Token の状態を符号化して持たせることを選択するかもしれない.
            別の実装では, 状態を格納しているデータベースに対するインデックスとして,
            Authorization Code 値を使用するかもしれない.

</p>
<a name="NonceNotes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.5.2"></a><h3>15.5.2.&nbsp;
Nonce Implementation Notes</h3>

<p>
            <tt>nonce</tt> パラメータ値は,
            セッション毎の状態を含むとともに, 攻撃者によって推測されないようにする必要がある.
            Web Server Client がこの要件を満足する手法の一つは,
            HttpOnly属性付きのセッションクッキーとして暗号論的乱数値を格納し,
            その値の暗号学的ハッシュを <tt>nonce</tt> パラメータとして使用することである.
            このケースでは, 第三者による ID Token リプレイを検出するために,
            返却される ID Token 内の <tt>nonce</tt> と
            セッションクッキーのハッシュを比較する.
            JavaScript Client に対して適用可能な関連手法として,
            HTML5 ローカルストレージに暗号論的乱数値を格納し,
            その値の暗号学的ハッシュを用いる方法がある.

</p>
<a name="FragmentNotes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.5.3"></a><h3>15.5.3.&nbsp;
Redirect URI Fragment Handling Implementation Notes</h3>

<p>
            応答パラメータを Redirection URI のフラグメント値として返却する場合,
            Client は User Agent に対し, そのフラグメント内の符号化された値をパースさせ,
            Client の処理ロジックにその値を受け渡す必要がある.
            暗号 API に直接アクセスする User Agent は,
            例えば全ての Client コードを JavaScript で記述するなど,
            処理に必要なロジック等を全て自己の中で完結させることが出来る.

</p>
<p>
            しかし, Client を完全に User Agent 内だけで実行しない場合,
            検証のために Web Server Client にデータを送信することで目的を実現する方法もある.

</p>
<p>
            Client が自身の <tt>redirect_uri</tt> 上でホストすることが考えられる
            JavaScript ファイルの例を以下に示す.
            これは Authorization Server からのリダイレクトによってロードされる.
            フラグメント部はパースされた後, 受信した情報の検証と利用を行う URL に対し、
            <tt>POST</tt> で送信される.

</p>
<p>
              Redirect URI 応答の一例を以下に示す:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /cb HTTP/1.1
  Host: client.example.org

  HTTP/1.1 200 OK
  Content-Type: text/html

  &lt;script type="text/javascript"&gt;

  // First, parse the query string
  var params = {}, postBody = location.hash.substring(1),
      regex = /([^&amp;=]+)=([^&amp;]*)/g, m;
  while (m = regex.exec(postBody)) {
    params[decodeURIComponent(m[1])] = decodeURIComponent(m[2]);
  }

  // And send the token over to the server
  var req = new XMLHttpRequest();
  // using POST so query isn't logged
  req.open('POST', 'https://' + window.location.host +
                   '/catch_response', true);
  req.setRequestHeader('Content-Type',
                       'application/x-www-form-urlencoded');

  req.onreadystatechange = function (e) {
    if (req.readyState == 4) {
      if (req.status == 200) {
  // If the response from the POST is 200 OK, perform a redirect
        window.location = 'https://'
          + window.location.host + '/redirect_after_login'
      }
  // if the OAuth response is invalid, generate an error message
      else if (req.status == 400) {
        alert('There was an error processing the token')
      } else {
        alert('Something other than 200 was returned')
      }
    }
  };
  req.send(postBody);
</pre></div>
<a name="CompatibilityNotes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.6"></a><h3>15.6.&nbsp;
Compatibility Notes</h3>

<a name="PreFinalIETFSpecs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.6.1"></a><h3>15.6.1.&nbsp;
Pre-Final IETF Specifications</h3>

<p>
		    実装者は, この仕様がまだ最終仕様でない複数のIETF仕様を利用していることに注意すべきである.
			それらの仕様は以下のとおり:


            </p>
<ul class="text">
<li><a class='info' href='#JWT'>JSON Web Token (JWT) draft -13<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token (JWT),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWT]
</li>
<li><a class='info' href='#JWS'>JSON Web Signature (JWS) draft -18<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature (JWS),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWS]
</li>
<li><a class='info' href='#JWE'>JSON Web Encryption (JWE) draft -18<span> (</span><span class='info'>Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;JSON Web Encryption (JWE),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWE]
</li>
<li><a class='info' href='#JWK'>JSON Web Key (JWK) draft -18<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Key (JWK),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWK]
</li>
<li><a class='info' href='#JWA'>JSON Web Algorithms draft -18<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWA]
</li>
<li><a class='info' href='#OAuth.Assertions'>Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants draft -13<span> (</span><span class='info'>Campbell, B., Mortimore, C., Jones, M., and Y. Goland, &ldquo;Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.Assertions]
</li>
<li><a class='info' href='#OAuth.JWT'>JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants draft -07<span> (</span><span class='info'>Jones, M., Campbell, B., and C. Mortimore, &ldquo;JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.JWT]
</li>
</ul><p>

</p>
<p>
		    これらの仕様に重要な変更を防ぐためにあらゆる努力を行うとしても, それらは発生するかもしれず,
			OpenID Connectの実装はこれらの参考文献の一部ないしはすべてを更新し, 将来のOpenID ConectのProfileか仕様を使用していない限り,  前述の最終版よりも優先して具体的に参照されているドラフトバージョンを使用し続けるべきである(SHOULD).

</p>
<a name="GoogleIss"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.6.2"></a><h3>15.6.2.&nbsp;
Google "iss" Value</h3>

<p>
		   実装者はこの文書を執筆している時点では, GoogleのOpenID Connectの実装は, <tt>iss</tt>(発行者)クレーム値から要求された<tt>https://</tt>スキームのプレフィックスを省略したID Token を発行することに注意する必要があるだろう.
		   Googleと連携を希望するRelying Partyは, そのため, それらの実装が更新されるようなときまで, これに対処するためのコードを持っている必要がある.
		   このような問題を回避するためのコードは, Googleが発行者の値に不足しているプレフィックスを追加し, このような点で中断されないような方法で書かれるべきである.

</p>
<a name="RelatedSpecs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.7"></a><h3>15.7.&nbsp;
Related Specifications and Implementer's Guides</h3>

<p>
		  関連するオプション仕様は, 追加機能を提供するために本仕様と組み合わせて利用されるかもしれない(MAY).

          </p>
<ul class="text">
<li>
              <a class='info' href='#OpenID.Discovery'>OpenID Connect Discovery 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., and E. Jay, &ldquo;OpenID Connect Discovery 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OpenID.Discovery] -
			  Relying PartyがOpenID Providerについての情報を動的に発見する方法を定義する.


</li>
<li>
              <a class='info' href='#OpenID.Registration'>OpenID Connect Dynamic Client Registration 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client Registration 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OpenID.Registration] -
			  Relying PartyがOpenID Providerに動的に登録する方法を定義する.


</li>
<li>
              <a class='info' href='#OpenID.Session'>OpenID Connect Session Management 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Session Management 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OpenID.Session] -
			  ログアウト機能を含む, OpenID Connectのセッション管理の方法を定義する.


</li>
<li>
              <a class='info' href='#OAuth.Post'>OAuth 2.0 Form Post Response Mode<span> (</span><span class='info'>Jones, M. and B. Campbell, &ldquo;OAuth 2.0 Form Post Response Mode,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OAuth.Post] -
              HTTP <tt>POST</tt>を使用するユーザエージェントによって, 自動送信されたHTMLフォーム値を使用して, OAuth2.0のAuthorization Responseパラメータ(OpenID Connect Autentication Responseパラメータを含む)を返却する方法を定義する.


</li>
</ul><p>

</p>
<p>
		  これらの実装者ガイドは, 基本的なWebベースのRelaying Partyの実装者のための自己完結型の基準となることを意図している.

          </p>
<ul class="text">
<li><a class='info' href='#OpenID.Basic'>OpenID Connect Basic Client Implementer's Guide 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and C. Mortimore, &ldquo;OpenID Connect Basic Client Implementer's Guide 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OpenID.Basic] -
			実装者ガイドは, OAuth Authorization Code Flowを使用するベーシックなWebベースのRelyingPartyで利用することを目的とした, この仕様のサブセットを含んでいる.



</li>
<li><a class='info' href='#OpenID.Implicit'>OpenID Connect Implicit Client Implementer's Guide 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and C. Mortimore, &ldquo;OpenID Connect Implicit Client Implementer's Guide 1.0,&rdquo; December&nbsp;2013.</span><span>)</span></a> [OpenID.Implicit] -
			実装者ガイドは, OAuth Implicit Flowを使用するベーシックなWebベースのRelyingPartyで利用することを目的とした, この仕様のサブセットを含んでいる.

</li>
</ul><p>

</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16"></a><h3>16.&nbsp;
Security Considerations</h3>

<p>
        本仕様は, <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] の Section 10, <a class='info' href='#RFC6750'>OAuth 2.0 Bearer Token Usage<span> (</span><span class='info'>Jones, M. and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework: Bearer Token Usage,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6750] の Section 5 に定義されている security considerations を引用する.
        さらに, <a class='info' href='#RFC6819'>OAuth 2.0 Threat Model and Security Considerations<span> (</span><span class='info'>Lodderstedt, T., McGloin, M., and P. Hunt, &ldquo;OAuth 2.0 Threat Model and Security Considerations,&rdquo; January&nbsp;2013.</span><span>)</span></a> [RFC6819] は, この仕様にもよくあてはまる OAuth 2.0 をベースとした脅威と制御の広範囲なリストを提供する.
        <a class='info' href='#ISO29115'>ISO/IEC 29115<span> (</span><span class='info'>International Organization for Standardization, &ldquo;ISO/IEC 29115:2013 --           Information technology - Security techniques - Entity authentication           assurance framework,&rdquo; March&nbsp;2013.</span><span>)</span></a> [ISO29115] もまた, 実装者が考慮する必要がある脅威と制御を提供する.
        実装者には, これらの引用の詳細を読み, それらに記載されている対抗策を適用することを勧める.

</p>
<p>
        加えて, 以下の攻撃ベクトルと救済策のリストもまた, 考慮される.

</p>
<a name="RequestDisclosure"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.1"></a><h3>16.1.&nbsp;
Request Disclosure</h3>

<p>
          適切な処置が講じられないとき, リクエストは攻撃者に漏洩され, セキュリティとプライバシーの脅威をもたらすかもしれない.

</p>
<p>
          <a class='info' href='#RFC6819'>[RFC6819]<span> (</span><span class='info'>Lodderstedt, T., McGloin, M., and P. Hunt, &ldquo;OAuth 2.0 Threat Model and Security Considerations,&rdquo; January&nbsp;2013.</span><span>)</span></a> の Section 5.1.1 にあることに加え, この仕様は <tt>request</tt> パラメータ ( <tt>request</tt> の内容は適切な鍵と暗号により暗号化されたJWT) もしくは <tt>request_uri</tt> パラメータを利用することによりエンドツーエンドでリクエストの機密性を提供する方法を提供する.
          これは, 間接的なリクエストの場合に改ざんされた User Agent からも保護する.

</p>
<a name="ServerMasquerading"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.2"></a><h3>16.2.&nbsp;
Server Masquerading</h3>

<p>
          悪意のある Server は, 様々な方法を用いて正規の Server に成りすますかもしれない.
          そのような攻撃を検知するため, Client は Server を認証する必要がある.

</p>
<p>
          <a class='info' href='#RFC6819'>[RFC6819]<span> (</span><span class='info'>Lodderstedt, T., McGloin, M., and P. Hunt, &ldquo;OAuth 2.0 Threat Model and Security Considerations,&rdquo; January&nbsp;2013.</span><span>)</span></a> の Section 5.1.2 にあることに加え, この仕様は適切な鍵と暗号を用いた Signed JWT と Encrypted JWT の両方で Server を認証する方法を提供する.

</p>
<a name="TokenManufacture"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.3"></a><h3>16.3.&nbsp;
Token Manufacture/Modification</h3>

<p>
          攻撃者は偽のトークンを生成もしくは既存の解析可能なトークンの内容( Claim や署名など) を修正し, RP に Client への不適切なアクセスを引き起こすかもしれない.
          例えば, 攻撃者は解析可能なトークンの有効期限を延長するかもしれない : Client は彼らが閲覧できない情報にアクセスするために解析可能なトークンを修正するかもしれない.

</p>
<p>
          この攻撃を軽減するための2つの方法がある:

</p>
<p>
          </p>
<ol class="text">
<li>
              トークンはOPによりデジタル署名をつけることができる.
              Relying Party はそれが正規の OP から発行されたことを確認するためにデジタル署名を検証すべき (SHOULD).

</li>
<li>
              トークンは TLS のような, 保護されたチャンネル上で送られることができる.
              TLS の利用についての情報は <a class='info' href='#TLSRequirements'>Section&nbsp;16.17<span> (</span><span class='info'>TLS Requirements</span><span>)</span></a> を参照すること.
              この仕様では, トークンは常に TLS で保護されたチャンネル上で送られる.
              しかし, この手段は第3者の攻撃に対する防御のみであり, Client が攻撃者になるケースには適用できない点に注意すること.

</li>
</ol><p>

</p>
<a name="AccessTokenDisclosure"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.4"></a><h3>16.4.&nbsp;
Access Token Disclosure</h3>

<p>
          <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] の Section 1.4 で定義されているように, Access Token は Protected Resources にアクセスするために用いられるクレデンシャルである.
          Access Token は End-User の認可を表すものであり, 認可されていない対象にさらされることはあってはならない (MUST NOT).

</p>
<a name="ResponseDisclosure"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.5"></a><h3>16.5.&nbsp;
Server Response Disclosure</h3>

<p>
          サーバーのレスポンスは, 認証データとセンシティブな Client 情報を含む Claim を含む可能性がある.
          レスポンス内容の暴露は, Client を他の種類の攻撃に対して脆弱にすることができる.

</p>
<p>
          サーバーレスポンスの公開は, 次の2つの方法により軽減されることができる:

          </p>
<ol class="text">
<li>
              Response Type に <tt>code</tt> を利用する.
              レスポンスは TLS で保護されたチャンネル上で送られ, Client は <tt>client_id</tt> と <tt>client_secret</tt> によって認証される.

</li>
<li>
              その他の Response Type については, 適切な鍵と暗号により暗号化された JWT として Client の公開鍵もしくは共有秘密鍵を暗号化されることができる.

</li>
</ol><p>

</p>
<a name="ServerResponseRepudiation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.6"></a><h3>16.6.&nbsp;
Server Response Repudiation</h3>

<p>
          適切なメカニズムが実施されていないならば, レスポンスは Serverにより拒否されるかもしれない.
          例えば, Server が デジタル署名をレスポンスに施さなかった場合, Server はそれが自身のサービスを通して生成されていないと主張することができる.

</p>
<p>
          この脅威を軽減するため, レスポンスは否認防止のための鍵を用いて Server により署名されてもよい (MAY).
          Client はそれが正規の Server から発行されたものであり, 完全であることを確認するためにデジタル署名を検証すべき (SHOULD).

</p>
<a name="RequestRepudation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.7"></a><h3>16.7.&nbsp;
Request Repudiation</h3>

<p>
          脆弱または悪意のある Client がリクエストを誤った対象に送ることがありえるため, bearer token のみを利用して認証された Client はいかなるトランザクションでも拒否されることができる.

</p>
<p>
          この脅威を軽減するため, Server は Client により否認防止のための鍵を用いてデジタル署名されたリクエストを要求してもよい (MAY).
          Server はそれが正規の Client から発行されたものであり, 完全であることを確認するためにデジタル署名を検証すべき (SHOULD).

</p>
<a name="AccessTokenRedirect"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.8"></a><h3>16.8.&nbsp;
Access Token Redirect</h3>

<p>
          攻撃者は, あるリソースのために生成された Access Token を別のリソースへのアクセスするために利用する.

</p>
<p>
          この脅威を軽減するため, Access Token は audience と scope に対して制限をかけるべき (SHOULD).
          それを実装するひとつの方法として, audience として生成されたリソースの識別子を含むことがある.
          リソースは, 受け取ったトークンが audience として自身の識別子を含むことを確認する.

</p>
<a name="TokenReuse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.9"></a><h3>16.9.&nbsp;
Token Reuse</h3>

<p>
          攻撃者は, 対象の Resource のために既に一度利用された Authorization Code のようなワンタイムなトークンの再利用を試みる.
          この脅威を軽減するため, トークンはタイムスタンプを含み, 有効期限を短くすべき (SHOULD).
          Relying Party は, トークンが現時点で有効であることを確実にするため, タイムスタンプと有効期限の値をチェックする.

</p>
<p>
          あるいは, サーバーはトークンの利用状況を記録し, リクエスト毎にその状態を確認してもよい (MAY).

</p>
<a name="AuthCodeCapture"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.10"></a><h3>16.10.&nbsp;
 Eavesdropping or Leaking Authorization Codes (Secondary Authenticator Capture)</h3>

<p>
          User Agent がマルウェアに感染している場合は, <a class='info' href='#RFC6819'>[RFC6819]<span> (</span><span class='info'>Lodderstedt, T., McGloin, M., and P. Hunt, &ldquo;OAuth 2.0 Threat Model and Security Considerations,&rdquo; January&nbsp;2013.</span><span>)</span></a> Section 4.4.1.1 にある攻撃パターンに加え, Authorization Code が TLS セッションの終端となる User Agent 上でも盗聴される可能性がある.
          Client Authentication やレスポンス暗号化を用いると, この盗聴パターンは無効化できる.

</p>
<a name="TokenSubstitution"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.11"></a><h3>16.11.&nbsp;
Token Substitution</h3>

<p>
          Token Substitution は, 不正なユーザがトークンを置換するタイプの攻撃である.
          交換されるトークンには Authorization Code も含まれる.
          アタッカーがあるセッション中からトークンを取り出し, 別のセッション中でそれを利用するなどすることで, この攻撃が可能となる.
          トークンがブラウザに渡される場合, これは非常に簡単な作業であり, 別名 "cut and paste" 攻撃とも呼ばれる.

</p>
<p>
          <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] Implicit Flow は, このリスクを考慮した設計になってはいない.
          <a class='info' href='#RFC6749'>OAuth 2.0<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749] Section 10.16 においては, End-User 認証の為に OAuth 2.0 を利用する場合, Client が ID Token や Access Token が認証目的で利用可能かどうか判断できる追加のセキュリティメカニズムがない場合には Implicit Flow を利用しないよう Client に要求している (MUST NOT).

</p>
<p>
          OpenID Connect では, ID Token を利用することでこのリスクを回避できる.
          ID Token は署名付きのセキュリティトークンであり, <tt>iss</tt> (issuer),
          <tt>sub</tt> (subject),
          <tt>aud</tt> (audience),
          <tt>azp</tt> (authorized party),
          <tt>at_hash</tt> (access token hash), および
          <tt>c_hash</tt> (code hash) を Claim として提供する.
          ID Token を利用することで, Client は Token Substitution Attack を検知可能になる.

</p>
<p>
          ID Token 内の <tt>c_hash</tt> は, Authorization Code 置換を防ぐために利用できる.
          同様に <tt>at_hash</tt> は Access Token 置換を防ぐために利用できる.

</p>
<p>
          また不正なユーザが, Authorization Endpoint と Client の間, もしくは Token Endpoint と Client の間の通信に介入し, Authorization Code を置換したりメッセージの順序を入れ替えたりすることで, 特権ユーザになりすます可能性もある.
          この攻撃により, Token Endpoint が攻撃者の提示した認可グラントが, より権限の強い特権ユーザのそれとして受け入れてしまうかもしれない.

</p>
<p>
          本仕様で定義された HTTP バインディングでは, Token Request に対するレスポンスは HTTP メッセージ順に対応するリクエストと紐づけられる.
          トークンを含んだレスポンスとリクエストが TLS で保護されている限り, パケットの順序入れ替えは検知および防御可能であろう.

</p>
<p>
          Token Endpoint へのリクエストとレスポンスを強固に紐づけることができない何らかの他のプロトコルをバインディングとして本仕様を適用する場合, この問題に対する何らかの追加の対策が必要となる (MUST).
          <tt>c_hash</tt> Claim を含んだ ID Token をトークンリクエストおよびレスポンスに含むことなどが, 例として挙げられる.

</p>
<a name="TimingAttack"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.12"></a><h3>16.12.&nbsp;
Timing Attack</h3>

<p>
          タイミングアタックにより, 攻撃者は復号処理や署名検証の成功/失敗にかかる処理時間の違いを通じて, 必定以上に多くの情報を得ることができる.
          この攻撃は, 暗号文の有効な鍵長を限定する為に利用できる.

</p>
<p>
          実装者はエラーを検知した際すぐに検証プロセスを終了するのではなく, 他のオクテットに対する処理を終えるまで処理を継続し, この攻撃を防ぐべきである (SHOULD).

</p>
<a name="OtherCryptoAttacks"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.13"></a><h3>16.13.&nbsp;
Other Crypto Related Attacks</h3>

<p>
          暗号, 署名, 完全性検証の手法に応じて, 暗号関連の様々な攻撃が考えられる.
          実装者は <a class='info' href='#JWT'>JWT<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token (JWT),&rdquo; November&nbsp;2013.</span><span>)</span></a> [JWT] の Security Considerations, および JWT が参照する, 各脆弱性を防ぐための仕様群に従うこと.

</p>
<a name="SigningOrder"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.14"></a><h3>16.14.&nbsp;
Signing and Encryption Order</h3>

<p>
          暗号文に対する署名は, 多くの法域 (jurisdiction: 法律用語, ある法律が適用される地域のこと) で有効と認められない.
          従って本仕様では, 完全性と非否認性を確保するため署名を利用する際には, 平文の JSON Claim に対して署名をすることを要求する.
          署名と暗号化がともに必要となる場合, 署名対象の Claim を含んだ JWS に対して暗号化を行うこと.
          これにより <a class='info' href='#JWT'>[JWT]<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token (JWT),&rdquo; November&nbsp;2013.</span><span>)</span></a> で述べられている Nexted JWT が導出される.
          なお, 全ての JWE 暗号化アルゴリズムは完全性保護を提供しており, 暗号文に別途署名を行う必要はないことに注意すること.

</p>
<a name="IssuerIdentifier"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.15"></a><h3>16.15.&nbsp;
Issuer Identifier</h3>

<p>
          OpenID Connect では, 1つの Host と Port のペアに対して複数の Issuer を配置することができる.
          従って, ディスカバリーで返される issuer は, ID Token に含まれる <tt>iss</tt> と完全一致しなければならない (MUST).

</p>
<p>
          OpenID Connect は Issuer URI のパスコンポーネントを Issuer Identifier の一部として扱う.
          よって例えば subject が同じ "1234" であったとしても, Issuer Identifier が "https://example.com" なものと "https://example.com/sales" なものとでは, 異なる subject となる.

</p>
<p>
          ホストごとに単一の Issuer にとどめることを推奨する (RECOMMENDED).
          しかしながらマルチテナントなホストでは, 単一ホストに対して複数の Issuer が必要になるケースもあるであろう.

</p>
<a name="ImplicitFlowThreats"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.16"></a><h3>16.16.&nbsp;
Implicit Flow Threats</h3>

<p>
          Implicit Flow では, Access Token は Client の <tt>redirect_uri</tt> のフラグメントを介して HTTPS で返される.
          従って OP と User Agent の間, User Agent と RP の間の通信は, 保護されている.
          しかしながら User Agent がマルウェアに感染していたり不正な操作者のコントロール下にある場合は, TLS セッションの終端となる User Agent 上で Access Token を読み取られることもありうる.

</p>
<a name="TLSRequirements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.17"></a><h3>16.17.&nbsp;
TLS Requirements</h3>

<p>
          各実装は TLS をサポートしなければならない (MUST).
          どのバージョンを実装するかは, 時間の経過や広く利用されている実装, 既知のセキュリティ上の脆弱性などによって, その時々で変化しうる.
          本仕様執筆時点では, TLS version 1.2 <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> が最新のバージョンであるが, 実装は限定される.
          そのため実装時に使うツールキットではすぐには利用できないかもしれない.
          TLS version 1.0 <a class='info' href='#RFC2246'>[RFC2246]<span> (</span><span class='info'>Dierks, T. and C. Allen, &ldquo;The TLS Protocol Version 1.0,&rdquo; January&nbsp;1999.</span><span>)</span></a> は最も広く利用されているバージョンであり, 最も広い相互運用性を提供するであろう.

</p>
<p>
          情報漏洩や改竄に対しては, TLS を用いた秘匿性保護が必須である (MUST).
          TLS の秘匿性および完全性保護を提供する暗号スイートを利用すること.

</p>
<p>
          TLS を利用する際は, 常に TLS サーバ証明書を検証しなければならない (MUST).
          詳細は <a class='info' href='#RFC6125'>RFC 6125<span> (</span><span class='info'>Saint-Andre, P. and J. Hodges, &ldquo;Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS),&rdquo; March&nbsp;2011.</span><span>)</span></a> [RFC6125] を参照のこと.

</p>
<a name="TokenLifetime"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.18"></a><h3>16.18.&nbsp;
Lifetimes of Access Tokens and Refresh Tokens</h3>

<p>
          Authorization Server は Access Token を無効化できないかもしれない.
          従って, Access Token の有効期間は一度の利用に十分な期間, もしくは非常に短い期間に限定するべきである (SHOULD).

</p>
<p>
          UserInfo Endpoint や他の Protected Resource に対する継続したアクセスが必要な場合は, Refresh Token を利用できる.
          Client は Token Endpoint に Refresh Token を送ることで, 新規の有効期間の短い Access Token を取得し, リソースアクセスに利用できる.

</p>
<p>
          Authorization Server は Authorization 中に User に対して長期間の認可を与えようとしていることを明示すべきである (SHOULD).
          Authorization Server は End-User に対して, 特定の Client に発行された Access Token および Refresh Token を無効化する手段を提供すべきである (SHOULD).

</p>
<a name="SymmetricKeyEntropy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.19"></a><h3>16.19.&nbsp;
Symmetric Key Entropy</h3>

<p>
          <a class='info' href='#Signing'>Section&nbsp;10.1<span> (</span><span class='info'>Signing</span><span>)</span></a> と <a class='info' href='#Encryption'>Section&nbsp;10.2<span> (</span><span class='info'>Encryption</span><span>)</span></a> では, 鍵は <tt>client_secret</tt> 値から導出される.
          従って共通鍵暗号による署名および暗号化を行うためには, <tt>client_secret</tt> が十分なエントロピーを持った暗号論的に強固な鍵とする必要がある (MUST).
          また <tt>client_secret</tt> は利用するアルゴリズムが利用する MAC 鍵に必要な最低限のオクテット長を持つ必要がある (MUST).
          例えば <tt>HS256</tt> を利用する際は, <tt>client_secret</tt> は最低でも32オクテットが必要である (MUST).
          (なお, 多くのの場合 <tt>client_secret</tt> はアルファベットに限定されるため, 明らかにそれ以上のオクテットが必要となるであろう (SHOULD))

</p>
<a name="NeedForSignedRequests"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.20"></a><h3>16.20.&nbsp;
Need for Signed Requests</h3>

<p>
          場合によっては, Client はリクエストパラメータの改竄を防止するため, リクエストに署名を行う必要があるかもしれない.
          例えば <tt>max_age</tt> と <tt>acr_values</tt> などは, 署名付きリクエストを用いた方がより正確に認証処理についての保証として有用になるであろう.

</p>
<a name="NeedForEncryptedRequests"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.21"></a><h3>16.21.&nbsp;
Need for Encrypted Requests</h3>

<p>
          場合によっては, OpenID Connect リクエストを除き見ることで, End-User に関するセンシティブな情報を漏洩させることもある.
          例えば Client が特定の Claim を要求したことや特定の認証方法を要求したことを知ることで, End-User に関するセンシティブな情報を漏洩させることもある.
          OpenID Connect は OpenID Provider へのリクエストを暗号化可能とすることで, センシティブ情報の漏洩を防止可能にする.

</p>
<a name="Privacy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.17"></a><h3>17.&nbsp;
Privacy Considerations</h3>

<a name="PII"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.17.1"></a><h3>17.1.&nbsp;
Personally Identifiable Information</h3>

<p>The UserInfo Response typically contains Personally Identifiable
        Information (PII). As such, End-User consent for the release of the information
        for the specified purpose should be obtained at or prior to the
        authorization time in accordance with relevant regulations. The purpose
        of use is typically registered in association with the <tt>redirect_uris</tt>.
</p>
<p>Only necessary UserInfo data should be stored at the Client and the
        Client SHOULD associate the received data with the purpose of use
        statement.
</p>
<a name="AccessMonitoring"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.17.2"></a><h3>17.2.&nbsp;
Data Access Monitoring</h3>

<p>
          The Resource Server SHOULD make End-Users' UserInfo access logs
          available to them so that they can monitor who accessed their data.

</p>
<a name="Correlation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.17.3"></a><h3>17.3.&nbsp;
Correlation</h3>

<p>To protect the End-User from a possible correlation among Clients, the
        use of a Pairwise Pseudonymous Identifier (PPID) as the
        <tt>sub</tt> (subject) SHOULD be considered.
</p>
<a name="OfflineAccessPrivacy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.17.4"></a><h3>17.4.&nbsp;
Offline Access</h3>

<p>
          Offline access enables access to Claims when the user is not present,
          posing greater privacy risk than the Claims transfer when the user is present.
          Therefore, it is prudent to obtain explicit consent for
          offline access to resources.
          This specification mandates the use of the <tt>prompt</tt>
          parameter to obtain consent unless it is already known that the
          request complies with the conditions for processing the request in each jurisdiction.

</p>
<p>
          When an Access Token is returned via the User Agent
          using the Implicit Flow or Hybrid Flow, there is
          a greater risk of it being exposed to an attacker, who could
          later use it to access the UserInfo endpoint.
          If the Access Token does not enable offline access and the server
          can differentiate whether the Client request has been made
          offline or online, the risk will be substantially reduced.
          Therefore, this specification mandates ignoring
          the offline access request when the Access Token is
          transmitted through the User Agent.
          Note that differentiating between online and offline access
          from the server can be difficult especially for native clients.
          The server may well have to rely on heuristics.
          Also, the risk of exposure for the Access Token delivered
          through the User Agent for the Response Types of
          <tt>code&nbsp;token</tt> and
          <tt>token</tt> is the same.
          Thus, the implementations should be prepared to detect
          whether the Access Token was issued through the User Agent
          or directly from the Token Endpoint and deny offline access
          if the token was issued through the User Agent.

</p>
<p>
          Note that although these provisions require an explicit
          consent dialogue through the <tt>prompt</tt> parameter,
          the mere fact that the user pressed an "accept" button etc.,
          might not constitute a valid consent.
          Developers should be aware that for the act of consent to
          be valid, typically, the impact of the terms have to be
          understood by the End-User, the consent must be freely given
          and not forced (i.e., other options have to be available),
          and the terms must fair and equitable.
          In general, it is advisable for the service to follow the
          required privacy principles in each jurisdiction and rely on
          other conditions for processing the request than simply explicit consent,
          as online self-service "explicit consent" often does not
          form a valid consent in some jurisdictions.

</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.18"></a><h3>18.&nbsp;
IANA Considerations</h3>

<a name="ClaimsRegistry"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.18.1"></a><h3>18.1.&nbsp;
JSON Web Token Claims Registration</h3>

<p>
          This specification registers the Claims defined in
          <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> and <a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a> in the IANA
          JSON Web Token Claims registry
          defined in <a class='info' href='#JWT'>[JWT]<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token (JWT),&rdquo; November&nbsp;2013.</span><span>)</span></a>.

</p>
<a name="ClaimsContents"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.18.1.1"></a><h3>18.1.1.&nbsp;
Registry Contents</h3>

<p>
          </p>
<ul class="text">
<li>
              Claim Name: <tt>name</tt>

</li>
<li>
              Claim Description: Full name

</li>
<li>
              Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
              Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>given_name</tt>

</li>
<li>
                Claim Description: Given name(s) or first name(s)

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>family_name</tt>

</li>
<li>
                Claim Description: Surname(s) or last name(s)

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>middle_name</tt>

</li>
<li>
                Claim Description: Middle name(s)

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>nickname</tt>

</li>
<li>
                Claim Description: Casual name

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>preferred_username</tt>

</li>
<li>
                Claim Description: Shorthand name by which the End-User wishes to be referred to

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>profile</tt>

</li>
<li>
                Claim Description: Profile page URL

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>picture</tt>

</li>
<li>
                Claim Description: Profile picture URL

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>website</tt>

</li>
<li>
                Claim Description: Web page or blog URL

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>email</tt>

</li>
<li>
                Claim Description: Preferred e-mail address

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>email_verified</tt>

</li>
<li>
                Claim Description: True if the e-mail address has been verified; otherwise false

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>gender</tt>

</li>
<li>
                Claim Description: Gender

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>birthdate</tt>

</li>
<li>
                Claim Description: Birthday

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>zoneinfo</tt>

</li>
<li>
                Claim Description: Time zone

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>locale</tt>

</li>
<li>
                Claim Description: Locale

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>phone_number</tt>

</li>
<li>
                Claim Description: Preferred telephone number

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>phone_number_verified</tt>

</li>
<li>
                Claim Description: True if the phone number has been verified; otherwise false

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>address</tt>

</li>
<li>
                Claim Description: Preferred postal address

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>updated_at</tt>

</li>
<li>
                Claim Description: Time the information was last updated

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#StandardClaims'>Section&nbsp;5.1<span> (</span><span class='info'>Standard Claims</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>azp</tt>

</li>
<li>
                Claim Description: Authorized party - the party to which the ID Token was issued

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>nonce</tt>

</li>
<li>
                Claim Description: Value used to associate a Client session with an ID Token

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>auth_time</tt>

</li>
<li>
                Claim Description: Time when the authentication occurred

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>at_hash</tt>

</li>
<li>
                Claim Description: Access Token hash value

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>c_hash</tt>

</li>
<li>
                Claim Description: Code hash value

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#HybridIDToken'>Section&nbsp;3.3.2.11<span> (</span><span class='info'>ID Token</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>acr</tt>

</li>
<li>
                Claim Description: Authentication Context Class Reference

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>amr</tt>

</li>
<li>
                Claim Description: Authentication Methods References

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#IDToken'>Section&nbsp;2<span> (</span><span class='info'>ID Token</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>
                Claim Name: <tt>sub_jwk</tt>

</li>
<li>
                Claim Description: Public key used to check the signature of an ID Token

</li>
<li>
                Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net

</li>
<li>
                Specification Document(s): <a class='info' href='#SelfIssuedResponse'>Section&nbsp;7.4<span> (</span><span class='info'>Self-Issued OpenID Provider Response</span><span>)</span></a> of this document

</li>
</ul><p>

</p>
<a name="OAuthParametersRegistry"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.18.2"></a><h3>18.2.&nbsp;
OAuth Parameters Registration</h3>

<p>
          This specification registers the following parameters
          in the IANA
          OAuth Parameters registry
          defined in <a class='info' href='#RFC6749'>RFC 6749<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749].

</p>
<a name="ParametersContents"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.18.2.1"></a><h3>18.2.1.&nbsp;
Registry Contents</h3>

<p>
          </p>
<ul class="text">
<li>Parameter name: <tt>nonce</tt>
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a> of this document
</li>
<li>Related information: None
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Parameter name: <tt>display</tt>
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a> of this document
</li>
<li>Related information: None
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Parameter name: <tt>prompt</tt>
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a> of this document
</li>
<li>Related information: None
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Parameter name: <tt>max_age</tt>
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a> of this document
</li>
<li>Related information: None
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Parameter name: <tt>ui_locales</tt>
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a> of this document
</li>
<li>Related information: None
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Parameter name: <tt>claims_locales</tt>
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#ClaimsLanguagesAndScripts'>Section&nbsp;5.2<span> (</span><span class='info'>Claims Languages and Scripts</span><span>)</span></a> of this document
</li>
<li>Related information: None
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Parameter name: <tt>id_token_hint</tt>
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a> of this document
</li>
<li>Related information: None
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Parameter name: <tt>login_hint</tt>
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a> of this document
</li>
<li>Related information: None
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Parameter name: <tt>acr_values</tt>
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthorizationEndpoint'>Section&nbsp;3.1.2<span> (</span><span class='info'>Authorization Endpoint</span><span>)</span></a> of this document
</li>
<li>Related information: None
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Parameter name: <tt>claims</tt>
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#ClaimsParameter'>Section&nbsp;5.5<span> (</span><span class='info'>Requesting Claims using the &quot;claims&quot; Request Parameter</span><span>)</span></a> of this document
</li>
<li>Related information: None
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Parameter name: <tt>registration</tt>
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#RegistrationParameter'>Section&nbsp;7.2.1<span> (</span><span class='info'>Providing Information with the &quot;registration&quot; Request Parameter</span><span>)</span></a> of this document
</li>
<li>Related information: None
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Parameter name: <tt>request</tt>
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#JWTRequests'>Section&nbsp;6<span> (</span><span class='info'>Passing Request Parameters as JWTs</span><span>)</span></a> of this document
</li>
<li>Related information: None
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Parameter name: <tt>request_uri</tt>
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#JWTRequests'>Section&nbsp;6<span> (</span><span class='info'>Passing Request Parameters as JWTs</span><span>)</span></a> of this document
</li>
<li>Related information: None
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Parameter name: <tt>id_token</tt>
</li>
<li>Parameter usage location: Authorization Response,
              Access Token Response
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#TokenResponse'>Section&nbsp;3.1.3.3<span> (</span><span class='info'>Successful Token Response</span><span>)</span></a> of this document
</li>
<li>Related information: None
</li>
</ul><p>

</p>
<a name="OAuthErrorRegistry"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.18.3"></a><h3>18.3.&nbsp;
OAuth Extensions Error Registration</h3>

<p>
          This specification registers the following errors
          in the IANA
          OAuth Extensions Error registry
          defined in <a class='info' href='#RFC6749'>RFC 6749<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> [RFC6749].

</p>
<a name="ErrorContents"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.18.3.1"></a><h3>18.3.1.&nbsp;
Registry Contents</h3>

<p>
            </p>
<ul class="text">
<li>Error name: <tt>interaction_required</tt>
</li>
<li>Error usage location: Authorization Endpoint
</li>
<li>Related protocol extension: OpenID Connect
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthError'>Section&nbsp;3.1.2.6<span> (</span><span class='info'>Authentication Error Response</span><span>)</span></a> of this document
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Error name: <tt>login_required</tt>
</li>
<li>Error usage location: Authorization Endpoint
</li>
<li>Related protocol extension: OpenID Connect
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthError'>Section&nbsp;3.1.2.6<span> (</span><span class='info'>Authentication Error Response</span><span>)</span></a> of this document
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Error name: <tt>account_selection_required</tt>
</li>
<li>Error usage location: Authorization Endpoint
</li>
<li>Related protocol extension: OpenID Connect
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthError'>Section&nbsp;3.1.2.6<span> (</span><span class='info'>Authentication Error Response</span><span>)</span></a> of this document
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Error name: <tt>consent_required</tt>
</li>
<li>Error usage location: Authorization Endpoint
</li>
<li>Related protocol extension: OpenID Connect
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthError'>Section&nbsp;3.1.2.6<span> (</span><span class='info'>Authentication Error Response</span><span>)</span></a> of this document
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Error name: <tt>invalid_request_uri</tt>
</li>
<li>Error usage location: Authorization Endpoint
</li>
<li>Related protocol extension: OpenID Connect
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthError'>Section&nbsp;3.1.2.6<span> (</span><span class='info'>Authentication Error Response</span><span>)</span></a> of this document
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Error name: <tt>invalid_request_object</tt>
</li>
<li>Error usage location: Authorization Endpoint
</li>
<li>Related protocol extension: OpenID Connect
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthError'>Section&nbsp;3.1.2.6<span> (</span><span class='info'>Authentication Error Response</span><span>)</span></a> of this document
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Error name: <tt>request_not_supported</tt>
</li>
<li>Error usage location: Authorization Endpoint
</li>
<li>Related protocol extension: OpenID Connect
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthError'>Section&nbsp;3.1.2.6<span> (</span><span class='info'>Authentication Error Response</span><span>)</span></a> of this document
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Error name: <tt>request_uri_not_supported</tt>
</li>
<li>Error usage location: Authorization Endpoint
</li>
<li>Related protocol extension: OpenID Connect
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthError'>Section&nbsp;3.1.2.6<span> (</span><span class='info'>Authentication Error Response</span><span>)</span></a> of this document
</li>
</ul><p>

</p>
<p>
            </p>
<ul class="text">
<li>Error name: <tt>registration_not_supported</tt>
</li>
<li>Error usage location: Authorization Endpoint
</li>
<li>Related protocol extension: OpenID Connect
</li>
<li>Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
</li>
<li>Specification document(s): <a class='info' href='#AuthError'>Section&nbsp;3.1.2.6<span> (</span><span class='info'>Authentication Error Response</span><span>)</span></a> of this document
</li>
</ul><p>

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.19"></a><h3>19.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>19.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="CORS">[CORS]</a></td>
<td class="author-text">Opera Software ASA, &ldquo;<a href="http://www.w3.org/TR/access-control/">Cross-Origin Resource Sharing</a>,&rdquo; July&nbsp;2010.</td></tr>
<tr><td class="author-text" valign="top"><a name="E.164">[E.164]</a></td>
<td class="author-text">International Telecommunication Union, &ldquo;<a href="http://www.itu.int/rec/T-REC-E.164-201011-I/en">E.164: The international public telecommunication numbering plan</a>,&rdquo; 2010.</td></tr>
<tr><td class="author-text" valign="top"><a name="IANA.Language">[IANA.Language]</a></td>
<td class="author-text">Internet Assigned Numbers Authority (IANA), &ldquo;<a href="http://www.iana.org/assignments/language-subtag-registry">Language Subtag Registry</a>,&rdquo; 2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="ISO29115">[ISO29115]</a></td>
<td class="author-text">International Organization for Standardization, &ldquo;<a href="http://www.iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=45138">ISO/IEC 29115:2013 --
          Information technology - Security techniques - Entity authentication
          assurance framework</a>,&rdquo; ISO/IEC&nbsp;29115, March&nbsp;2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="ISO3166-1">[ISO3166-1]</a></td>
<td class="author-text">International Organization for
            Standardization, &ldquo;<a href="http://www.w3.org/WAI/ER/IG/ert/iso639.htm">ISO 3166-1:1997. Codes for the representation of names of
          countries and their subdivisions -- Part 1: Country codes</a>,&rdquo; 1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="ISO639-1">[ISO639-1]</a></td>
<td class="author-text">International Organization for
            Standardization, &ldquo;ISO 639-1:2002. Codes for the representation of names of
          languages -- Part 1: Alpha-2 code,&rdquo; 2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="ISO8601-2004">[ISO8601-2004]</a></td>
<td class="author-text">International Organization for
            Standardization, &ldquo;ISO 8601:2004. Data elements and interchange formats - Information interchange -
          Representation of dates and times,&rdquo; 2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="JWA">[JWA]</a></td>
<td class="author-text">Jones, M., &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms">JSON Web Algorithms (JWA)</a>,&rdquo; draft-ietf-jose-json-web-algorithms (work in progress), November&nbsp;2013 (<a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-18">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="JWE">[JWE]</a></td>
<td class="author-text">Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption">JSON Web Encryption (JWE)</a>,&rdquo; draft-ietf-jose-json-web-encryption (work in progress), November&nbsp;2013 (<a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-18">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="JWK">[JWK]</a></td>
<td class="author-text">Jones, M., &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-key">JSON Web Key (JWK)</a>,&rdquo; draft-ietf-jose-json-web-key (work in progress), November&nbsp;2013 (<a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-key-18">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="JWS">[JWS]</a></td>
<td class="author-text">Jones, M., Bradley, J., and N. Sakimura, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-signature">JSON Web Signature (JWS)</a>,&rdquo; draft-ietf-jose-json-web-signature (work in progress), November&nbsp;2013 (<a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-signature-18">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="JWT">[JWT]</a></td>
<td class="author-text">Jones, M., Bradley, J., and N. Sakimura, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token">JSON Web Token (JWT)</a>,&rdquo; draft-ietf-oauth-json-web-token (work in progress), November&nbsp;2013 (<a href="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-13">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth.Assertions">[OAuth.Assertions]</a></td>
<td class="author-text">Campbell, B., Mortimore, C., Jones, M., and Y. Goland, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-oauth-assertions">Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants</a>,&rdquo; draft-ietf-oauth-assertions (work in progress), December&nbsp;2013 (<a href="http://tools.ietf.org/html/draft-ietf-oauth-assertions-13">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth.JWT">[OAuth.JWT]</a></td>
<td class="author-text">Jones, M., Campbell, B., and C. Mortimore, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-oauth-jwt-bearer">JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants</a>,&rdquo; draft-ietf-oauth-jwt-bearer (work in progress), December&nbsp;2013 (<a href="http://tools.ietf.org/html/draft-ietf-oauth-jwt-bearer-07">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth.Responses">[OAuth.Responses]</a></td>
<td class="author-text">de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, &ldquo;<a href="http://openid.net/specs/oauth-v2-multiple-response-types-1_0.html">OAuth 2.0 Multiple Response Type Encoding Practices</a>,&rdquo; December&nbsp;2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.Discovery">[OpenID.Discovery]</a></td>
<td class="author-text">Sakimura, N., Bradley, J., Jones, M., and E. Jay, &ldquo;<a href="http://openid.net/specs/openid-connect-discovery-1_0.html">OpenID Connect Discovery 1.0</a>,&rdquo; December&nbsp;2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.Registration">[OpenID.Registration]</a></td>
<td class="author-text">Sakimura, N., Bradley, J., and M. Jones, &ldquo;<a href="http://openid.net/specs/openid-connect-registration-1_0.html">OpenID Connect Dynamic Client Registration 1.0</a>,&rdquo; December&nbsp;2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2246">[RFC2246]</a></td>
<td class="author-text"><a href="mailto:tdierks@certicom.com">Dierks, T.</a> and <a href="mailto:callen@certicom.com">C. Allen</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2246">The TLS Protocol Version 1.0</a>,&rdquo; RFC&nbsp;2246, January&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3339">[RFC3339]</a></td>
<td class="author-text"><a href="mailto:GK@ACM.ORG">Klyne, G., Ed.</a> and <a href="mailto:chris.newman@sun.com">C. Newman</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3339">Date and Time on the Internet: Timestamps</a>,&rdquo; RFC&nbsp;3339, July&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3339.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3339.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3339.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3966">[RFC3966]</a></td>
<td class="author-text">Schulzrinne, H., &ldquo;<a href="http://tools.ietf.org/html/rfc3966">The tel URI for Telephone Numbers</a>,&rdquo; RFC&nbsp;3966, December&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3966.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3986">[RFC3986]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com">Fielding, R.</a>, and <a href="mailto:LMM@acm.org">L. Masinter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>,&rdquo; STD&nbsp;66, RFC&nbsp;3986, January&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3986.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3986.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3986.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4627">[RFC4627]</a></td>
<td class="author-text">Crockford, D., &ldquo;<a href="http://tools.ietf.org/html/rfc4627">The application/json Media Type for JavaScript Object Notation (JSON)</a>,&rdquo; RFC&nbsp;4627, July&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4627.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5322">[RFC5322]</a></td>
<td class="author-text"><a href="mailto:presnick@qualcomm.com">Resnick, P., Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc5322">Internet Message Format</a>,&rdquo; RFC&nbsp;5322, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5322.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc5322.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc5322.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5646">[RFC5646]</a></td>
<td class="author-text">Phillips, A. and M. Davis, &ldquo;<a href="http://tools.ietf.org/html/rfc5646">Tags for Identifying Languages</a>,&rdquo; BCP&nbsp;47, RFC&nbsp;5646, September&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5646.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC6125">[RFC6125]</a></td>
<td class="author-text">Saint-Andre, P. and J. Hodges, &ldquo;<a href="http://tools.ietf.org/html/rfc6125">Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</a>,&rdquo; RFC&nbsp;6125, March&nbsp;2011 (<a href="http://www.rfc-editor.org/rfc/rfc6125.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC6711">[RFC6711]</a></td>
<td class="author-text">Johansson, L., &ldquo;<a href="http://tools.ietf.org/html/rfc6711">An IANA Registry for Level of Assurance (LoA) Profiles</a>,&rdquo; RFC&nbsp;6711, August&nbsp;2012 (<a href="http://www.rfc-editor.org/rfc/rfc6711.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC6749">[RFC6749]</a></td>
<td class="author-text">Hardt, D., &ldquo;<a href="http://tools.ietf.org/html/rfc6749">The OAuth 2.0 Authorization Framework</a>,&rdquo; RFC&nbsp;6749, October&nbsp;2012 (<a href="http://www.rfc-editor.org/rfc/rfc6749.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC6750">[RFC6750]</a></td>
<td class="author-text">Jones, M. and D. Hardt, &ldquo;<a href="http://tools.ietf.org/html/rfc6750">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a>,&rdquo; RFC&nbsp;6750, October&nbsp;2012 (<a href="http://www.rfc-editor.org/rfc/rfc6750.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC6819">[RFC6819]</a></td>
<td class="author-text">Lodderstedt, T., McGloin, M., and P. Hunt, &ldquo;<a href="http://tools.ietf.org/html/rfc6819">OAuth 2.0 Threat Model and Security Considerations</a>,&rdquo; RFC&nbsp;6819, January&nbsp;2013 (<a href="http://www.rfc-editor.org/rfc/rfc6819.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="USA15">[USA15]</a></td>
<td class="author-text"><a href="mailto:markdavis@google.com">Davis, M.</a>, <a href="mailto:ken@unicode.org">Whistler, K.</a>, and M. D&uuml;rst, &ldquo;Unicode Normalization Forms,&rdquo; Unicode Standard Annex&nbsp;15, 09&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="W3C.REC-html401-19991224">[W3C.REC-html401-19991224]</a></td>
<td class="author-text">Raggett, D., Hors, A., and I. Jacobs, &ldquo;<a href="http://www.w3.org/TR/1999/REC-html401-19991224">HTML 4.01 Specification</a>,&rdquo; World Wide Web Consortium Recommendation&nbsp;REC-html401-19991224, December&nbsp;1999 (<a href="http://www.w3.org/TR/1999/REC-html401-19991224">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="zoneinfo">[zoneinfo]</a></td>
<td class="author-text">Public Domain, &ldquo;<a href="http://www.twinsun.com/tz/tz-link.htm">The tz database</a>,&rdquo; June&nbsp;2011.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>19.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="OAuth.Post">[OAuth.Post]</a></td>
<td class="author-text">Jones, M. and B. Campbell, &ldquo;<a href="http://openid.net/specs/oauth-v2-form-post-response-mode-1_0.html">OAuth 2.0 Form Post Response Mode</a>,&rdquo; December&nbsp;2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.2.0">[OpenID.2.0]</a></td>
<td class="author-text">OpenID Foundation, &ldquo;OpenID Authentication 2.0,&rdquo; December&nbsp;2007 (<a href="http://openid.net/specs/openid-authentication-2_0.txt">TXT</a>, <a href="http://openid.net/specs/openid-authentication-2_0.html">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.Basic">[OpenID.Basic]</a></td>
<td class="author-text">Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and C. Mortimore, &ldquo;<a href="http://openid.net/specs/openid-connect-basic-1_0.html">OpenID Connect Basic Client Implementer's Guide 1.0</a>,&rdquo; December&nbsp;2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.Implicit">[OpenID.Implicit]</a></td>
<td class="author-text">Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and C. Mortimore, &ldquo;<a href="http://openid.net/specs/openid-connect-implicit-1_0.html">OpenID Connect Implicit Client Implementer's Guide 1.0</a>,&rdquo; December&nbsp;2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.PAPE">[OpenID.PAPE]</a></td>
<td class="author-text"><a href="mailto:david@sixapart.com">Recordon, D.</a>, <a href="mailto:mbj@microsoft.com">Jones, M.</a>, <a href="mailto:johnny.bufu@gmail.com">Bufu, J., Ed.</a>, <a href="mailto:cygnus@janrain.com">Daugherty, J., Ed.</a>, and <a href="mailto:n-sakimura@nri.co.jp">N. Sakimura</a>, &ldquo;OpenID Provider
          Authentication Policy Extension 1.0,&rdquo; December&nbsp;2008 (<a href="http://openid.net/specs/openid-provider-authentication-policy-extension-1_0.txt">TXT</a>, <a href="http://openid.net/specs/openid-provider-authentication-policy-extension-1_0.html">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.Session">[OpenID.Session]</a></td>
<td class="author-text">Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;<a href="http://openid.net/specs/openid-connect-session-1_0.html">OpenID Connect Session Management 1.0</a>,&rdquo; December&nbsp;2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4949">[RFC4949]</a></td>
<td class="author-text">Shirey, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4949">Internet Security Glossary, Version 2</a>,&rdquo; RFC&nbsp;4949, August&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4949.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="X.1252">[X.1252]</a></td>
<td class="author-text">International Telecommunication Union, &ldquo;<a href="http://www.itu.int/rec/dologin_pub.asp?lang=e&amp;id=T-REC-X.1252-201004-I!!PDF-E&amp;type=items">ITU-T Recommendation X.1252 -- Cyberspace security -- Identity management
          -- Baseline identity management terms and definitions</a>,&rdquo; ITU-T&nbsp;X.1252, November&nbsp;2010.</td></tr>
</table>

<a name="AuthorizationExamples"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Authorization Examples</h3>

<p>
        The following are non-normative examples of Authorization Requests with
        different <tt>response_type</tt> values and their responses
        (with line wraps within values for display purposes only):

</p>
<a name="codeExample"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Example using response_type=code</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /authorize?
    response_type=code
    &amp;client_id=s6BhdRkqt3
    &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &amp;scope=openid%20profile%20email
    &amp;nonce=n-0S6_WzA2Mj
    &amp;state=af0ifjsldkj HTTP/1.1
  Host: server.example.com

  HTTP/1.1 302 Found
  Location: https://client.example.org/cb?
    code=Qcb0Orv1zh30vL1MPRsbm-diHiMwcLyZvn1arpZv-Jxf_11jnpEX3Tgfvk
    &amp;state=af0ifjsldkj
</pre></div>
<a name="id_tokenExample"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Example using response_type=id_token</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /authorize?
    response_type=id_token
    &amp;client_id=s6BhdRkqt3
    &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &amp;scope=openid%20profile%20email
    &amp;nonce=n-0S6_WzA2Mj
    &amp;state=af0ifjsldkj HTTP/1.1
  Host: server.example.com

  HTTP/1.1 302 Found
  Location: https://client.example.org/cb#
    id_token=eyJraWQiOiIxZTlnZGs3IiwiYWxnIjoiUlMyNTYifQ.ewogImlz
    cyI6ICJodHRwOi8vc2VydmVyLmV4YW1wbGUuY29tIiwKICJzdWIiOiAiMjQ4
    Mjg5NzYxMDAxIiwKICJhdWQiOiAiczZCaGRSa3F0MyIsCiAibm9uY2UiOiAi
    bi0wUzZfV3pBMk1qIiwKICJleHAiOiAxMzExMjgxOTcwLAogImlhdCI6IDEz
    MTEyODA5NzAsCiAibmFtZSI6ICJKYW5lIERvZSIsCiAiZ2l2ZW5fbmFtZSI6
    ICJKYW5lIiwKICJmYW1pbHlfbmFtZSI6ICJEb2UiLAogImdlbmRlciI6ICJm
    ZW1hbGUiLAogImJpcnRoZGF0ZSI6ICIwMDAwLTEwLTMxIiwKICJlbWFpbCI6
    ICJqYW5lZG9lQGV4YW1wbGUuY29tIiwKICJwaWN0dXJlIjogImh0dHA6Ly9l
    eGFtcGxlLmNvbS9qYW5lZG9lL21lLmpwZyIKfQ.rHQjEmBqn9Jre0OLykYNn
    spA10Qql2rvx4FsD00jwlB0Sym4NzpgvPKsDjn_wMkHxcp6CilPcoKrWHcip
    R2iAjzLvDNAReF97zoJqq880ZD1bwY82JDauCXELVR9O6_B0w3K-E7yM2mac
    AAgNCUwtik6SjoSUZRcf-O5lygIyLENx882p6MtmwaL1hd6qn5RZOQ0TLrOY
    u0532g9Exxcm-ChymrB4xLykpDj3lUivJt63eEGGN6DH5K6o33TcxkIjNrCD
    4XB1CKKumZvCedgHHF3IAK4dVEDSUoGlH9z4pP_eWYNXvqQOjGs-rDaQzUHl
    6cQQWNiDpWOl_lxXjQEvQ
    &amp;state=af0ifjsldkj
</pre></div>
<p>
          The value of the <tt>id_token</tt> parameter is the ID Token,
          which is a signed JWT,
          containing three base64url encoded segments separated by period ('.') characters.
          The first segment represents the JWT header.
          Base64url decoding it will result in the following set of Header Parameters:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {"kid":"1e9gdk7","alg":"RS256"}
</pre></div>
<p>
          The <tt>alg</tt> value represents the algorithm
          that was used to sign the JWT, in this case
          <tt>RS256</tt>, representing RSASSA-PKCS-v1_5 using SHA-256.
          The <tt>kid</tt> value is a key identifier used
          in identifying the key to be used to verify the signature.
          If the <tt>kid</tt> value is unknown to the RP,
          it needs to retrieve the contents of the OP's JWK Set again
          to obtain the OP's current set of keys.

</p>
<p>
            The second segment represents the Claims in the ID Token.
            Verifying and decoding the ID Token will yield the following Claims:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "iss": "http://server.example.com",
   "sub": "248289761001",
   "aud": "s6BhdRkqt3",
   "nonce": "n-0S6_WzA2Mj",
   "exp": 1311281970,
   "iat": 1311280970,
   "name": "Jane Doe",
   "given_name": "Jane",
   "family_name": "Doe",
   "gender": "female",
   "birthdate": "0000-10-31",
   "email": "janedoe@example.com",
   "picture": "http://example.com/janedoe/me.jpg"
  }
</pre></div>
<p>
          The third segment represents the ID Token signature,
          which is verified as described in <a class='info' href='#JWS'>[JWS]<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature (JWS),&rdquo; November&nbsp;2013.</span><span>)</span></a>.

</p>
<a name="id_token-tokenExample"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3"></a><h3>A.3.&nbsp;
Example using response_type=id_token&nbsp;token</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /authorize?
    response_type=id_token%20token
    &amp;client_id=s6BhdRkqt3
    &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &amp;scope=openid%20profile%20email
    &amp;nonce=n-0S6_WzA2Mj
    &amp;state=af0ifjsldkj HTTP/1.1
  Host: server.example.com

  HTTP/1.1 302 Found
  Location: https://client.example.org/cb#
    access_token=jHkWEdUXMU1BwAsC4vtUsZwnNvTIxEl0z9K3vx5KF0Y
    &amp;token_type=Bearer
    &amp;id_token=eyJraWQiOiIxZTlnZGs3IiwiYWxnIjoiUlMyNTYifQ.ewogIml
    zcyI6ICJodHRwOi8vc2VydmVyLmV4YW1wbGUuY29tIiwKICJzdWIiOiAiMjQ
    4Mjg5NzYxMDAxIiwKICJhdWQiOiAiczZCaGRSa3F0MyIsCiAibm9uY2UiOiA
    ibi0wUzZfV3pBMk1qIiwKICJleHAiOiAxMzExMjgxOTcwLAogImlhdCI6IDE
    zMTEyODA5NzAsCiAiYXRfaGFzaCI6ICI3N1FtVVB0alBmeld0RjJBbnBLOVJ
    RIgp9.F9gRev0Dt2tKcrBkHy72cmRqnLdzw9FLCCSebV7mWs7o_sv2O5s6zM
    ky2kmhHTVx9HmdvNnx9GaZ8XMYRFeYk8L5NZ7aYlA5W56nsG1iWOou_-gji0
    ibWIuuf4Owaho3YSoi7EvsTuLFz6tq-dLyz0dKABMDsiCmJ5wqkPUDTE3QTX
    jzbUmOzUDli-gCh5QPuZAq0cNW3pf_2n4zpvTYtbmj12cVcxGIMZby7TMWES
    RjQ9_o3jvhVNcCGcE0KAQXejhA1ocJhNEvQNqMFGlBb6_0RxxKjDZ-Oa329e
    GDidOvvp0h5hoES4a8IuGKS7NOcpp-aFwp0qVMDLI-Xnm-Pg
    &amp;state=af0ifjsldkj
</pre></div>
<p>
            Verifying and decoding the ID Token will yield the following Claims:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "iss": "http://server.example.com",
   "sub": "248289761001",
   "aud": "s6BhdRkqt3",
   "nonce": "n-0S6_WzA2Mj",
   "exp": 1311281970,
   "iat": 1311280970,
   "at_hash": "77QmUPtjPfzWtF2AnpK9RQ"
  }
</pre></div>
<a name="code-id_tokenExample"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.4"></a><h3>A.4.&nbsp;
Example using response_type=code&nbsp;id_token</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /authorize?
    response_type=code%20id_token
    &amp;client_id=s6BhdRkqt3
    &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &amp;scope=openid%20profile%20email
    &amp;nonce=n-0S6_WzA2Mj
    &amp;state=af0ifjsldkj HTTP/1.1
  Host: server.example.com

  HTTP/1.1 302 Found
  Location: https://client.example.org/cb#
    code=Qcb0Orv1zh30vL1MPRsbm-diHiMwcLyZvn1arpZv-Jxf_11jnpEX3Tgfvk
    &amp;id_token=eyJraWQiOiIxZTlnZGs3IiwiYWxnIjoiUlMyNTYifQ.ewogIml
    zcyI6ICJodHRwOi8vc2VydmVyLmV4YW1wbGUuY29tIiwKICJzdWIiOiAiMjQ
    4Mjg5NzYxMDAxIiwKICJhdWQiOiAiczZCaGRSa3F0MyIsCiAibm9uY2UiOiA
    ibi0wUzZfV3pBMk1qIiwKICJleHAiOiAxMzExMjgxOTcwLAogImlhdCI6IDE
    zMTEyODA5NzAsCiAiY19oYXNoIjogIkxEa3RLZG9RYWszUGswY25YeENsdEE
    iCn0.XW6uhdrkBgcGx6zVIrCiROpWURs-4goO1sKA4m9jhJIImiGg5muPUcN
    egx6sSv43c5DSn37sxCRrDZZm4ZPBKKgtYASMcE20SDgvYJdJS0cyuFw7Ijp
    _7WnIjcrl6B5cmoM6ylCvsLMwkoQAxVublMwH10oAxjzD6NEFsu9nipkszWh
    sPePf_rM4eMpkmCbTzume-fzZIi5VjdWGGEmzTg32h3jiex-r5WTHbj-u5HL
    7u_KP3rmbdYNzlzd1xWRYTUs4E8nOTgzAUwvwXkIQhOh5TPcSMBYy6X3E7-_
    gr9Ue6n4ND7hTFhtjYs3cjNKIA08qm5cpVYFMFMG6PkhzLQ
    &amp;state=af0ifjsldkj
</pre></div>
<p>
            Verifying and decoding the ID Token will yield the following Claims:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "iss": "http://server.example.com",
   "sub": "248289761001",
   "aud": "s6BhdRkqt3",
   "nonce": "n-0S6_WzA2Mj",
   "exp": 1311281970,
   "iat": 1311280970,
   "c_hash": "LDktKdoQak3Pk0cnXxCltA"
  }
</pre></div>
<a name="code-tokenExample"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.5"></a><h3>A.5.&nbsp;
Example using response_type=code&nbsp;token</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /authorize?
    response_type=code%20token
    &amp;client_id=s6BhdRkqt3
    &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &amp;scope=openid%20profile%20email
    &amp;nonce=n-0S6_WzA2Mj
    &amp;state=af0ifjsldkj HTTP/1.1
  Host: server.example.com

  HTTP/1.1 302 Found
  Location: https://client.example.org/cb#
    code=Qcb0Orv1zh30vL1MPRsbm-diHiMwcLyZvn1arpZv-Jxf_11jnpEX3Tgfvk
    &amp;access_token=jHkWEdUXMU1BwAsC4vtUsZwnNvTIxEl0z9K3vx5KF0Y
    &amp;token_type=Bearer
    &amp;state=af0ifjsldkj
</pre></div>
<a name="code-id_token-tokenExample"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.6"></a><h3>A.6.&nbsp;
Example using response_type=code&nbsp;id_token&nbsp;token</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /authorize?
    response_type=code%20id_token%20token
    &amp;client_id=s6BhdRkqt3
    &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &amp;scope=openid%20profile%20email
    &amp;nonce=n-0S6_WzA2Mj
    &amp;state=af0ifjsldkj HTTP/1.1
  Host: server.example.com

  HTTP/1.1 302 Found
  Location: https://client.example.org/cb#
    code=Qcb0Orv1zh30vL1MPRsbm-diHiMwcLyZvn1arpZv-Jxf_11jnpEX3Tgfvk
    &amp;access_token=jHkWEdUXMU1BwAsC4vtUsZwnNvTIxEl0z9K3vx5KF0Y
    &amp;token_type=Bearer
    &amp;id_token=eyJraWQiOiIxZTlnZGs3IiwiYWxnIjoiUlMyNTYifQ.ewogIml
    zcyI6ICJodHRwOi8vc2VydmVyLmV4YW1wbGUuY29tIiwKICJzdWIiOiAiMjQ
    4Mjg5NzYxMDAxIiwKICJhdWQiOiAiczZCaGRSa3F0MyIsCiAibm9uY2UiOiA
    ibi0wUzZfV3pBMk1qIiwKICJleHAiOiAxMzExMjgxOTcwLAogImlhdCI6IDE
    zMTEyODA5NzAsCiAiY19oYXNoIjogIkxEa3RLZG9RYWszUGswY25YeENsdEE
    iCn0.XW6uhdrkBgcGx6zVIrCiROpWURs-4goO1sKA4m9jhJIImiGg5muPUcN
    egx6sSv43c5DSn37sxCRrDZZm4ZPBKKgtYASMcE20SDgvYJdJS0cyuFw7Ijp
    _7WnIjcrl6B5cmoM6ylCvsLMwkoQAxVublMwH10oAxjzD6NEFsu9nipkszWh
    sPePf_rM4eMpkmCbTzume-fzZIi5VjdWGGEmzTg32h3jiex-r5WTHbj-u5HL
    7u_KP3rmbdYNzlzd1xWRYTUs4E8nOTgzAUwvwXkIQhOh5TPcSMBYy6X3E7-_
    gr9Ue6n4ND7hTFhtjYs3cjNKIA08qm5cpVYFMFMG6PkhzLQ
    &amp;state=af0ifjsldkj
</pre></div>
<p>
            Verifying and decoding the ID Token will yield the following Claims:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "iss": "http://server.example.com",
   "sub": "248289761001",
   "aud": "s6BhdRkqt3",
   "nonce": "n-0S6_WzA2Mj",
   "exp": 1311281970,
   "iat": 1311280970,
   "at_hash": "77QmUPtjPfzWtF2AnpK9RQ",
   "c_hash": "LDktKdoQak3Pk0cnXxCltA"
  }
</pre></div>
<a name="ExampleRSAKey"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.7"></a><h3>A.7.&nbsp;
RSA Key Used in Examples</h3>

<p>
            The following RSA public key, represented in JWK format, can be used to
            validate the ID Token signatures in the above examples
            (with line wraps within values for display purposes only):

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  {
   "kty":"RSA",
   "kid":"1e9gdk7",
   "n":"w7Zdfmece8iaB0kiTY8pCtiBtzbptJmP28nSWwtdjRu0f2GFpajvWE4VhfJA
        jEsOcwYzay7XGN0b-X84BfC8hmCTOj2b2eHT7NsZegFPKRUQzJ9wW8ipn_aD
        JWMGDuB1XyqT1E7DYqjUCEOD1b4FLpy_xPn6oV_TYOfQ9fZdbE5HGxJUzeku
        GcOKqOQ8M7wfYHhHHLxGpQVgL0apWuP2gDDOdTtpuld4D2LK1MZK99s9gaSj
        RHE8JDb1Z4IGhEcEyzkxswVdPndUWzfvWBBWXWxtSUvQGBRkuy1BHOa4sP6F
        KjWEeeF7gm7UMs2Nm2QUgNZw6xvEDGaLk4KASdIxRQ",
   "e":"AQAB"
  }
</pre></div>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Acknowledgements</h3>

<p>As a successor version of OpenID, this specification heavily relies
      on ideas explored in <a class='info' href='#OpenID.2.0'>OpenID Authentication 2.0<span> (</span><span class='info'>OpenID Foundation, &ldquo;OpenID Authentication 2.0,&rdquo; December&nbsp;2007.</span><span>)</span></a> [OpenID.2.0]. Please
      refer to Appendix C of OpenID Authentication 2.0 for the full list of
      the contributors for that specification.
</p>
<p>
        In addition, the OpenID Community would like to thank the following people for
        their contributions to this specification:

</p>
<p>
        </p>
<blockquote class="text">
<p>Naveen Agarwal (naa@google.com), Google
</p>
<p>Amanda Anganes (aanganes@mitre.org), MITRE
</p>
<p>Casper Biering (cb@peercraft.com), Peercraft
</p>
<p>John Bradley (ve7jtb@ve7jtb.com), Ping Identity
</p>
<p>Tim Bray (tbray@textuality.com), Google
</p>
<p>Johnny Bufu (jbufu@janrain.com), Janrain
</p>
<p>Brian Campbell (bcampbell@pingidentity.com), Ping Identity
</p>
<p>Blaine Cook (romeda@gmail.com), Independent
</p>
<p>Breno de Medeiros (breno@google.com), Google
</p>
<p>Pamela Dingle (pdingle@pingidentity.com), Ping Identity
</p>
<p>Vladimir Dzhuvinov (vladimir@nimbusds.com), Nimbus Directory Services
</p>
<p>George Fletcher (george.fletcher@corp.aol.com), AOL
</p>
<p>Roland Hedberg (roland.hedberg@adm.umu.se), University of Umea
</p>
<p>Ryo Ito (ryo.ito@mixi.co.jp), mixi, Inc.
</p>
<p>Edmund Jay (ejay@mgi1.com), Illumila
</p>
<p>Michael B. Jones (mbj@microsoft.com), Microsoft
</p>
<p>Torsten Lodderstedt (t.lodderstedt@telekom.de), Deutsche Telekom
</p>
<p>Nov Matake (nov@matake.jp), Independent
</p>
<p>Chuck Mortimore (cmortimore@salesforce.com), Salesforce
</p>
<p>Anthony Nadalin (tonynad@microsoft.com), Microsoft
</p>
<p>Hideki Nara (hdknr@ic-tact.co.jp), Tact Communications
</p>
<p>Axel Nennker (axel.nennker@telekom.de), Deutsche Telekom
</p>
<p>David Recordon (dr@fb.com), Facebook
</p>
<p>Justin Richer (jricher@mitre.org), MITRE
</p>
<p>Nat Sakimura (n-sakimura@nri.co.jp), Nomura Research Institute, Ltd.
</p>
<p>Luke Shepard (lshepard@fb.com), Facebook
</p>
<p>Andreas &Aring;kre Solberg (andreas.solberg@uninett.no), UNINET
</p>
<p>Paul Tarjan (pt@fb.com), Facebook
</p>
</blockquote><p>

</p>
<a name="Notices"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Notices</h3>

<p>Copyright (c) 2014 The OpenID Foundation.
</p>
<p>
        The OpenID Foundation (OIDF) grants to any Contributor, developer,
        implementer, or other interested party a non-exclusive, royalty free,
        worldwide copyright license to reproduce, prepare derivative works from,
        distribute, perform and display, this Implementers Draft or
        Final Specification solely for the purposes of (i) developing
        specifications, and (ii) implementing Implementers Drafts and
        Final Specifications based on such documents, provided that attribution
        be made to the OIDF as the source of the material, but that such attribution
        does not indicate an endorsement by the OIDF.

</p>
<p>
        The technology described in this specification was
        made available from contributions from various sources,
        including members of the OpenID Foundation and others.
        Although the OpenID Foundation has taken steps to help ensure
        that the technology is available for distribution, it takes
        no position regarding the validity or scope of any intellectual
        property or other rights that might be claimed to pertain to
        the implementation or use of the technology described in
        this specification or the extent to which any license under
        such rights might or might not be available; neither does it
        represent that it has made any independent effort to identify
        any such rights.  The OpenID Foundation and the contributors
        to this specification make no (and hereby expressly disclaim any)
        warranties (express, implied, or otherwise), including implied
        warranties of merchantability, non-infringement, fitness for
        a particular purpose, or title, related to this specification,
        and the entire risk as to implementing this specification is
        assumed by the implementer.  The OpenID Intellectual
        Property Rights policy requires contributors to offer
        a patent promise not to assert certain patent claims against
        other contributors and against implementers.  The OpenID Foundation invites
        any interested party to bring to its attention any copyrights,
        patents, patent applications, or other proprietary rights
        that may cover technology that may be required to practice
        this specification.

</p>
<a name="History"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D"></a><h3>Appendix D.&nbsp;
Document History</h3>

<p>[[ To be removed from the final specification ]]
</p>
<p>
        -17
        </p>
<ul class="text">
<li>
            Editorial corrections.

</li>
</ul><p>

</p>
<p>
        -16
        </p>
<ul class="text">
<li>
            Clarified that content that is signed and encrypted results in a Nested JWT.

</li>
<li>
            Clarified that UserInfo Responses and Request Objects may be encrypted
            without also being signed.

</li>
<li>
            Applied proofreading corrections by Michael B. Jones.

</li>
</ul><p>

</p>
<p>
        -15
        </p>
<ul class="text">
<li>
            Incorporated review comments from
            Brian Campbell,
            Torsten Lodderstedt,
            George Fletcher,
            Tim Bray,
            Amanda Anganes,
            Nat Sakimura,
            and Justin Richer.

</li>
<li>
            Fixed #889 - Generalized the descriptions of returning responses from the
            Authorization Endpoint to enable non-default Response Modes
            to be used.

</li>
<li>
            Fixed #878 - Generalized description of errors that can be returned
            when <tt>id_token_hint"</tt> is used.

</li>
<li>
            Specified the <tt>iss</tt> and
            <tt>aud</tt> values to be used in signed requests,
            and added the use of these claims to the example.

</li>
<li>
            Expanded the first Authentication Request example to show both
            the 302 redirect response by the Client and the resulting
            HTTP GET request sent by the User Agent.

</li>
<li>
            Removed the Supported Algorithms and Keys subsections
            of the Signatures and Encryption section,
            since they duplicated content in Discovery and Registration.

</li>
<li>
            Added Claim Description entries to Claim registrations,
            tracking the addition in the JWT specification.

</li>
<li>
            Used clearer language for describing when parameters and claims are
            required and optional.

</li>
<li>
            Included issuer and audience claims in Request Object examples.

</li>
<li>
            Fixed #901 - Included "kid" in examples.

</li>
<li>
            Fixed #904 - Allowed third party login request parameters to be sent
            via HTML form post.

</li>
<li>
            Fixed #908 - Moved Redirection URI fragment handling example to
            the Implementation Notes section.

</li>
<li>
            Fixed #905 - Added a complete ID Token validation example.

</li>
</ul><p>

</p>
<p>
        -14
        </p>
<ul class="text">
<li>
            Fixed #862 - Clarified <tt>azp</tt> definition.

</li>
<li>
            Fixed #866 - Stated that the behavior is unspecified if the
            <tt>acr</tt> Claim is requested with both the
            <tt>acr_values</tt> request parameter and
            an individual claim request listing requested values.

</li>
<li>
            Fixed #867 - Allow ID Tokens to use "alg":"none" when using the
            Authorization Code Flow and when explicitly requested at registration time.

</li>
<li>
            Fixed #869 - Registered the OAuth error codes
            <tt>request_not_supported</tt>,
            <tt>request_uri_not_supported</tt>, and
            <tt>registration_not_supported</tt>.

</li>
<li>
            Fixed #874 - Said more about frame busting.

</li>
<li>
            Fixed #877 - Specified that a user interface MUST NOT be displayed
            when <tt>prompt=none</tt> is used.

</li>
<li>
            Fixed #878 - Defined negative response for "id_token_hint".

</li>
<li>
            Updated the description of the plans to host the site
            <tt>https://self-issued.me/</tt>,
            per tasks #879 and #880.

</li>
<li>
            Fixed #876 - Described that Google's <tt>iss</tt>
            value currently omits the required <tt>https://</tt>
            scheme prefix.

</li>
<li>
            Fixed #882 - Called out pre-final IETF specifications used.

</li>
<li>
            Fixed #884 - Changed the descriptions of Basic and Implicit from being profiles
            to being implementer's guides containing subsets of OpenID Connect Core.

</li>
</ul><p>

</p>
<p>
        -13
        </p>
<ul class="text">
<li>
            Restructured to separate Authentication from
            other features and to have separate Authentication sections
            for the Authorization Code Flow, the Implicit Flow,
            and the Hybrid Flow.
            The validation procedures for steps are now specified
            immediately following the descriptions of those steps.

</li>
<li>
            Completed restructuring into functional sections.

</li>
</ul><p>

</p>
<p>
        -12
        </p>
<ul class="text">
<li>
            Created the new OpenID Connect Core specification by combining
            OpenID Connect Messages draft 20 and
            OpenID Connect Standard draft 21,
            with no normative changes.
            (These versions are the second Implementer's Drafts.)

</li>
</ul><p>

</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nat Sakimura</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nomura Research Institute, Ltd.</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:n-sakimura@nri.co.jp">n-sakimura@nri.co.jp</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://nat.sakimura.org/">http://nat.sakimura.org/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">John Bradley</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ping Identity</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ve7jtb@ve7jtb.com">ve7jtb@ve7jtb.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.thread-safe.com/">http://www.thread-safe.com/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Michael B. Jones</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Microsoft</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mbj@microsoft.com">mbj@microsoft.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://self-issued.info/">http://self-issued.info/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Breno de Medeiros</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Google</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:breno@google.com">breno@google.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://stackoverflow.com/users/311376/breno">http://stackoverflow.com/users/311376/breno</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Chuck Mortimore</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Salesforce</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:cmortimore@salesforce.com">cmortimore@salesforce.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="https://twitter.com/cmort">https://twitter.com/cmort</a></td></tr>
</table>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-15411889-1', 'github.com');
  ga('send', 'pageview');

</script>
</body></html>
